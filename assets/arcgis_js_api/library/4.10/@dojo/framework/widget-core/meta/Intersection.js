//>>built
(function(a){"object"===typeof module&&"object"===typeof module.exports?(a=a(require,exports),void 0!==a&&(module.exports=a)):"function"===typeof define&&define.amd&&define("require exports tslib ../../shim/global ../../shim/WeakMap ../../shim/Map ./Base".split(" "),a)})(function(a,f){Object.defineProperty(f,"__esModule",{value:!0});var g=a("tslib"),l=a("../../shim/global"),m=a("../../shim/WeakMap"),n=a("../../shim/Map");a=a("./Base");var e=Object.freeze({intersectionRatio:0,isIntersecting:!1});a=
function(a){function c(){var d=null!==a&&a.apply(this,arguments)||this;d._details=new n.default;d._onIntersect=function(b){return function(a){try{for(var h=g.__values(a),c=h.next();!c.done;c=h.next()){var k=c.value;b.set(k.target,{intersectionRatio:k.intersectionRatio,isIntersecting:k.isIntersecting})}}catch(p){e={error:p}}finally{try{c&&!c.done&&(f=h.return)&&f.call(h)}finally{if(e)throw e.error;}}d.invalidate();var e,f}};return d}g.__extends(c,a);c.prototype.get=function(d,b){void 0===b&&(b={});
var a;if(b.root&&(a=this.getNode(b.root),!a))return e;d=this.getNode(d);if(!d)return e;b=this._getDetails(b)||this._createDetails(b,a);b.entries.get(d)||(b.entries.set(d,e),b.observer.observe(d));return b.entries.get(d)||e};c.prototype.has=function(a,b){a=this.getNode(a);b=this._getDetails(b);return!!(b&&a&&b.entries.has(a))};c.prototype._createDetails=function(a,b){var d=new m.default,c=new l.default.IntersectionObserver(this._onIntersect(d),g.__assign({},a,{root:b}));b=g.__assign({observer:c,entries:d},
a);this._details.set(JSON.stringify(a),b);this.own({destroy:function(){return c.disconnect()}});return b};c.prototype._getDetails=function(a){void 0===a&&(a={});return this._details.get(JSON.stringify(a))};return c}(a.Base);f.Intersection=a;f.default=a});