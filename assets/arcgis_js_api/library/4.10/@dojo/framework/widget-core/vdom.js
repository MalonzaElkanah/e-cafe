//>>built
(function(l){"object"===typeof module&&"object"===typeof module.exports?(l=l(require,exports),void 0!==l&&(module.exports=l)):"function"===typeof define&&define.amd&&define("require exports tslib ../shim/global ../has/has ../shim/WeakMap ./animations/cssTransitions ./d ./Registry ./WidgetBase".split(" "),l)})(function(l,B){function r(c){return c&&t.isWNode(c.node)}function m(c){return!!c&&t.isVNode(c.node)}function da(c,e,k,ea){for(var l=Object.keys(k),n=l.length,C=0;C<n;C++){var m=l[C],r=k[m];r!==
e[m]&&S(c,m,r,ea)}}function fa(c,e,k){var m=e.node;k=m.diffType;var l=m.properties,m=m.attributes;if(!k||"vdom"===k)return{properties:e.node.properties,attributes:e.node.attributes,events:e.node.events};if("none"===k)return{properties:{},attributes:e.node.attributes?{}:void 0,events:e.node.events};var n={properties:{}};if(m)return n.attributes={},n.events=e.node.events,Object.keys(l).forEach(function(e){n.properties[e]=c[e]}),Object.keys(m).forEach(function(e){n.attributes[e]=c.getAttribute(e)}),
n;n.properties=Object.keys(l).reduce(function(e,k){e[k]=c.getAttribute(k)||c[k];return e},{});return n}function N(c,e){return m(c)&&m(e)?t.isDomVNode(c.node)&&t.isDomVNode(e.node)&&c.node.domNode!==e.node.domNode||c.node.tag!==e.node.tag||c.node.properties.key!==e.node.properties.key?!1:!0:r(c)&&r(e)?void 0===c.instance&&"string"===typeof e.node.widgetConstructor||c.node.widgetConstructor!==e.node.widgetConstructor||c.node.properties.key!==e.node.properties.key?!1:!0:!1}function T(c,e,k){for(;k<c.length;k++)if(N(c[k],
e))return k;return-1}function U(c){void 0===c&&(c=[]);c=Array.isArray(c)?c:[c];return c.join(" ").trim()}function S(c,e,k,m){"http://www.w3.org/2000/svg"===m&&"href"===e&&k?c.setAttributeNS("http://www.w3.org/1999/xlink",e,k):"role"===e&&""===k||void 0===k?c.removeAttribute(e):c.setAttribute(e,k)}function ga(c,e){var k=c.domNode,m=c.node.properties,l=c.node.properties.exitAnimation,n=function(){k&&k.parentNode&&k.parentNode.removeChild(k);c.domNode=void 0};if("function"===typeof l)return l(k,n,m);
e.exit(k,m,l,n)}function ha(c){return function(e){function k(){return null!==e&&e.apply(this,arguments)||this}F.__extends(k,e);k.prototype.render=function(){return c};return k}(v.WidgetBase)}function G(c){function e(a,b,d,f){d=b&&!d;"function"===typeof b&&(d=b());!0===d&&D.push(function(){f[a]()})}function k(a,b,d,f,g){g&&(g=O.get(g),a.removeEventListener(b,g));g=d.bind(f);"input"===b&&(g=function(a){d.call(this,a);a.target["oninput-value"]=a.target.value}.bind(f));a.addEventListener(b,g);O.set(d,
g)}function l(a,b,d,f){void 0===f&&(f=!1);Object.keys(b).forEach(function(g){var c="on"===g.substr(0,2)||f,e=f?g:g.substr(2);c&&!d[g]&&(g=O.get(b[g]))&&a.removeEventListener(e,g)})}function J(a,b,d){var f=[],g=r(b);d=m(d)&&1<(d.childrenWrappers||[]).length;d=(b.requiresInsertBefore||!1!==b.hasPreviousSiblings)&&g||d;for(var c,e=0;e<a.length;e++){var h=a[e],p={node:h,depth:b.depth+1,requiresInsertBefore:d,hasParentWNode:g,namespace:b.namespace};if(t.isVNode(h)&&h.properties.exitAnimation)for(b.hasAnimations=
!0,h=q.get(b);h&&!h.hasAnimations;)h.hasAnimations=!0,h=q.get(h);q.set(p,b);c&&z.set(c,p);f.push(p);c=p}return f}function n(a){var b;for(a=q.get(a);!b&&a;)!b&&r(a)&&(b=a),a=q.get(a);return b}function C(a){var b;for(a=q.get(a);!b&&a;)!b&&m(a)&&a.domNode&&(b=a.domNode),a=q.get(a);return b}function B(a){if(a.node.deferredPropertiesCallback){var b=a.node.properties;a.node.properties=F.__assign({},a.node.deferredPropertiesCallback(!0),a.node.originalProperties);D.push(function(){P(a,{properties:b})})}}
function G(a,b,d,f){void 0===b&&(b={});void 0===f&&(f=!0);var g=Object.keys(d.node.properties),c=g.length;-1===g.indexOf("classes")&&b.classes&&a.removeAttribute("class");f&&l(a,b,d.node.properties);for(var m=0;m<c;m++){var h=g[m],p=d.node.properties[h],u=b[h];if("classes"===h){if(u=U(u),p=U(p),u!==p)if(p){if(d.merged)for(u=(a.getAttribute("class")||"").split(" "),h=0;h<u.length;h++)-1===p.indexOf(u[h])&&(p=u[h]+" "+p);a.setAttribute("class",p)}else a.removeAttribute("class")}else if(-1!==ia.indexOf(h))e(h,
p,u,a);else if("styles"===h)for(var h=Object.keys(p),A=h.length,n=0;n<A;n++){var q=h[n],r=p[q];r!==(u&&u[q])&&(a.style[q]=r||"")}else p||"string"!==typeof u||(p=""),"value"===h?(A=a[h],A!==p&&(a["oninput-value"]?A===a["oninput-value"]:p!==u)&&(a[h]=p,a["oninput-value"]=void 0)):"key"!==h&&p!==u&&(A=typeof p,"function"===A&&0===h.lastIndexOf("on",0)&&f?k(a,h.substr(2),p,d.node.bind,u):"string"===A&&"innerHTML"!==h&&f?S(a,h,p,d.namespace):"scrollLeft"===h||"scrollTop"===h?a[h]!==p&&(a[h]=p):a[h]=p)}}
function V(){var a=w.sync,b=W;W=[];if(b.length){var d=function(){for(var a;a=b.shift();)a()};a?d():y.default.requestAnimationFrame(d)}}function X(){var a=w.sync,b=D;D=[];if(b.length){var d=function(){for(var a;a=b.shift();)a()};a?d():y.default.requestIdleCallback?y.default.requestIdleCallback(d):setTimeout(d)}}function P(a,b){if(a.node.attributes&&a.node.events){da(a.domNode,b.attributes||{},a.node.attributes,a.namespace);G(a.domNode,b.properties,a,!1);var d=a.node.events||{};b.events&&l(a.domNode,
b.events||{},a.node.events,!0);b.events=b.events||{};Object.keys(d).forEach(function(f){k(a.domNode,f,d[f],a.node.bind,b.events[f])})}else G(a.domNode,b.properties,a)}function ja(){w.sync?Y():Q||(Q=y.default.requestAnimationFrame(function(){Y()}))}function Y(){Q=void 0;var a=F.__spread(R),b=[];R=[];a.sort(function(a,b){return b.depth-a.depth});for(var d;d=a.pop();)if(d=d.instance,-1===b.indexOf(d)&&x.has(d)){b.push(d);var f=x.get(d),g=v.widgetInstanceMap.get(d),c=q.get(f),e=z.get(f),g={node:{type:t.WNODE,
widgetConstructor:d.constructor,properties:g.inputProperties,children:d.children,bind:f.node.bind},instance:d,depth:f.depth};c&&q.set(g,c);e&&z.set(g,e);if(f=Z({current:f,next:g}).item)E.push(f),d&&x.set(d,g),aa()}ba();X();V()}function aa(){for(var a;a=E.pop();)if(a.type)K.push(a);else{var b=a.current||ca,d=a.next||ca;a=a.meta;void 0===a&&(a={});var f=a.mergeNodes,f=void 0===f?[]:f,g=a.oldIndex,g=void 0===g?0:g;a=a.newIndex;var c=void 0===a?0:a,e=b.length,h=d.length,k=1<e||0<e&&e<h;a=[];if(c<h){var l=
g<e?b[g]:void 0,n=d[c];n.hasPreviousSiblings=k;var k=n,q=f;if(w.merge&&q.length)if(m(k))for(var r=k.node.tag,t=0;t<q.length;t++){var v=q[t];if(r.toUpperCase()===(v.tagName||"")){q.splice(t,1);k.domNode=v;break}}else k.mergeNodes=q;l&&N(l,n)?(g++,c++,m(l)&&m(n)&&(n.inserted=l.inserted),a.push({current:l,next:n})):l&&-1!==T(b,n,g+1)?-1===T(d,l,c+1)?(H.default("dojo-debug")&&I(b,g),a.push({current:l,next:void 0}),g++):(H.default("dojo-debug")&&I(d,c),H.default("dojo-debug")&&I(b,g),a.push({current:l,
next:void 0}),a.push({current:void 0,next:n}),g++,c++):(H.default("dojo-debug")&&b.length&&I(d,c),a.push({current:void 0,next:n}),c++)}c<h&&E.push({current:b,next:d,meta:{mergeNodes:f,oldIndex:g,newIndex:c}});if(e>g&&c>=h)for(d=g;d<e;d++)H.default("dojo-debug")&&I(b,d),a.push({current:b[d],next:void 0});for(d=0;d<a.length;d++)g=ka(a[d]),b=g.item,f=g.dom,(g=g.widget)&&E.push(g),b&&E.push(b),f&&K.push(f)}}function ba(){K.reverse();for(var a;a=K.pop();)if("create"===a.type){var b=a.parentDomNode,d=a.next,
f=a.next,g=f.domNode,c=f.merged,e=f.requiresInsertBefore,f=f.node.properties;P(d,{properties:{}});B(d);if(!c){c=void 0;if(e){e=null;for(c=d;!e;){var h=z.get(c);if(h){m(h);if(h.domNode&&h.domNode.parentNode){e=h.domNode;break}c=h}else if(c=q.get(c),!c||m(c))break}c=e}b.insertBefore(g,c);if(t.isDomVNode(d.node)&&d.node.onAttach)d.node.onAttach()}b=w.transition;e=d.domNode;c=d.node.properties;(h=d.node.properties.enterAnimation)&&("function"===typeof h?h(e,c):b.enter(e,c,h));b=v.widgetInstanceMap.get(d.node.bind);
null!=f.key&&b&&b.nodeHandler.add(g,""+f.key);a.next.inserted=!0}else"update"===a.type?(f=d=a.next,g=f.domNode,f=f.node,a=a.current,(b=q.get(d))&&r(b)&&b.instance&&(b=v.widgetInstanceMap.get(b.instance))&&b.nodeHandler.addRoot(),g=fa(g,a,d),b=v.widgetInstanceMap.get(d.node.bind),P(d,g),B(d),b&&null!=f.properties.key&&b.nodeHandler.add(d.domNode,""+f.properties.key)):"delete"===a.type?(a=a.current,a.node.properties.exitAnimation?ga(a,w.transition):(a.domNode.parentNode.removeChild(a.domNode),a.domNode=
void 0)):"attach"===a.type?(d=a.attached,b=v.widgetInstanceMap.get(a.instance),b.nodeHandler.addRoot(),d&&b.onAttach()):"detach"===a.type&&(a.current.instance&&(b=v.widgetInstanceMap.get(a.current.instance))&&b.onDetach(),a.current.domNode=void 0,a.current.node.bind=void 0,a.current.instance=void 0)}function I(a,b){D.push(function(){var d=n(a[b]);var f=a[b];if(!m(f)||f.node.tag){var c=f.node.properties.key,e="unknown";d&&(e=d.node.widgetConstructor.name||"unknown");if(void 0===c||null===c)for(c=0;c<
a.length;c++)if(c!==b&&(d=a[c],N(d,f))){f=void 0;f=r(d)?d.node.widgetConstructor.name||"unknown":d.node.tag;console.warn("A widget ("+e+") has had a child added or removed, but they were not able to uniquely identified. It is recommended to provide a unique 'key' property when using the same widget or element ("+f+") multiple times as siblings");break}}})}function ka(a){var b=a.current;a=a.next;if(b!==a){if(!b&&a){if(m(a)){b=[];a.domNode?a.merged=!0:a.node.domNode?a.domNode=a.node.domNode:("svg"===
a.node.tag&&(a.namespace="http://www.w3.org/2000/svg"),a.node.tag?a.domNode=a.namespace?y.default.document.createElementNS(a.namespace,a.node.tag):y.default.document.createElement(a.node.tag):null!=a.node.text&&(a.domNode=y.default.document.createTextNode(a.node.text)));a.domNode&&(w.merge&&(b=Array.prototype.slice.call(a.domNode.childNodes)),a.node.children&&(a.childrenWrappers=J(a.node.children,a,null)));var d=n(a);d&&!d.domNode&&(d.domNode=a.domNode);d={next:a,parentDomNode:C(a),type:"create"};
a=a.childrenWrappers?{item:{current:[],next:a.childrenWrappers,meta:{mergeNodes:b}},dom:d}:{dom:d};return a}return la({next:a})}if(b&&a){if(m(b)&&m(a)){d=C(b);a.domNode=b.domNode;a.namespace=b.namespace;if(a.node.text&&a.node.text!==b.node.text){var f=d.ownerDocument.createTextNode(a.node.text);d.replaceChild(f,a.domNode);a.domNode=f}else a.node.children&&(d=J(a.node.children,a,b),a.childrenWrappers=d);return{item:{current:b.childrenWrappers,next:a.childrenWrappers,meta:{}},dom:{type:"update",next:a,
current:b}}}if(r(b)&&r(a))return Z({current:b,next:a})}else if(b&&!a){if(m(b))return ma({current:b});if(r(b))return a=b,a=a.instance?x.get(a.instance):a,z.delete(a),q.delete(a),x.delete(a.instance),{item:{current:a.childrenWrappers,meta:{}},widget:{type:"detach",current:a}}}}return{}}function la(a){var b=a.next;a=b.node.widgetConstructor;var d=w.registry;if(!na.isWidgetBaseConstructor(a))return{};var f=new a;d&&(f.registry.base=d);var c=v.widgetInstanceMap.get(f);c.invalidate=function(){c.dirty=!0;
!c.rendering&&x.has(f)&&(R.push({instance:f,depth:b.depth}),ja())};c.rendering=!0;f.__setProperties__(b.node.properties,b.node.bind);f.__setChildren__(b.node.children);b.instance=f;a=f.__render__();c.rendering=!1;a&&(a=Array.isArray(a)?a:[a],b.childrenWrappers=J(a,b,null));b.instance&&(x.set(b.instance,b),L||(L=b.instance.invalidate.bind(b.instance)));return{item:{next:b.childrenWrappers,meta:{mergeNodes:b.mergeNodes}},widget:{type:"attach",instance:f,attached:!0}}}function Z(a){var b=a.current;a=
a.next;var b=b.instance&&x.get(b.instance)||b,d=b.instance,c=b.domNode,e=b.hasAnimations;if(!d)return[];var k=v.widgetInstanceMap.get(d);a.instance=d;a.domNode=c;a.hasAnimations=e;k.rendering=!0;d.__setProperties__(a.node.properties,a.node.bind);d.__setChildren__(a.node.children);x.set(a.instance,a);if(k.dirty)return c=d.__render__(),k.rendering=!1,c&&(c=Array.isArray(c)?c:[c],a.childrenWrappers=J(c,a,b)),{item:{current:b.childrenWrappers,next:a.childrenWrappers,meta:{}},widget:{type:"attach",instance:d,
attached:!1}};k.rendering=!1;a.childrenWrappers=b.childrenWrappers;return{widget:{type:"attach",instance:d,attached:!1}}}function ma(a){var b=a.current;z.delete(b);q.delete(b);b.node.bind=void 0;if(b.hasAnimations)return{item:{current:b.childrenWrappers,meta:{}},dom:{type:"delete",current:b}};b.childrenWrappers&&D.push(function(){for(var a=b.childrenWrappers||[],c;c=a.pop();){c.childrenWrappers&&(a.push.apply(a,F.__spread(c.childrenWrappers)),c.childrenWrappers=void 0);if(r(c)){if(c.instance){x.delete(c.instance);
var e=v.widgetInstanceMap.get(c.instance);e&&e.onDetach()}c.instance=void 0}z.delete(c);q.delete(c);c.domNode=void 0;c.node.bind=void 0}});return{dom:{type:"delete",current:b}}}var w={sync:!1,merge:!0,transition:oa.default,domNode:y.default.document.body,registry:null},R=[],E=[],K=[],O=new M.WeakMap,x=new M.WeakMap,q=new M.WeakMap,z=new M.WeakMap,Q,D=[],W=[],L;return{mount:function(a){void 0===a&&(a={});w=F.__assign({},w,a);a=w.domNode;var b=c();t.isVNode(b)&&(b=t.w(ha(b),{}));b={node:b,depth:1};
q.set(b,{depth:0,domNode:a,node:t.v("fake")});E.push({current:[],next:[b],meta:{mergeNodes:Array.prototype.slice.call(a.childNodes)}});aa();w.merge=!1;ba();X();V()},invalidate:function(){L&&L()}}}Object.defineProperty(B,"__esModule",{value:!0});var F=l("tslib"),y=l("../shim/global"),H=l("../has/has"),M=l("../shim/WeakMap"),oa=l("./animations/cssTransitions"),t=l("./d"),na=l("./Registry"),v=l("./WidgetBase"),ca=[],ia=["focus","blur","scrollIntoView","click"];B.renderer=G;B.default=G});