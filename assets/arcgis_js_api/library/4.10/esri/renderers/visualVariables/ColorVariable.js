// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../Color ../../core/accessorSupport/decorators ./VisualVariable ./support/ColorStop ./support/utils ../../support/arcadeUtils".split(" "),function(u,v,p,e,m,d,q,r,t,l){return function(n){function b(a){a=n.call(this,a)||this;a.type="color";a.normalizationField=null;return a}p(b,n);k=b;Object.defineProperty(b.prototype,"_cache",{get:function(){var a=l.createSyntaxTree(this.valueExpression);return{ipData:this._interpolateData(),
hasExpression:!!this.valueExpression,compiledFunc:l.createFunction(a)}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"stops",{set:function(a){a&&Array.isArray(a)&&(a=a.filter(function(a){return!!a}),a.sort(function(a,b){return a.value-b.value}));this._set("stops",a)},enumerable:!0,configurable:!0});b.prototype.getColor=function(a,b){var f="number"===typeof a,g=f?null:a,c=g&&g.attributes,h=f?a:null,d=this._cache;a=d.ipData;var e=d.hasExpression,d=d.compiledFunc,k=this.field;if(!k&&
!e)return(b=this.stops)&&b[0]&&b[0].color;"number"!==typeof h&&(e?(h=l.getViewInfo(b),g=l.createExecContext(g,h),h=l.executeFunction(d,g)):c&&(h=c[k]));g=this.normalizationField;c=c?parseFloat(c[g]):void 0;if(null!=h&&(!g||f||!isNaN(c)&&0!==c)&&(isNaN(c)||f||(h/=c),f=t.lookupData(h,a)))return c=f[0],a=f[1],b=c===a?this.stops[c].color:m.blendColors(this.stops[c].color,this.stops[a].color,f[2],b&&b.color),new m(b)};b.prototype.clone=function(){return new k({field:this.field,normalizationField:this.normalizationField,
valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(function(a){return a.clone()}),legendOptions:this.legendOptions&&this.legendOptions.clone()})};b.prototype._interpolateData=function(){return this.stops&&this.stops.map(function(a){return a.value||0})};var k;e([d.property({readOnly:!0,dependsOn:["valueExpression","stops"]})],b.prototype,"_cache",null);e([d.property({type:["color"],json:{type:["colorInfo"]}})],b.prototype,"type",void 0);
e([d.property({type:String,json:{write:!0}})],b.prototype,"normalizationField",void 0);e([d.property({type:[r],json:{write:!0}})],b.prototype,"stops",null);return b=k=e([d.subclass("esri.renderers.visualVariables.ColorVariable")],b)}(d.declared(q))});