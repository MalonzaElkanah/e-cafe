// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/graphics/data/FeatureStore":function(){define("require exports @dojo/framework/shim/Map ../../../core/Error ../../../core/has ../../../core/Logger ../../../core/libs/rbush/rbush ../../../geometry/support/aaBoundingRect ../featureConversionUtils".split(" "),function(v,a,p,k,b,h,m,e,u){Object.defineProperty(a,"__esModule",{value:!0});var w=[],y=h.getLogger("esri.layers.graphics.data.FeatureStore"),n={minX:0,minY:0,maxX:0,maxY:0};v=function(){function a(a){this._featuresById=
new p.default;this._boundsByFeature=new p.default;this._featuresByBounds=new p.default;this._index=m(9,b("csp-restrictions")?function(a){return{minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}}:["[0]","[1]","[2]","[3]"]);this._geometryInfo=a}Object.defineProperty(a.prototype,"geometryType",{get:function(){return this._geometryInfo.geometryType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasM",{get:function(){return this._geometryInfo.hasM},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"hasZ",{get:function(){return this._geometryInfo.hasZ},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullBounds",{get:function(){if(!this.numFeatures)return null;var a=e.create(e.NEGATIVE_INFINITY);this._boundsByFeature.forEach(function(l){l&&(a[0]=Math.min(l[0],a[0]),a[1]=Math.min(l[1],a[1]),a[2]=Math.max(l[2],a[2]),a[3]=Math.max(l[3],a[3]))});return a},
enumerable:!0,configurable:!0});a.prototype.setEngine=function(a){this._engine=a};a.prototype.add=function(a){this._add(a,w);this._index.load(w);this._clearCache();w.length=0};a.prototype.addMany=function(a){for(var l=0;l<a.length;l++)this._add(a[l],w);this._index.load(w);this._clearCache();w.length=0};a.prototype.clear=function(){this._featuresById.clear();this._boundsByFeature.clear();this._featuresByBounds.clear();this._index.clear();this._clearCache()};a.prototype.removeManyById=function(a){for(var l=
0;l<a.length;l++){var b=a[l],c=this._featuresById.get(b);if(c){var g=this._boundsByFeature.get(c);g&&(this._index.remove(g),this._featuresByBounds.delete(g));this._boundsByFeature.delete(c)}this._featuresById.delete(b)}this._clearCache()};a.prototype.forEachBounds=function(a,b){for(var l=0;l<a.length;l++){var c=a[l],g=this._boundsByFeature.get(c);g&&b(g,c)}};a.prototype.getFeature=function(a){return this._featuresById.get(a)};a.prototype.hasFeature=function(a){return this._featuresById.has(a)};a.prototype.forEachFeature=
function(a){this._featuresById.forEach(function(l){return a(l)})};a.prototype.forEachFeatureInBounds=function(a,b){var l=0,c=this._index;n.minX=a[0];n.minY=a[1];n.maxX=a[2];n.maxY=a[3];for(a=c.search(n);l<a.length;l++)b(this._featuresByBounds.get(a[l]))};a.prototype.transferIds=function(a,b){for(var l=[],c=0;c<b.length;c++){var g=this._featuresById.get(b[c]);g&&(this._remove(g),l.push(g))}a.addMany(l);this._clearCache()};a.prototype.transferIdRange=function(a,b,A){for(var c=[];b<A;b++){var g=this._featuresById.get(b);
g&&(this._remove(g),c.push(g))}a.addMany(c);this._clearCache()};a.prototype.transferIf=function(a,b){var l=this,c=[];this._featuresById.forEach(function(a,z){b(a)&&(l._remove(a),c.push(a))});a.addMany(c);this._clearCache()};a.prototype.transferAll=function(a){var l=this,b=[];this._featuresById.forEach(function(a,g){l._remove(a);b.push(a)});a.addMany(b);this._clearCache()};a.prototype._clearCache=function(){this._engine&&this._engine.clearCache()};a.prototype._add=function(a,b){if(a){var l=a.objectId;
if(null==l)y.error(new k("featurestore:invalid-feature","feature id is missing",{feature:a}));else{var c=this._featuresById.get(l),g;c&&(g=this._boundsByFeature.get(c))&&(this._index.remove(g),this._boundsByFeature.delete(c),this._featuresByBounds.delete(g));a.geometry?(g=u.getBoundsOptimizedGeometry(g||e.create(),a.geometry,this._geometryInfo.hasZ,this._geometryInfo.hasM),this._boundsByFeature.set(a,g),this._featuresByBounds.set(g,a),this._featuresById.set(l,a),b.push(g)):(this._boundsByFeature.set(a,
null),this._featuresById.set(l,a))}}};a.prototype._remove=function(a){var l;if(a){if(l=this._boundsByFeature.get(a))this._index.remove(l),this._boundsByFeature.delete(a),this._featuresByBounds.delete(l);this._featuresById.delete(a.objectId)}};return a}();a.default=v})},"@dojo/framework/shim/Map":function(){(function(v){"object"===typeof module&&"object"===typeof module.exports?(v=v(require,exports),void 0!==v&&(module.exports=v)):"function"===typeof define&&define.amd&&define("require exports tslib ./iterator ./global ./object ./support/has ./Symbol".split(" "),
v)})(function(v,a){Object.defineProperty(a,"__esModule",{value:!0});var p=v("tslib"),k=v("./iterator"),b=v("./global"),h=v("./object"),m=v("./support/has");v("./Symbol");a.Map=b.default.Map;m.default("es6-map")||(a.Map=(e=function(){function a(a){this._keys=[];this._values=[];this[Symbol.toStringTag]="Map";if(a)if(k.isArrayLike(a))for(var b=0;b<a.length;b++){var h=a[b];this.set(h[0],h[1])}else try{for(var b=p.__values(a),e=b.next();!e.done;e=b.next())h=e.value,this.set(h[0],h[1])}catch(A){l={error:A}}finally{try{e&&
!e.done&&(E=b.return)&&E.call(b)}finally{if(l)throw l.error;}}var l,E}a.prototype._indexOfKey=function(a,b){for(var e=0,k=a.length;e<k;e++)if(h.is(a[e],b))return e;return-1};Object.defineProperty(a.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0});a.prototype.clear=function(){this._keys.length=this._values.length=0};a.prototype.delete=function(a){a=this._indexOfKey(this._keys,a);if(0>a)return!1;this._keys.splice(a,1);this._values.splice(a,1);return!0};a.prototype.entries=
function(){var a=this,b=this._keys.map(function(b,h){return[b,a._values[h]]});return new k.ShimIterator(b)};a.prototype.forEach=function(a,b){for(var h=this._keys,e=this._values,l=0,E=h.length;l<E;l++)a.call(b,e[l],h[l],this)};a.prototype.get=function(a){a=this._indexOfKey(this._keys,a);return 0>a?void 0:this._values[a]};a.prototype.has=function(a){return-1<this._indexOfKey(this._keys,a)};a.prototype.keys=function(){return new k.ShimIterator(this._keys)};a.prototype.set=function(a,b){var h=this._indexOfKey(this._keys,
a),h=0>h?this._keys.length:h;this._keys[h]=a;this._values[h]=b;return this};a.prototype.values=function(){return new k.ShimIterator(this._values)};a.prototype[Symbol.iterator]=function(){return this.entries()};return a}(),e[Symbol.species]=e,e));a.default=a.Map;var e})},"@dojo/framework/shim/object":function(){(function(v){"object"===typeof module&&"object"===typeof module.exports?(v=v(require,exports),void 0!==v&&(module.exports=v)):"function"===typeof define&&define.amd&&define(["require","exports",
"./global","./support/has","./Symbol"],v)})(function(v,a){Object.defineProperty(a,"__esModule",{value:!0});var p=v("./global"),k=v("./support/has"),b=v("./Symbol");k.default("es6-object")?(v=p.default.Object,a.assign=v.assign,a.getOwnPropertyDescriptor=v.getOwnPropertyDescriptor,a.getOwnPropertyNames=v.getOwnPropertyNames,a.getOwnPropertySymbols=v.getOwnPropertySymbols,a.is=v.is,a.keys=v.keys):(a.keys=function(a){return Object.keys(a).filter(function(a){return!a.match(/^@@.+/)})},a.assign=function(b){for(var h=
[],e=1;e<arguments.length;e++)h[e-1]=arguments[e];if(null==b)throw new TypeError("Cannot convert undefined or null to object");var k=Object(b);h.forEach(function(b){b&&a.keys(b).forEach(function(a){k[a]=b[a]})});return k},a.getOwnPropertyDescriptor=function(a,k){b.isSymbol(k);return Object.getOwnPropertyDescriptor(a,k)},a.getOwnPropertyNames=function(a){return Object.getOwnPropertyNames(a).filter(function(a){return!a.match(/^@@.+/)})},a.getOwnPropertySymbols=function(a){return Object.getOwnPropertyNames(a).filter(function(a){return!!a.match(/^@@.+/)}).map(function(a){return Symbol.for(a.substring(2))})},
a.is=function(a,b){return a===b?0!==a||1/a===1/b:a!==a&&b!==b});k.default("es2017-object")?(v=p.default.Object,a.getOwnPropertyDescriptors=v.getOwnPropertyDescriptors,a.entries=v.entries,a.values=v.values):(a.getOwnPropertyDescriptors=function(b){return a.getOwnPropertyNames(b).reduce(function(h,e){h[e]=a.getOwnPropertyDescriptor(b,e);return h},{})},a.entries=function(b){return a.keys(b).map(function(a){return[a,b[a]]})},a.values=function(b){return a.keys(b).map(function(a){return b[a]})})})},"esri/core/libs/rbush/rbush":function(){define(["../quickselect/quickselect"],
function(v){function a(b,e){if(!(this instanceof a))return new a(b,e);this._maxEntries=Math.max(4,b||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));e&&("function"===typeof e?this.toBBox=e:this._initFormat(e));this.clear()}function p(a,b){k(a,0,a.children.length,b,a)}function k(a,e,A,c,g){g||(g=n(null));g.minX=Infinity;g.minY=Infinity;g.maxX=-Infinity;g.maxY=-Infinity;for(var l;e<A;e++)l=a.children[e],b(g,a.leaf?c(l):l);return g}function b(a,b){a.minX=Math.min(a.minX,b.minX);a.minY=
Math.min(a.minY,b.minY);a.maxX=Math.max(a.maxX,b.maxX);a.maxY=Math.max(a.maxY,b.maxY);return a}function h(a,b){return a.minX-b.minX}function m(a,b){return a.minY-b.minY}function e(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function u(a){return a.maxX-a.minX+(a.maxY-a.minY)}function w(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY}function y(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY}function n(a){return{children:a,height:1,leaf:!0,minX:Infinity,
minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function G(a,b,e,c,g){for(var l=[b,e],D;l.length;)e=l.pop(),b=l.pop(),e-b<=c||(D=b+Math.ceil((e-b)/c/2)*c,v(a,D,b,e,g),l.push(b,D,D,e))}a.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=this.data,l=[],c=this.toBBox;if(!y(a,b))return l;for(var g=[],z,e,h,B;b;){z=0;for(e=b.children.length;z<e;z++)h=b.children[z],B=b.leaf?c(h):h,y(a,B)&&(b.leaf?l.push(h):w(a,B)?this._all(h,l):g.push(h));b=g.pop()}return l},collides:function(a){var b=
this.data,l=this.toBBox;if(!y(a,b))return!1;for(var c=[],g,z,e,h;b;){g=0;for(z=b.children.length;g<z;g++)if(e=b.children[g],h=b.leaf?l(e):e,y(a,h)){if(b.leaf||w(a,h))return!0;c.push(e)}b=c.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var b=0,l=a.length;b<l;b++)this.insert(a[b]);return this}a=this._build(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<a.height&&(b=this.data,
this.data=a,a=b),this._insert(a,this.data.height-a.height-1,!0)):this.data=a;return this},insert:function(a){a&&this._insert(a,this.data.height-1);return this},clear:function(){this.data=n([]);return this},remove:function(a,b){if(!a)return this;for(var e=this.data,c=this.toBBox(a),g=[],l=[],h,k,B,E;e||g.length;){e||(e=g.pop(),k=g[g.length-1],h=l.pop(),E=!0);if(e.leaf){a:{B=a;var r=e.children,m=b;if(m){for(var n=0;n<r.length;n++)if(m(B,r[n])){B=n;break a}B=-1}else B=r.indexOf(B)}if(-1!==B){e.children.splice(B,
1);g.push(e);this._condense(g);break}}E||e.leaf||!w(e,c)?k?(h++,e=k.children[h],E=!1):e=null:(g.push(e),l.push(h),h=0,k=e,e=e.children[0])}return this},toBBox:function(a){return a},compareMinX:h,compareMinY:m,toJSON:function(){return this.data},fromJSON:function(a){this.data=a;return this},_all:function(a,b){for(var e=[];a;)a.leaf?b.push.apply(b,a.children):e.push.apply(e,a.children),a=e.pop();return b},_build:function(a,b,e,c){var g=e-b+1,z=this._maxEntries,l;if(g<=z)return l=n(a.slice(b,e+1)),p(l,
this.toBBox),l;c||(c=Math.ceil(Math.log(g)/Math.log(z)),z=Math.ceil(g/Math.pow(z,c-1)));l=n([]);l.leaf=!1;l.height=c;var g=Math.ceil(g/z),z=g*Math.ceil(Math.sqrt(z)),h,B,k;for(G(a,b,e,z,this.compareMinX);b<=e;b+=z)for(B=Math.min(b+z-1,e),G(a,b,B,g,this.compareMinY),h=b;h<=B;h+=g)k=Math.min(h+g-1,B),l.children.push(this._build(a,h,k,c-1));p(l,this.toBBox);return l},_chooseSubtree:function(a,b,h,c){for(var g,l,D,k,B,A,r,m;;){c.push(b);if(b.leaf||c.length-1===h)break;r=m=Infinity;g=0;for(l=b.children.length;g<
l;g++)D=b.children[g],B=e(D),A=(Math.max(D.maxX,a.maxX)-Math.min(D.minX,a.minX))*(Math.max(D.maxY,a.maxY)-Math.min(D.minY,a.minY))-B,A<m?(m=A,r=B<r?B:r,k=D):A===m&&B<r&&(r=B,k=D);b=k||b.children[0]}return b},_insert:function(a,e,h){var c=this.toBBox;h=h?a:c(a);var c=[],g=this._chooseSubtree(h,this.data,e,c);g.children.push(a);for(b(g,h);0<=e;)if(c[e].children.length>this._maxEntries)this._split(c,e),e--;else break;this._adjustParentBBoxes(h,c,e)},_split:function(a,b){var e=a[b],c=e.children.length,
g=this._minEntries;this._chooseSplitAxis(e,g,c);c=this._chooseSplitIndex(e,g,c);c=n(e.children.splice(c,e.children.length-c));c.height=e.height;c.leaf=e.leaf;p(e,this.toBBox);p(c,this.toBBox);b?a[b-1].children.push(c):this._splitRoot(e,c)},_splitRoot:function(a,b){this.data=n([a,b]);this.data.height=a.height+1;this.data.leaf=!1;p(this.data,this.toBBox)},_chooseSplitIndex:function(a,b,h){var c,g,z,l,A,B,m;A=B=Infinity;for(c=b;c<=h-b;c++)g=k(a,0,c,this.toBBox),z=k(a,c,h,this.toBBox),l=Math.max(0,Math.min(g.maxX,
z.maxX)-Math.max(g.minX,z.minX))*Math.max(0,Math.min(g.maxY,z.maxY)-Math.max(g.minY,z.minY)),g=e(g)+e(z),l<A?(A=l,m=c,B=g<B?g:B):l===A&&g<B&&(B=g,m=c);return m},_chooseSplitAxis:function(a,b,e){var c=a.leaf?this.compareMinX:h,g=a.leaf?this.compareMinY:m,z=this._allDistMargin(a,b,e,c);b=this._allDistMargin(a,b,e,g);z<b&&a.children.sort(c)},_allDistMargin:function(a,e,h,c){a.children.sort(c);c=this.toBBox;var g=k(a,0,e,c),z=k(a,h-e,h,c),l=u(g)+u(z),A,B;for(A=e;A<h-e;A++)B=a.children[A],b(g,a.leaf?c(B):
B),l+=u(g);for(A=h-e-1;A>=e;A--)B=a.children[A],b(z,a.leaf?c(B):B),l+=u(z);return l},_adjustParentBBoxes:function(a,e,h){for(;0<=h;h--)b(e[h],a)},_condense:function(a){for(var b=a.length-1,e;0<=b;b--)0===a[b].children.length?0<b?(e=a[b-1].children,e.splice(e.indexOf(a[b]),1)):this.clear():p(a[b],this.toBBox)},_initFormat:function(a){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0]));this.compareMinY=new Function("a","b",b.join(a[1]));this.toBBox=new Function("a","return {minX: a"+
a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}};return a})},"esri/core/libs/quickselect/quickselect":function(){define([],function(){function v(k,b,h,m,e){for(;m>h;){if(600<m-h){var u=m-h+1,w=b-h+1,y=Math.log(u),n=.5*Math.exp(2*y/3),y=.5*Math.sqrt(y*n*(u-n)/u)*(0>w-u/2?-1:1);v(k,b,Math.max(h,Math.floor(b-w*n/u+y)),Math.min(m,Math.floor(b+(u-w)*n/u+y)),e)}u=k[b];w=h;n=m;a(k,h,b);for(0<e(k[m],u)&&a(k,h,m);w<n;){a(k,w,n);w++;for(n--;0>e(k[w],u);)w++;for(;0<e(k[n],u);)n--}0===e(k[h],u)?
a(k,h,n):(n++,a(k,n,m));n<=b&&(h=n+1);b<=n&&(m=n-1)}}function a(a,b,h){var k=a[b];a[b]=a[h];a[h]=k}function p(a,b){return a<b?-1:a>b?1:0}return function(a,b,h,m,e){v(a,b,h||0,m||a.length-1,e||p)}})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(v,a,p,k,b,h,m){function e(a,c){var b;
if(!c)return null;if("x"in c){var e={x:0,y:0};a=a(c.x,c.y,n,0);e.x=a[0];e.y=a[1];null!=c.z&&(e.z=c.z);null!=c.m&&(e.m=c.m);return e}if("xmin"in c)return e={xmin:0,ymin:0,xmax:0,ymax:0},b=a(c.xmin,c.ymin,n,0),e.xmin=b[0],e.ymin=b[1],a=a(c.xmax,c.ymax,n,0),e.xmax=a[0],e.ymax=a[1],c.hasZ&&(e.zmin=c.zmin,e.zmax=c.zmax,e.hasZ=!0),c.hasM&&(e.mmin=c.mmin,e.mmax=c.mmax,e.hasM=!0),e;if("rings"in c)return{rings:u(c.rings,a),hasM:c.hasM,hasZ:c.hasZ};if("paths"in c)return{paths:u(c.paths,a),hasM:c.hasM,hasZ:c.hasZ};
if("points"in c)return{points:w(c.points,a),hasM:c.hasM,hasZ:c.hasZ}}function u(a,c){for(var b=[],e=0;e<a.length;e++)b.push(w(a[e],c));return b}function w(a,c){for(var b=[],e=0;e<a.length;e++){var h=a[e],l=c(h[0],h[1],[0,0],0);b.push(l);2<h.length&&l.push(h[2]);3<h.length&&l.push(h[3])}return b}function y(a,c){return!h.isValid(a)||!h.isValid(c)||h.equals(a,c)||m.canProject(a,c)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});var n=[0,0];a.checkProjectionSupport=function(a,c){if(Array.isArray(a)){for(var g=
0;g<a.length;g++){var e=a[g];if(y(e.geometry&&e.geometry.spatialReference,c))return b.isSupported()?b.load():k.reject(new p("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:c}))}return k.resolve()}return y(a,c)?b.isSupported()?b.load():k.reject(new p("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:c})):k.resolve()};var G=e.bind(null,m.lngLatToXY),l=e.bind(null,m.xyToLngLat);a.project=function(a,
c,g){return h.isValid(c)&&h.isValid(g)&&!h.equals(c,g)?m.canProject(c,g)?h.isWebMercator(g)?G(a):l(a):b.projectMany([a],c,g,null,!0)[0]:a};var E=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}a.prototype.push=function(a,b,e){var c=this;a&&a.length&&b&&e&&!h.equals(b,e)||k.resolve(a);var g={geometries:a,inSpatialReference:b,outSpatialReference:e,resolve:null};this._jobs.push(g);return k.create(function(a){g.resolve=a;null===c._timer&&(c._timer=setTimeout(c._process,
10))},function(){var a=c._jobs.indexOf(g);-1<a&&c._jobs.splice(a,1)})};a.prototype._process=function(){this._timer=null;var a=this._jobs.shift();if(a){var g=a.geometries,e=a.inSpatialReference,D=a.outSpatialReference,a=a.resolve;m.canProject(e,D)?h.isWebMercator(D)?a(g.map(G)):a(g.map(l)):a(b.projectMany(g,e,D,null,!0));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());a.projectMany=function(a,c,b){return E.push(a,c,b)}})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./SpatialReference ./support/GeographicTransformation".split(" "),
function(v,a,p,k,b,h){function m(a,k,l,m,A){void 0===m&&(m=null);void 0===A&&(A=!1);if(null===m){var c=h.cacheKey(k,l);void 0!==y[c]?m=y[c]:(m=e(k,l,null),null===m&&(m=new h),y[c]=m)}return u._project(a,k,l instanceof b||!1===A?l:new b(l),m,A)}function e(a,b,e){void 0===e&&(e=null);a=u._getTransformation(a,b,e);return null!==a?h.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});var u=null;a.isLoaded=function(){return!!u&&k.isLoaded()};a.isSupported=function(){return k.isSupported()};
var w=null;a.load=function(){return w?w:w=p.create(function(a,b){var e=k.load();v(["./geometryEngine"],function(h){u=h;e.then(function(){u._enableProjection(k);a()},function(a){b(a)})})})};a.project=function(a,b,e){void 0===e&&(e=null);return a instanceof Array?0===a.length?[]:m(a,a[0].spatialReference,b,e):m([a],a.spatialReference,b,e)[0]};var y={};a.projectMany=m;a.getTransformation=e;a.getTransformations=function(a,b,e){void 0===e&&(e=null);a=u._getTransformationBySuitability(a,b,e);if(null!==
a){b=[];for(e=0;e<a.length;e++)b.push(h.fromGE(a[e]));return b}return[]}})},"esri/geometry/pe":function(){define(["require","exports","../core/tsSupport/extendsHelper","../core/has","../core/promiseUtils"],function(v,a,p,k,b){function h(b){function c(a,b,c){a[b]=c(a[b])}a._pe=b;n.init();G.init();l.init();E.init();A.init();a.PeGCSExtent=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}p(c,b);c.prototype.destroy=function(){a._pe.destroy(this)};return c}(a._pe.PeGCSExtent);for(var e=
0,h=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,a._pe.PeUnit];e<h.length;e++)b=h[e],c(b.prototype,"getName",function(a){return function(){return a.call(this,Array(n.PE_NAME_MAX))}});e=0;for(h=[a._pe.PeGeogtran,a._pe.PeProjcs];e<h.length;e++)b=h[e],c(b.prototype,"getParameters",function(b){return function(){for(var c=Array(n.PE_PARM_MAX),g=b.call(this),e=0;e<c.length;e++){var h=a._pe.getValue(g,"*");c[e]=h?a._pe.wrapPointer(h,
a._pe.PeParameter):null;g+=Int32Array.BYTES_PER_ELEMENT}return c}});c(a._pe.PeHorizon.prototype,"getCoord",function(a){return function(){var b=this.getSize();if(!b)return null;var c=[],g=a.call(this);w(c,b,g);return c}});c(a._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(b){var c=a._pe._pe_getPeGTlistExtendedGTsSize();return function(){var g=null,e=b.call(this);if(!a._pe.compare(e,a._pe.NULL)){var g=[e],h=this.getSteps();if(1<h)for(var e=a._pe.getPointer(e),q=1;q<h;q++)g.push(a._pe.wrapPointer(e+
c*q,a._pe.PeGTlistExtendedGTs))}return g}});var k=a._pe._pe_getPeHorizonSize();b=function(b){return function(){var c=this._cache;c||(this._cache=c=new Map);if(c.has(b))return c.get(b);var g=null,e=b.call(this);if(!a._pe.compare(e,a._pe.NULL)){var g=[e],h=e.getNump();if(1<h)for(var e=a._pe.getPointer(e),q=1;q<h;q++)g.push(a._pe.wrapPointer(e+k*q,a._pe.PeHorizon))}c.set(b,g);return g}};c(a._pe.PeProjcs.prototype,"horizonGcsGenerate",b);c(a._pe.PeProjcs.prototype,"horizonPcsGenerate",b);a._pe.PeObject.prototype.toString=
function(b){void 0===b&&(b=n.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var c=a._pe.getPointer(this),g=a._pe.ensureInt8(Array(n.PE_BUFFER_MAX));return a._pe.Pointer_stringify(a._pe._pe_object_to_string_ext(c,b,g))}}function m(b){if(b){var c=a._pe.getClass(b);c&&(c=a._pe.getCache(c))&&(b=a._pe.getPointer(b))&&delete c[b]}}function e(b,e){var c=[];e=Array(e);for(var g=0;g<b;g++)c.push(a._pe.ensureInt8(e));return c}function u(a){var b;Array.isArray(a[0])?(b=[],a.forEach(function(a){b.push(a[0],a[1])})):
b=a;return b}function w(b,e,h,l){void 0===l&&(l=!1);if(l)for(l=0;l<2*e;l++)b[l]=a._pe.getValue(h+l*Float64Array.BYTES_PER_ELEMENT,"double");else{var c=0===b.length;for(l=0;l<e;l++)c&&(b[l]=Array(2)),b[l][0]=a._pe.getValue(h,"double"),b[l][1]=a._pe.getValue(h+Float64Array.BYTES_PER_ELEMENT,"double"),h+=2*Float64Array.BYTES_PER_ELEMENT}}Object.defineProperty(a,"__esModule",{value:!0});var y;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!k("esri-wasm")};a.load=function(){return y?
y:y=b.create(function(a,b){v(["./support/pe-wasm"],function(c){c({locateFile:function(a){return v.toUrl("./support/"+a)},onAbort:function(a){b(Error(a))}}).then(function(b){h(b);a()})})})};(function(b){function c(b,c,e){a._pe.ensureCache.prepare();var g=u(e),h=e===g,g=a._pe.ensureFloat64(g);(b=a._pe._pe_geog_to_proj(a._pe.getPointer(b),c,g))&&w(e,c,g,h);return b}function e(a,b,c){return h(a,b,c,0)}function h(b,c,e,g){a._pe.ensureCache.prepare();var h=u(e),l=e===h,h=a._pe.ensureFloat64(h);(b=a._pe._pe_proj_to_geog_center(a._pe.getPointer(b),
c,h,g))&&w(e,c,h,l);return b}b.geogToProj=c;b.projGeog=function(a,b,g,h){switch(h){case n.PE_TRANSFORM_P_TO_G:return e(a,b,g);case n.PE_TRANSFORM_G_TO_P:return c(a,b,g)}return 0};b.projToGeog=e;b.projToGeogCenter=h})(a.PeCSTransformations||(a.PeCSTransformations={}));var n;(function(b){b.init=function(){b.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;b.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;b.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;b.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;
b.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;b.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;b.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;b.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;b.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;b.PE_TYPE_NONE=a._pe.PeDefs.prototype.PE_TYPE_NONE;b.PE_TYPE_GEOGCS=a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;b.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;b.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;b.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;
b.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;b.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;b.PE_STR_AUTH_NONE=a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;b.PE_STR_AUTH_TOP=a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;b.PE_STR_NAME_CANON=a._pe.PeDefs.prototype.PE_STR_NAME_CANON;b.PE_PARM_X0=a._pe.PeDefs.prototype.PE_PARM_X0;b.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;b.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;b.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;
b.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;b.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;b.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;b.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;b.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;b.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(n=a.PeDefs||(a.PeDefs={}));(function(b){function c(b,c){var g=null,l=h[b];l||(l={},h[b]=l);l.hasOwnProperty(String(c))?g=l[c]:(b=a._pe.PeFactory.prototype.factoryByType(b,
c),a._pe.compare(b,a._pe.NULL)||(g=b,l[c]=g));return g=e(g)}function e(b){if(b){var c=b.getType();switch(c){case n.PE_TYPE_GEOGCS:b=a._pe.castObject(b,a._pe.PeGeogcs);break;case n.PE_TYPE_PROJCS:b=a._pe.castObject(b,a._pe.PeProjcs);break;case n.PE_TYPE_GEOGTRAN:b=a._pe.castObject(b,a._pe.PeGeogtran);break;default:c&n.PE_TYPE_UNIT&&(b=a._pe.castObject(b,a._pe.PeUnit))}}return b}var h={},l={};b.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};b.coordsys=function(a){return c(n.PE_TYPE_COORDSYS,
a)};b.factoryByType=c;b.fromString=function(b,c){var g=null,h=l[b];h||(h={},l[b]=h);h.hasOwnProperty(c)?g=h[c]:(b=a._pe.PeFactory.prototype.fromString(b,c),a._pe.compare(b,a._pe.NULL)||(g=b,h[c]=g));return g=e(g)};b.geogcs=function(a){return c(n.PE_TYPE_GEOGCS,a)};b.geogtran=function(a){return c(n.PE_TYPE_GEOGTRAN,a)};b.getCode=function(b){return a._pe.PeFactory.prototype.getCode(b)};b.projcs=function(a){return c(n.PE_TYPE_PROJCS,a)};b.unit=function(a){return c(n.PE_TYPE_UNIT,a)}})(a.PeFactory||(a.PeFactory=
{}));a.PeGCSExtent=null;var G;(function(b){var c;b.init=function(){b.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;c=a._pe._pe_getPeGTlistExtendedEntrySize()};b.getGTlist=function(b,e,g,h,l,k){var r=null,z=new a._pe.PeInteger(k);try{var q=a._pe.PeGTlistExtended.prototype.getGTlist(b,e,g,h,l,z);if(k=z.val)if(r=[q],1<k){var F=a._pe.getPointer(q);for(b=1;b<k;b++)r.push(a._pe.wrapPointer(F+c*b,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(z)}return r}})(G=a.PeGTlistExtended||
(a.PeGTlistExtended={}));(function(b){b.destroy=function(b){if(b&&b.length){for(var c=0;c<b.length;c++){var e=b[c];m(e);e.getEntries().forEach(function(a){m(a);a=a.getGeogtran();m(a);a.getParameters().forEach(m);[a.getGeogcs1(),a.getGeogcs2()].forEach(function(a){m(a);var b=a.getDatum();m(b);m(b.getSpheroid());m(a.getPrimem());m(a.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(b[0])}}})(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));(function(b){b.geogToGeog=function(b,c,e,h,
l){a._pe.ensureCache.prepare();var g=u(e),k=e===g,g=a._pe.ensureFloat64(g),z=0;h&&(z=a._pe.ensureFloat64(h));(b=a._pe._pe_geog_to_geog(a._pe.getPointer(b),c,g,z,l))&&w(e,c,g,k);return b}})(a.PeGTTransformations||(a.PeGTTransformations={}));(function(b){function c(b,c,g,h,l,k){a._pe.ensureCache.prepare();var r,q;switch(b){case "dd":r=a._pe._pe_geog_to_dd;q=n.PE_DD_MAX;break;case "ddm":r=a._pe._pe_geog_to_ddm;q=n.PE_DDM_MAX;break;case "dms":r=a._pe._pe_geog_to_dms,q=n.PE_DMS_MAX}b=0;c&&(b=a._pe.getPointer(c));
c=u(h);c=a._pe.ensureFloat64(c);q=e(g,q);h=a._pe.ensureInt32(q);if(l=r(b,g,c,l,h))for(r=0;r<g;r++)k[r]=a._pe.Pointer_stringify(q[r]);return l}function h(b,c,e,g,h){a._pe.ensureCache.prepare();var l;switch(b){case "dd":l=a._pe._pe_dd_to_geog;break;case "ddm":l=a._pe._pe_ddm_to_geog;break;case "dms":l=a._pe._pe_dms_to_geog}b=0;c&&(b=a._pe.getPointer(c));c=g.map(function(b){return a._pe.ensureString(b)});g=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*e));(l=l(b,e,g,c))&&w(h,e,c);return l}b.geog_to_dms=
function(a,b,e,g,h){return c("dms",a,b,e,g,h)};b.dms_to_geog=function(a,b,c,e){return h("dms",a,b,c,e)};b.geog_to_ddm=function(a,b,e,g,h){return c("ddm",a,b,e,g,h)};b.ddm_to_geog=function(a,b,c,e){return h("ddm",a,b,c,e)};b.geog_to_dd=function(a,b,e,g,h){return c("dd",a,b,e,g,h)};b.dd_to_geog=function(a,b,c,e){return h("dd",a,b,c,e)}})(a.PeNotationDms||(a.PeNotationDms={}));var l;(function(b){b.init=function(){b.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;b.PE_MGRS_STYLE_OLD=
a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;b.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;b.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;b.PE_MGRS_ADD_SPACES=a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};b.geog_to_mgrs_extended=function(b,c,h,l,k,m,r){a._pe.ensureCache.prepare();var g=0;b&&(g=a._pe.getPointer(b));b=u(h);h=a._pe.ensureFloat64(b);b=e(c,n.PE_MGRS_MAX);var z=a._pe.ensureInt32(b);if(l=a._pe._pe_geog_to_mgrs_extended(g,
c,h,l,k,m,z))for(k=0;k<c;k++)r[k]=a._pe.Pointer_stringify(b[k]);return l};b.mgrs_to_geog_extended=function(b,c,e,h,l){a._pe.ensureCache.prepare();var g=0;b&&(g=a._pe.getPointer(b));b=e.map(function(b){return a._pe.ensureString(b)});e=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(h=a._pe._pe_mgrs_to_geog_extended(g,c,e,h,b))&&w(l,c,b);return h}})(l=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(b){b.geog_to_usng=function(b,c,h,l,k,m,r){a._pe.ensureCache.prepare();var g=0;b&&(g=a._pe.getPointer(b));
b=u(h);h=a._pe.ensureFloat64(b);b=e(c,n.PE_MGRS_MAX);var z=a._pe.ensureInt32(b);if(l=a._pe._pe_geog_to_usng(g,c,h,l,k,m,z))for(k=0;k<c;k++)r[k]=a._pe.Pointer_stringify(b[k]);return l};b.usng_to_geog=function(b,c,e,h){a._pe.ensureCache.prepare();var g=0;b&&(g=a._pe.getPointer(b));b=e.map(function(b){return a._pe.ensureString(b)});e=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(g=a._pe._pe_usng_to_geog(g,c,e,b))&&w(h,c,b);return g}})(a.PeNotationUsng||(a.PeNotationUsng={}));var E;(function(b){b.init=
function(){b.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;b.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;b.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};b.geog_to_utm=function(b,c,h,l,k){a._pe.ensureCache.prepare();var g=0;b&&(g=a._pe.getPointer(b));b=u(h);h=a._pe.ensureFloat64(b);b=e(c,n.PE_UTM_MAX);var r=a._pe.ensureInt32(b);if(l=a._pe._pe_geog_to_utm(g,c,h,l,r))for(g=0;g<c;g++)k[g]=a._pe.Pointer_stringify(b[g]);return l};b.utm_to_geog=
function(b,c,e,h,l){a._pe.ensureCache.prepare();var g=0;b&&(g=a._pe.getPointer(b));b=e.map(function(b){return a._pe.ensureString(b)});e=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(h=a._pe._pe_utm_to_geog(g,c,e,h,b))&&w(l,c,b);return h}})(E=a.PeNotationUtm||(a.PeNotationUtm={}));var A;(function(b){var c=new Map;b.init=function(){b.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;b.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;b.PE_POLE_OUTSIDE_BOUNDARY=
a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;b.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};b.generate=function(e,g){void 0===g&&(g=b.PE_PCSINFO_OPTION_DOMAIN);var h,l;c.has(e)&&(l=c.get(e),l[g]&&(h=l[g]));h||(h=a._pe.PePCSInfo.prototype.generate(e,g),l||(l=[],c.set(e,l)),l[g]=h);return h}})(A=a.PePCSInfo||(a.PePCSInfo={}));(function(b){b.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||(a.PeVersion={}));a._init=h})},"esri/geometry/support/GeographicTransformation":function(){define(["require",
"exports","./GeographicTransformationStep"],function(v,a,p){return function(){function a(a){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(a&&a.steps){var b=0;for(a=a.steps;b<a.length;b++){var k=a[b];k instanceof p?this.steps.push(k):this.steps.push(new p({wkid:k.wkid,wkt:k.wkt,isInverse:k.isInverse}))}}}a.cacheKey=function(a,h){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==h.wkid&&null!==h.wkid?
h.wkid.toString():"-1",void 0!==h.wkt&&null!==h.wkt?h.wkt.toString():""].join()};a.fromGE=function(b){var h=new a,k="",e=0;for(b=b.steps;e<b.length;e++){var u=p.fromGE(b[e]);h.steps.push(u);k+=u.uid.toString()+","}h._cached_projection={};h._gtlistentry=null;h._chain=k;return h};a.prototype.getInverse=function(){var b=new a;b.steps=[];for(var h=this.steps.length-1;0<=h;h--)b.steps.push(this.steps[h].getInverse());return b};a.prototype.getGTListEntry=function(){for(var a="",h=0,k=this.steps;h<k.length;h++)a+=
k[h].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};a.prototype.assignCachedGe=function(b,h,k){this._cached_projection[a.cacheKey(b,h)]=k};a.prototype.getCachedGeTransformation=function(b,h){for(var k="",e=0,u=this.steps;e<u.length;e++)k+=u[e].uid.toString()+",";k!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=k);b=this._cached_projection[a.cacheKey(b,h)];return void 0===b?null:b};return a}()})},
"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(v,a){var p=0;return function(){function a(a){void 0===a&&(a=null);this.uid=p++;a?(this._wkt=void 0!==a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(b){var h=new a;h._wkt=b.wkt;h._wkid=b.wkid;h._isInverse=b.isInverse;return h};Object.defineProperty(a.prototype,"wkt",
{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=p++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},set:function(a){this._wkid=a;this.uid=p++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=p++},enumerable:!0,configurable:!0});a.prototype.getInverse=function(){var b=new a;b._wkt=this.wkt;b._wkid=this._wkid;
b._isInverse=!this.isInverse;return b};return a}()})},"esri/layers/graphics/data/QueryEngine":function(){define("require exports ../../../core/tsSupport/assignHelper @dojo/framework/shim/Map @dojo/framework/shim/Set ../../../geometry ../../../core/Error ../../../core/Logger ../../../core/MemCache ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/support/aaBoundingRect ../../../geometry/support/normalizeUtils ../../../geometry/support/scaleUtils ../../../geometry/support/spatialReferenceUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./utils ../../../tasks/support/Query".split(" "),
function(v,a,p,k,b,h,m,e,u,w,y,n,G,l,E,A,c,g,z,D,J,B){function ca(a){return a?JSON.parse(JSON.stringify(a,["latestWkid","wkid","wkt"])):a}function r(a,b,e,c,g,h,l,k){l&&!h?c.forEachFeatureInBounds(g,function(b){var c=J.getCentroid(e,b,k);b=b.attributes;c&&a.push(new Q(b,null,c))}):h&&!l?c.forEachFeatureInBounds(g,function(c){var g=c.attributes,h=J.getGeometry(e,c,0,k);h&&(b.add(c.objectId),a.push(new Q(g,h)))}):c.forEachFeatureInBounds(g,function(c){var g=c.attributes,h=J.getGeometry(e,c,0,k),l=J.getCentroid(e,
c,k);h&&l&&(b.add(c.objectId),a.push(new Q(g,h,l)))})}Object.defineProperty(a,"__esModule",{value:!0});var P=e.getLogger("esri.layers.graphics.data.QueryEngine"),Q=function(){return function(a,b,c){this.attributes=a;this.geometry=b;this.centroid=c}}(),q={},F=new b.default,U=new u.Storage(2E6),O=0;v=function(){function a(a){var b=this;this.capabilities={query:g.queryCapabilities};this.fieldsMap=new k.default;this.geometryType=a.geometryType;this.hasM=a.hasM;this.hasZ=a.hasZ;this.objectIdField=a.objectIdField;
this.spatialReference=a.spatialReference;this.definitionExpression=a.definitionExpression;this.cacheSpatialQueries=a.cacheSpatialQueries||!1;this.gdbVersion=a.gdbVersion;this.historicMoment=a.historicMoment;this.spatialIndex=a.spatialIndex;this.spatialIndex.setEngine(this);this.timeInfo=a.timeInfo;this.cacheSpatialQueries&&(this._geometryQueryCache=new u(O++ +"$$",U));a.fields.forEach(function(a){b.fieldsMap.set(a.name.trim(),a);b.fieldsMap.set(a.name.trim().toLowerCase(),a)})}a.prototype.destroy=
function(){this.clearCache();this._geometryQueryCache&&this._geometryQueryCache.destroy();this.fieldsMap.clear()};Object.defineProperty(a.prototype,"fullExtent",{get:function(){var a=this.spatialIndex.fullBounds;return a?{xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:ca(this.spatialReference)}:null},enumerable:!0,configurable:!0});a.prototype.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear();this._allItems=null};a.prototype.executeQuery=function(a){var b=
this;void 0===a&&(a=new B);var c=a.clone();return this._normalizeQuery(c).then(function(a){return b._checkQuerySupport(a)}).then(function(a){return b._executeGeometryQuery(a)}).then(function(a){return a.executeObjectIdsQuery(c)}).then(function(a){return a.executeAttributesQuery(c)}).catch(function(a){if(a===q)return new z.default([],b);throw a;}).then(function(a){return a.createQueryResponse(c)})};a.prototype.executeQueryForCount=function(a){var b=this;void 0===a&&(a=new B);var c=a.clone();c.returnGeometry=
!1;c.returnCentroid=!1;c.outSpatialReference=null;return this._normalizeQuery(c).then(function(a){return b._checkQuerySupport(a)}).then(function(a){return b._executeGeometryQuery(a)}).then(function(a){return a.executeObjectIdsQuery(c)}).then(function(a){return a.executeAttributesQuery(c)}).then(function(a){return a.size}).catch(function(a){if(a===q)return 0;throw a;})};a.prototype.executeQueryForExtent=function(a){var b=this;void 0===a&&(a=new B);var e=a.clone(),g=e.outSpatialReference;return this._normalizeQuery(e).then(function(a){return b._checkQuerySupport(a)}).then(function(){e.returnGeometry=
!0;e.returnCentroid=!1;e.outSpatialReference=null;return e}).then(function(a){return b._executeGeometryQuery(a)}).then(function(a){return a.executeObjectIdsQuery(e)}).then(function(a){return a.executeAttributesQuery(e)}).then(function(a){var e=a.size;if(!e)return{count:e,extent:null};var h={xmin:Number.POSITIVE_INFINITY,ymin:Number.POSITIVE_INFINITY,xmax:Number.NEGATIVE_INFINITY,ymax:Number.NEGATIVE_INFINITY,spatialReference:ca(b.spatialReference)};b.spatialIndex.forEachBounds(a.items,function(a){h.xmin=
Math.min(a[0],h.xmin);h.ymin=Math.min(a[1],h.ymin);h.xmax=Math.max(a[2],h.xmax);h.ymax=Math.max(a[3],h.ymax)});a=c.project(h,a.spatialReference,g);a.spatialReference=ca(g&&g.toJSON()||b.spatialReference);if(0===a.xmax-a.xmin){var k=l.getMetersPerUnitForSR(a.spatialReference);a.xmin-=k;a.xmax+=k}0===a.ymax-a.ymin&&(k=l.getMetersPerUnitForSR(a.spatialReference),a.ymin-=k,a.ymax+=k);return{count:e,extent:a}}).catch(function(a){if(a===q)return{count:0,extent:null};throw a;})};a.prototype.executeQueryForIds=
function(a){var b=this;void 0===a&&(a=new B);var c=a.clone();c.returnGeometry=!1;c.returnCentroid=!1;c.outSpatialReference=null;return this._normalizeQuery(c).then(function(a){return b._checkQuerySupport(a)}).then(function(a){return b._executeGeometryQuery(a)}).then(function(a){return a.executeObjectIdsQuery(c)}).then(function(a){return a.executeAttributesQuery(c)}).then(function(a){a=a.items;for(var b=[],c=0;c<a.length;c++)b[c]=a[c].objectId;return b}).catch(function(a){if(a===q)return[];throw a;
})};a.prototype.executeTileQuery=function(a,c){var e=this,g=c.returnGeometry,h=c.returnCentroid,l=c.pixelBuffer;c=new b.default;var k=[],l=l*a.resolution,q=n.pad(a.bounds,l,n.create());r(k,c,this,this.spatialIndex,q,g,h,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[a.bounds[0],a.bounds[3]]});if("esriGeometryPoint"===this.geometryType||h){var F=E.getInfo(this.spatialReference);if(F){var m=F.valid,F=m[0],m=m[1];if(q[0]<F){var z=n.fromValues(m-l,q[1],m,q[3]);r(k,c,this,this.spatialIndex,
z,g,h,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[m,a.bounds[3]]})}q[2]>m&&(l=n.fromValues(F,q[1],F+l,q[3]),r(k,c,this,this.spatialIndex,l,g,h,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[F-m+a.bounds[0],a.bounds[3]]}))}}k.sort(function(a,b){return a.attributes[e.objectIdField]-b.attributes[e.objectIdField]});return{features:k,objectIds:c}};a.prototype.executeTileQueryForIds=function(a,b){a=n.pad(a.bounds,b.pixelBuffer*a.resolution,n.create());
var c=[];this.spatialIndex.forEachFeatureInBounds(a,function(a){return c.push(a.objectId)});return c};a.prototype.executeQueryForLatestObservations=function(a){var b=this;if(this.timeInfo)return this.executeQuery(a).then(function(a){return b._filterLatest(a,b.timeInfo)});P.error(new m("invalid-query","Unable to make time-based query as the underlying service does include TimeInfo"))};a.prototype._filterLatest=function(a,b){var c=b.trackIdField,e=b.startTimeField;b=b.endTimeField||e;for(var e=new k.default,
g=[],h=0,l=a.features;h<l.length;h++){var q=l[h],F=q.attributes[c],r=q.attributes[b];(!e.has(F)||e.get(F).attributes[b]<r)&&e.set(F,q)}e.forEach(function(a){return g.push(a)});return p({},a,{features:g})};a.prototype._getAll=function(){if(!this._allItems){var a=[];this.spatialIndex.forEachFeature(function(b){return a.push(b)});this._allItems=new z.default(a,this)}return this._allItems};a.prototype._normalizeQuery=function(a){var b=this,e=this.definitionExpression,g=a.where,h=a.geometry,l=a.outFields,
k=a.orderByFields,F=a.groupByFieldsForStatistics,r=a.outStatistics;a.where=g=g&&g.trim();if(!g||/^1 *= *1$/.test(g)||e&&e===g)a.where=null;if(l)for(e=0;e<l.length;e++)l[e]=l[e].trim();if(k)for(e=0;e<k.length;e++)k[e]=k[e].trim();if(F)for(e=0;e<F.length;e++)F[e]=F[e].trim();if(r)for(e=0;e<r.length;e++)r[e].onStatisticField&&(r[e].onStatisticField=r[e].onStatisticField.trim());if(!h)return w.resolve(a);a.outSpatialReference||(a.outSpatialReference=h.spatialReference);return this._getInputGeometry(a).then(function(b){return a.geometry=
b}).then(function(a){return c.checkProjectionSupport(a.spatialReference,b.spatialReference)}).then(function(){return G.normalizeCentralMeridian(a.geometry)}).then(function(a){return c.project(a[0].toJSON(),a[0].spatialReference,b.spatialReference)}).then(function(c){if(!c)throw q;c.spatialReference=b.spatialReference;return a.read({geometry:c})})};a.prototype._executeGeometryQuery=function(a){var b=this,c=a.geometry,e=a.outSpatialReference,g=a.spatialRelationship,h=E.isValid(e)&&!E.equals(this.spatialReference,
e),l=h?JSON.stringify({geometry:c,spatialRelationship:g,outSpatialReference:e}):JSON.stringify({geometry:c,spatialRelationship:g});if(this.cacheSpatialQueries){var k=this._geometryQueryCache.get(l);if(void 0!==k)return w.resolve(k)}k=null;if(c){var q=this._searchSpatialIndex(this._getQueryBBoxes(c));if(!q.length)return c=new z.default([],this),this.cacheSpatialQueries&&this._geometryQueryCache.put(l,c,c.size||1),w.resolve(c);k="envelope-intersects"===a.spatialRelationship||"esriGeometryPoint"===this.geometryType&&
D.canQueryWithRBush(c)?w.resolve(new z.default(q,this)):D.getSpatialQueryOperator(g,c,this.geometryType).then(function(a){if(a){var c=q.filter(function(c){return a(J.getGeometry(b,c))});return new z.default(c,b)}})}else k=w.resolve(this._getAll());return k.then(function(c){if(h&&(a.returnGeometry||a.returnCentroid))return c.project(e).then(function(a){b.cacheSpatialQueries&&b._geometryQueryCache.put(l,a,a.size||1);return a});b.cacheSpatialQueries&&b._geometryQueryCache.put(l,c,c.size||1);return c})};
a.prototype._getInputGeometry=function(a){var b=a.geometry,e=a.distance,g=a.units;if(null==e)return w.resolve(b);a=b.spatialReference;var k=g||l.getUnitString(a),g=null,g=a&&(a.isGeographic||a.isWebMercator)?w.resolve(b):c.checkProjectionSupport(a,h.SpatialReference.WGS84).then(function(){return y.project(b,h.SpatialReference.WGS84)});return g.then(function(a){return D.getGeodesicBufferOperator().then(function(b){return b(a,e,k)})})};a.prototype._getQueryBBoxes=function(a){if("point"===a.type)return[n.fromValues(a.x,
a.y,a.x,a.y)];a=D.canQueryWithRBush(a)?a:a.extent;switch(a.type){case "extent":return[n.fromExtent(a)];case "polygon":return a.rings.map(function(a){return n.fromValues(a[0][0],a[0][1],a[2][0],a[2][1])})}};a.prototype._searchSpatialIndex=function(a){for(var b=[],c=0;c<a.length;c++)this.spatialIndex.forEachFeatureInBounds(a[c],function(a){F.has(a)||(b.push(a),F.add(a))});F.clear();return b};a.prototype._checkQuerySupport=function(a){return 0>a.distance||null!=a.geometryPrecision||a.multipatchOption||
a.pixelSize||a.relationParameter||a.text||a.timeExtent?w.reject(new m("feature-store:unsupported-query","Unsupported query options",{query:a})):w.all([this._checkAttributesQuerySupport(a),this._checkStatisticsQuerySupport(a),D.checkSpatialQuerySupport(a,this.geometryType,this.spatialReference),c.checkProjectionSupport(this.spatialReference,a.outSpatialReference)]).then(function(){return a})};a.prototype._checkAttributesQuerySupport=function(a){var b=a.outFields,c=a.orderByFields,e=a.returnDistinctValues;
c&&0<c.length&&(c=c.map(function(a){return-1<a.indexOf(" ASC")?a.split(" ASC")[0]:-1<a.indexOf(" DESC")?a.split(" DESC")[0]:a}),A.validateFields(this.fieldsMap,c,"orderByFields contains missing fields"));if(b&&0<b.length)A.validateFields(this.fieldsMap,b,"outFields contains missing fields");else if(e)throw new m("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:a});A.validateWhere(this.fieldsMap,a.where)};a.prototype._checkStatisticsQuerySupport=function(a){var b=
a.outStatistics,c=a.groupByFieldsForStatistics,e=a.having,g=c&&c.length,h=b&&b.length;if(e){if(!g||!h)return w.reject(new m("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:a}));A.validateHaving(this.fieldsMap,e,b)}if(h&&!b.some(function(a){return"exceedslimit"===a.statisticType}))for(e=b.map(function(a){return a.onStatisticField}),A.validateFields(this.fieldsMap,e,"onStatisticFields contains missing fields"),g&&A.validateFields(this.fieldsMap,
c,"groupByFieldsForStatistics contains missing fields"),c=0;c<b.length;c++){var e=b[c],h=e.onStatisticField,l=e.statisticType;if("exceedslimit"===l)return w.reject(new m("feature-store:unsupported-query","statistic type exceedslimit is not supported",{definition:e,query:a}));if((!g||"count"!==l)&&h&&A.hasInvalidFieldType(h,this.fieldsMap))return w.reject(new m("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:e,query:a}))}};return a}();a.default=v})},"esri/layers/graphics/data/attributeSupport":function(){define("require exports @dojo/framework/shim/Set ../../../core/Error ../../../core/ItemCache ../../../core/sql/WhereClause".split(" "),
function(v,a,p,k,b,h){function m(b){if(!b)return null;var e=a.invalidClauseCache.get(b);if(void 0!==e)return e;e=a.whereClausesCache.get(b);if(void 0!==e)return e;e=h.create(b);a.whereClausesCache.put(b,e);return e}function e(a,b,h,l){void 0===l&&(l=!0);for(var w=[],A=0;A<b.length;A++){var c=b[A];if("*"!==c&&!a.has(c))if(l){var g=u(c);try{var z=m(g);if(!z.isStandardized())throw new k("feature-store:unsupported-query","expression is not standard",{clause:z});e(a,z.getFields(),"expression contains missing fields")}catch(D){if((g=
D&&D.details)&&g.clause)throw D;g&&g.missingFields?Array.prototype.push.apply(w,g.missingFields):w.push(c)}}else w.push(c)}if(w.length)throw new k("feature-store:unsupported-query",h,{missingFields:w});}function u(a){return a.split(" as ")[0]}Object.defineProperty(a,"__esModule",{value:!0});a.invalidClauseCache=new b(500);a.whereClausesCache=new b(50);var w=new p.default("esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));
a.validateWhere=function(b,m){if(!m)return!0;var u;try{u=h.create(m),a.whereClausesCache.put(m,u)}catch(l){throw a.invalidClauseCache.put(m,null),new k("feature-store:unsupported-query","invalid SQL expression",{where:m});}if(!u.isStandardized())throw new k("feature-store:unsupported-query","where clause is not standard",{where:m});m=u.getFields();e(b,m,"where clause contains missing fields");return!0};a.validateHaving=function(b,m,u){if(!m)return!0;var l;try{l=h.create(m),a.whereClausesCache.put(m,
l)}catch(A){throw a.invalidClauseCache.put(m,null),new k("feature-store:unsupported-query","invalid SQL expression",{having:m});}if(!l.isAggregate())throw new k("feature-store:unsupported-query","having does not contain a valid aggregate function",{having:m});var w=l.getFields();e(b,w,"having contains missing fields");if(!l.getExpressions().every(function(a){var c=a.aggregateType;a=a.field;var e=b.has(a)&&b.get(a).name;return u.some(function(a){var g=a.statisticType;a=a.onStatisticField.toLowerCase().trim();
return(b.has(a)&&b.get(a).name)===e&&g.toLowerCase().trim()===c})}))throw new k("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:m});return!0};a.getWhereClause=m;a.validateFields=e;a.getExpressionFromFieldName=u;a.getAliasFromFieldName=function(a){return a.split(" as ")[1]};a.hasInvalidFieldType=function(a,b){var e=!1;-1!==m(a).getFields().indexOf(a)&&(a=b.get(a),e=!w.has(a.type));return e}})},"esri/core/sql/WhereClause":function(){define("require exports @dojo/framework/shim/array @dojo/framework/shim/Map ../../moment ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),
function(v,a,p,k,b,h,m,e){function u(a){return Array.isArray(a)?a:[a]}function w(a){return null!==a?!0!==a:null}function y(a,b){if(null==a)return null;for(var c=!1,e=0;e<b.length;e++){var h=b[e];if(null==h)c=null;else if(a===h){c=!0;break}}return c}function n(a,b,e){if(null==a)return null;for(var c="",g=0,h=0;h<b.length;h++){var l=b.charAt(h);switch(g){case 0:l===e?g=1:c=0<="-[]/{}()*+?.\\^$|".indexOf(l)?c+("\\"+l):"%"===l?c+".*":"_"===l?c+".":c+l;break;case 1:c=0<="-[]/{}()*+?.\\^$|".indexOf(l)?
c+("\\"+l):c+l,g=0}}return(new RegExp("^"+c+"$")).test(a)}function G(a){return a instanceof Date?a.valueOf():a}function l(a,b,e){if(null==b||null==e)return null;b=G(b);e=G(e);switch(a){case "\x3c\x3e":return b!==e;case "\x3d":return b===e;case "\x3e":return b>e;case "\x3c":return b<e;case "\x3e\x3d":return b>=e;case "\x3c\x3d":return b<=e}}function E(a){for(var b=[],e={},h=0;h<a.length;h++){var l=a[h],k=l.toLowerCase();void 0===e[k]&&(b.push(l),e[k]=1)}return b}return function(){function a(){this._hasAggregateFunctions=
this._hasStandardizedFunctions=this.parameters=this.parseTree=null}a.create=function(b){var c=new a;c.parseTree=e.WhereGrammar.parse(b);var l=!0,k=!0;c.visitAll(c.parseTree,function(a){if("function"===a.type){var b=a.name;a=a.args.value.length;l&&(l=m.isStandardized(b,a));k&&(k=h.isAggregate(b,a))}});c._hasStandardizedFunctions=l;c._hasAggregateFunctions=k;return c};a.prototype.isStandardized=function(){return this._hasStandardizedFunctions};a.prototype.isAggregate=function(){return this._hasAggregateFunctions};
a.prototype.setVariablesDictionary=function(a){this.parameters=a};a.prototype.testFeature=function(a){return!!this.evaluateNode(this.parseTree,a)};a.prototype.testSet=function(a){var b=this,e=new k.default;this.visitAll(this.parseTree,function(a){"column_ref"!==a.type||e.has(a.column)||e.set(a.column,a)});for(var c={},h=function(a){e.forEach(function(e,h){e=b.featureValue(a,h,e);c[h]?c[h].push(e):c[h]=[e]})},l=0;l<a.length;l++)h(a[l]);return!!this.evaluateNode(this.parseTree,{attributes:c})};a.prototype.calculateValue=
function(a){return this.evaluateNode(this.parseTree,a)};a.prototype.getFunctions=function(){var a=[];this.visitAll(this.parseTree,function(b){"function"===b.type&&a.push(b.name.toLowerCase())});return E(a)};a.prototype.getExpressions=function(){var a=new k.default;this.visitAll(this.parseTree,function(b){if("function"===b.type){var e=b.name.toLowerCase();b=b.args.value[0];if("column_ref"===b.type){b=b.column;var c=e+"-"+b;a.has(c)||a.set(c,{aggregateType:e,field:b})}}});return p.from(a.values())};
a.prototype.getFields=function(){var a=[];this.visitAll(this.parseTree,function(b){"column_ref"===b.type&&a.push(b.column)});return E(a)};a.prototype.getVariables=function(){var a=[];this.visitAll(this.parseTree,function(b){"param"===b.type&&a.push(b.value.toLowerCase())});return E(a)};a.prototype.featureValue=function(a,b,e){a=a&&"object"===typeof a.attributes?a.attributes:a;var c=a[b];if(void 0!==c)return c;for(var h in a)if(b.toLowerCase()===h.toLowerCase())return e.column=h,a[h];return null};
a.prototype.visitAll=function(a,b){if(null!=a)switch(b(a),a.type){case "when_clause":this.visitAll(a.operand,b);this.visitAll(a.value,b);break;case "case_expression":for(var e=0,c=a.clauses;e<c.length;e++){var h=c[e];this.visitAll(h,b)}"simple"===a.format&&this.visitAll(a.operand,b);null!==a.else&&this.visitAll(a.else,b);break;case "expr_list":e=0;for(a=a.value;e<a.length;e++)h=a[e],this.visitAll(h,b);break;case "unary_expr":this.visitAll(a.expr,b);break;case "binary_expr":this.visitAll(a.left,b);
this.visitAll(a.right,b);break;case "function":this.visitAll(a.args,b)}};a.prototype.evaluateNode=function(a,e){switch(a.type){case "case_expression":if("simple"===a.format)for(var c=G(this.evaluateNode(a.operand,e)),g=0;g<a.clauses.length;g++){if(c===G(this.evaluateNode(a.clauses[g].operand,e)))return this.evaluateNode(a.clauses[g].value,e)}else for(g=0;g<a.clauses.length;g++)if(!0===this.evaluateNode(a.clauses[g].operand,e))return this.evaluateNode(a.clauses[g].value,e);return null!==a.else?this.evaluateNode(a.else,
e):null;case "param":return this.parameters[a.value.toLowerCase()];case "expr_list":c=[];g=0;for(a=a.value;g<a.length;g++){var k=a[g];c.push(this.evaluateNode(k,e))}return c;case "unary_expr":return w(this.evaluateNode(a.expr,e));case "binary_expr":switch(a.operator){case "AND":return c=this.evaluateNode(a.left,e),e=this.evaluateNode(a.right,e),null!=c&&null!=e?!0===c&&!0===e:!1===c||!1===e?!1:null;case "OR":return c=this.evaluateNode(a.left,e),e=this.evaluateNode(a.right,e),null!=c&&null!=e?!0===
c||!0===e:!0===c||!0===e?!0:null;case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(a.left,e);case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null!==this.evaluateNode(a.left,e);case "IN":return c=u(this.evaluateNode(a.right,e)),y(this.evaluateNode(a.left,e),c);case "NOT IN":return c=u(this.evaluateNode(a.right,e)),w(y(this.evaluateNode(a.left,e),c));case "BETWEEN":return c=this.evaluateNode(a.left,e),e=this.evaluateNode(a.right,
e),null==c||null==e[0]||null==e[1]?null:c>=e[0]&&c<=e[1];case "NOTBETWEEN":return c=this.evaluateNode(a.left,e),e=this.evaluateNode(a.right,e),null==c||null==e[0]||null==e[1]?null:c<e[0]||c>e[1];case "LIKE":return n(this.evaluateNode(a.left,e),this.evaluateNode(a.right,e),a.escape);case "NOT LIKE":return w(n(this.evaluateNode(a.left,e),this.evaluateNode(a.right,e),a.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return l(a.operator,this.evaluateNode(a.left,
e),this.evaluateNode(a.right,e));case "*":return this.evaluateNode(a.left,e)*this.evaluateNode(a.right,e);case "-":return this.evaluateNode(a.left,e)-this.evaluateNode(a.right,e);case "+":return this.evaluateNode(a.left,e)+this.evaluateNode(a.right,e);case "/":return this.evaluateNode(a.left,e)/this.evaluateNode(a.right,e)}throw Error("Not Supported Operator "+a.operator);case "null":case "bool":case "string":case "number":return a.value;case "date":return b(a.value,["YYYY-M-D"]).toDate();case "timestamp":return b(a.value,
["YYYY-M-D H:m:s","YYYY-M-D H:mZ","YYYY-M-D H:m:sZ","YYYY-M-D H:m","YYYY-m-d"]).toDate();case "column_ref":return"CURRENT_DATE"===a.column.toUpperCase()?(k=new Date,k.setHours(0,0,0,0),k):"CURRENT_TIMESTAMP"===a.column.toUpperCase()?new Date:this.featureValue(e,a.column,a);case "function":return e=this.evaluateNode(a.args,e),this.isAggregate()?h.aggregateFunction(a.name,e):m.evaluateFunction(a.name,e)}throw Error("Unsupported sql syntax "+a.type);};return a}()})},"esri/core/sql/AggregateFunctions":function(){define(["require",
"exports"],function(v,a){function p(a){for(var b=0,e=0;e<a.length;e++)b+=a[e];return b/a.length}function k(a){for(var b=p(a),e=a.length,h=0,k=0;k<a.length;k++)h+=Math.pow(a[k]-b,2);return 1<e?h/(e-1):0}Object.defineProperty(a,"__esModule",{value:!0});a.aggregateFunction=function(a,k){var e=b[a.toLowerCase()];if(null==e)throw Error("Function Not Recognised");if(k.length<e.minParams||k.length>e.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return e.evaluate(k)};a.isAggregate=
function(a,k){a=b[a.toLowerCase()];return null!=a&&k>=a.minParams&&k<=a.maxParams};var b={min:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.min.apply(Math,a[0])}},max:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.max.apply(Math,a[0])}},avg:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:p(a[0])}},sum:{minParams:1,maxParams:1,evaluate:function(a){if(null==a[0])a=null;else{a=a[0];for(var b=0,e=0;e<a.length;e++)b+=a[e];a=b}return a}},
stddev:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sqrt(k(a[0]))}},count:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].length}},var:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:k(a[0])}}}})},"esri/core/sql/StandardizedFunctions":function(){define(["require","exports","dojo/regexp"],function(v,a,p){Object.defineProperty(a,"__esModule",{value:!0});a.evaluateFunction=function(a,h){var b=k[a.toLowerCase()];if(null==b)throw Error("Function Not Recognised");
if(h.length<b.minParams||h.length>b.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return b.evaluate(h)};a.isStandardized=function(a,h){a=k[a.toLowerCase()];return null!=a&&h>=a.minParams&&h<=a.maxParams};var k={extract:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];if(null==a)return null;if(a instanceof Date)switch(b.toUpperCase()){case "SECOND":return a.getSeconds();case "MINUTE":return a.getMinutes();case "HOUR":return a.getHours();case "DAY":return a.getDate();
case "MONTH":return a.getMonth()+1;case "YEAR":return a.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:function(a){if(2===a.length){var b=a[0],k=a[1];return null==b||null==k?null:b.toString().substring(k-1)}if(3===a.length)return b=a[0],k=a[1],a=a[2],null==b||null==k||null==a?null:0>=a?"":b.toString().substring(k-1,k+a-1)}},position:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];return null==b||null==a?null:a.indexOf(b)+
1}},trim:{minParams:2,maxParams:3,evaluate:function(a){var b=3===a.length,k=b?a[1]:" ",b=b?a[2]:a[1];if(null==k||null==b)return null;k="("+p.escapeString(k)+")";switch(a[0]){case "BOTH":return b.replace(new RegExp("^"+k+"*|"+k+"*$","g"),"");case "LEADING":return b.replace(new RegExp("^"+k+"*","g"),"");case "TRAILING":return b.replace(new RegExp(k+"*$","g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.abs(a[0])}},
ceiling:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.ceil(a[0])}},floor:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.floor(a[0])}},log:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])}},log10:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sin(a[0])}},cos:{minParams:1,maxParams:1,
evaluate:function(a){return null==a[0]?null:Math.cos(a[0])}},tan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.tan(a[0])}},asin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.asin(a[0])}},acos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.acos(a[0])}},atan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.atan(a[0])}},sign:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:
0<a[0]?1:0>a[1]?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:Math.pow(a[0],a[1])}},mod:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:a[0]%a[1]}},round:{minParams:1,maxParams:2,evaluate:function(a){var b=a[0];a=2===a.length?Math.pow(10,a[1]):1;return null==b?null:Math.round(b*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:function(a){return null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))}},
char_length:{minParams:1,maxParams:1,evaluate:function(a){return"string"===typeof a[0]||a[0]instanceof String?a[0].length:0}},concat:{minParams:1,maxParams:Infinity,evaluate:function(a){for(var b="",k=0;k<a.length;k++){if(null==a[k])return null;b+=a[k].toString()}return b}},lower:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toUpperCase()}}}})},"esri/core/sql/WhereGrammar":function(){define(["require",
"exports","./sql92grammar"],function(v,a,p){Object.defineProperty(a,"__esModule",{value:!0});v=function(){function a(){}a.parse=function(a){return p.parse(a)};return a}();a.WhereGrammar=v})},"esri/core/sql/sql92grammar":function(){define([],function(){function v(a,p,k,b){this.message=a;this.expected=p;this.found=k;this.location=b;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,v)}(function(a,p){function k(){this.constructor=a}k.prototype=p.prototype;
a.prototype=new k})(v,Error);v.buildMessage=function(a,p){function k(a){return a.charCodeAt(0).toString(16).toUpperCase()}function b(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+k(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+k(a)})}function h(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,
"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+k(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+k(a)})}var m={literal:function(a){return'"'+b(a.text)+'"'},"class":function(a){var b="",e;for(e=0;e<a.parts.length;e++)b+=a.parts[e]instanceof Array?h(a.parts[e][0])+"-"+h(a.parts[e][1]):h(a.parts[e]);return"["+(a.inverted?"^":"")+b+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};
return"Expected "+function(a){var b=Array(a.length),e;for(e=0;e<a.length;e++){var h=e,k;k=a[e];k=m[k.type](k);b[h]=k}b.sort();if(0<b.length){for(a=e=1;e<b.length;e++)b[e-1]!==b[e]&&(b[a]=b[e],a++);b.length=a}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}(a)+" but "+(p?'"'+b(p)+'"':"end of input")+" found."};return{SyntaxError:v,parse:function(a,p){function k(a,d){return{type:"literal",text:a,ignoreCase:d}}function b(a,
d,b){return{type:"class",parts:a,inverted:d,ignoreCase:b}}function h(d){var b=ea[d],f;if(!b){for(f=d-1;!ea[f];)f--;b=ea[f];for(b={line:b.line,column:b.column};f<d;)10===a.charCodeAt(f)?(b.line++,b.column=1):b.column++,f++;ea[d]=b}return b}function m(a,d){var b=h(a),f=h(d);return{start:{offset:a,line:b.line,column:b.column},end:{offset:d,line:f.line,column:f.column}}}function e(a){f<R||(f>R&&(R=f,Fa=[]),Fa.push(a))}function u(){var a,b,e;a=f;b=x();b!==d?(b=y(),b!==d?(e=x(),e!==d?a=b:(f=a,a=d)):(f=
a,a=d)):(f=a,a=d);return a}function w(){var a,b,e,c,h,l,g,k;a=f;b=y();if(b!==d){e=[];c=f;h=x();h!==d?(l=Ta(),l!==d?(g=x(),g!==d?(k=y(),k!==d?c=h=[h,l,g,k]:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d);for(;c!==d;)e.push(c),c=f,h=x(),h!==d?(l=Ta(),l!==d?(g=x(),g!==d?(k=y(),k!==d?c=h=[h,l,g,k]:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d);if(e!==d){a={type:"expr_list"};b=[b];for(c=0;c<e.length;c++)b.push(e[c][3]);a.value=b}else f=a,a=d}else f=a,a=d;return a}function y(){var a,b,e,c,h,l,g,k;a=f;b=n();if(b!==
d){e=[];c=f;h=x();h!==d?(l=Ra(),l!==d?(g=x(),g!==d?(k=n(),k!==d?c=h=[h,l,g,k]:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d);for(;c!==d;)e.push(c),c=f,h=x(),h!==d?(l=Ra(),l!==d?(g=x(),g!==d?(k=n(),k!==d?c=h=[h,l,g,k]:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d);e!==d?a=b=ba(b,e):(f=a,a=d)}else f=a,a=d;return a}function n(){var a,b,e,c,h,l,g,k;a=f;b=G();if(b!==d){e=[];c=f;h=x();h!==d?(l=oa(),l!==d?(g=x(),g!==d?(k=G(),k!==d?c=h=[h,l,g,k]:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d);for(;c!==d;)e.push(c),c=
f,h=x(),h!==d?(l=oa(),l!==d?(g=x(),g!==d?(k=G(),k!==d?c=h=[h,l,g,k]:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d);e!==d?a=b=ba(b,e):(f=a,a=d)}else f=a,a=d;return a}function G(){var b,h,g,k,q;b=f;h=ka();h===d&&(h=f,33===a.charCodeAt(f)?(g=dd,f++):(g=d,0===t&&e(ed)),g!==d?(k=f,t++,61===a.charCodeAt(f)?(q=Ua,f++):(q=d,0===t&&e(Va)),t--,q===d?k=void 0:(f=k,k=d),k!==d?h=g=[g,k]:(f=h,h=d)):(f=h,h=d));h!==d?(g=x(),g!==d?(k=G(),k!==d?b=h={type:"unary_expr",operator:"NOT",expr:k}:(f=b,b=d)):(f=b,b=d)):(f=b,b=
d);if(b===d)if(b=f,h=c(),h!==d)if(g=x(),g!==d){var m,u,O;g=[];k=f;q=x();q!==d?(m=l(),m!==d?(u=x(),u!==d?(O=c(),O!==d?k=q=[q,m,u,O]:(f=k,k=d)):(f=k,k=d)):(f=k,k=d)):(f=k,k=d);if(k!==d)for(;k!==d;)g.push(k),k=f,q=x(),q!==d?(m=l(),m!==d?(u=x(),u!==d?(O=c(),O!==d?k=q=[q,m,u,O]:(f=k,k=d)):(f=k,k=d)):(f=k,k=d)):(f=k,k=d);else g=d;g!==d&&(g={type:"arithmetic",tail:g});g===d&&(g=f,k=A(),k!==d?(q=x(),q!==d?(q=fa(),q!==d?(q=x(),q!==d?(q=w(),q!==d?(m=x(),m!==d?(m=ga(),m!==d?g=k={op:k,right:q}:(f=g,g=d)):(f=
g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d),g===d&&(g=f,k=A(),k!==d?(q=x(),q!==d?(q=fa(),q!==d?(q=x(),q!==d?(q=ga(),q!==d?g=k={op:k,right:{type:"expr_list",value:[]}}:(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d),g===d&&(g=f,k=A(),k!==d?(q=x(),q!==d?(q=Q(),q!==d?g=k={op:k,right:q}:(f=g,g=d)):(f=g,g=d)):(f=g,g=d))),g===d&&(g=f,q=ka(),q!==d?(k=x(),k!==d?(k=Sa(),k!==d?(m=x(),m!==d?(m=c(),m!==d?(u=x(),u!==d?(u=oa(),u!==d?(q=x(),q!==d?(q=c(),q!==d?g=q={op:"NOT"+k,right:{type:"expr_list",
value:[m,q]}}:(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d),g===d&&(g=f,q=Sa(),q!==d?(k=x(),k!==d?(k=c(),k!==d?(m=x(),m!==d?(m=oa(),m!==d?(u=x(),u!==d?(u=c(),u!==d?g=q={op:q,right:{type:"expr_list",value:[k,u]}}:(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d)),g===d&&(g=f,k=Pa(),k!==d?(q=x(),q!==d?(q=ka(),q!==d?(q=x(),q!==d?(q=c(),q!==d?g=k={op:k+"NOT",right:q}:(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d),g===
d&&(g=f,k=Pa(),k!==d?(q=x(),q!==d?(q=c(),q!==d?g=k={op:k,right:q}:(f=g,g=d)):(f=g,g=d)):(f=g,g=d)),g===d&&(g=f,k=E(),k!==d?(q=x(),q!==d?(q=F(),q!==d?(m=x(),m!==d?(m=f,a.substr(f,6).toLowerCase()===fd?(u=a.substr(f,6),f+=6):(u=d,0===t&&e(gd)),u!==d?(u=f,t++,O=r(),t--,O===d?u=void 0:(f=u,u=d),u!==d?m="ESCAPE":(f=m,m=d)):(f=m,m=d),m!==d?(m=x(),m!==d?(m=U(),m!==d?g=k={op:k,right:q,escape:m.value}:(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d),g===d&&(g=f,k=E(),k!==d?(q=x(),
q!==d?(q=F(),q!==d?g=k={op:k,right:q,escape:""}:(f=g,g=d)):(f=g,g=d)):(f=g,g=d))))));g===d&&(g=null);g!==d?(b=h,h=g,""==h||void 0==h||null==h?h=b:(g=null,h=g="arithmetic"==h.type?ba(b,h.tail):Wa(h.op,b,h.right,h.escape)),b=h):(f=b,b=d)}else f=b,b=d;else f=b,b=d;return b}function l(){var b;a.substr(f,2)===Xa?(b=Xa,f+=2):(b=d,0===t&&e(hd));b===d&&(62===a.charCodeAt(f)?(b=id,f++):(b=d,0===t&&e(jd)),b===d&&(a.substr(f,2)===Ya?(b=Ya,f+=2):(b=d,0===t&&e(kd)),b===d&&(a.substr(f,2)===Za?(b=Za,f+=2):(b=d,
0===t&&e(ld)),b===d&&(60===a.charCodeAt(f)?(b=md,f++):(b=d,0===t&&e(nd)),b===d&&(61===a.charCodeAt(f)?(b=Ua,f++):(b=d,0===t&&e(Va)),b===d&&(a.substr(f,2)===$a?(b=$a,f+=2):(b=d,0===t&&e(od))))))));return b}function E(){var a,b,e,c;a=a=f;b=ka();b!==d?(e=x(),e!==d?(c=Qa(),c!==d?a=b=[b,e,c]:(f=a,a=d)):(f=a,a=d)):(f=a,a=d);a!==d&&(a=a[0]+" "+a[2]);a===d&&(a=Qa());return a}function A(){var a,b,e,c;a=a=f;b=ka();b!==d?(e=x(),e!==d?(c=mc(),c!==d?a=b=[b,e,c]:(f=a,a=d)):(f=a,a=d)):(f=a,a=d);a!==d&&(a=a[0]+" "+
a[2]);a===d&&(a=mc());return a}function c(){var a,b,e,c,h,k,l,q;a=f;b=z();if(b!==d){e=[];c=f;h=x();h!==d?(k=g(),k!==d?(l=x(),l!==d?(q=z(),q!==d?c=h=[h,k,l,q]:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d);for(;c!==d;)e.push(c),c=f,h=x(),h!==d?(k=g(),k!==d?(l=x(),l!==d?(q=z(),q!==d?c=h=[h,k,l,q]:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d);e!==d?a=b=ba(b,e):(f=a,a=d)}else f=a,a=d;return a}function g(){var b;43===a.charCodeAt(f)?(b=ab,f++):(b=d,0===t&&e(bb));b===d&&(45===a.charCodeAt(f)?(b=cb,f++):(b=d,0===
t&&e(db)));return b}function z(){var a,b,e,c,g,h,k,l;a=f;b=J();if(b!==d){e=[];c=f;g=x();g!==d?(h=D(),h!==d?(k=x(),k!==d?(l=J(),l!==d?c=g=[g,h,k,l]:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d);for(;c!==d;)e.push(c),c=f,g=x(),g!==d?(h=D(),h!==d?(k=x(),k!==d?(l=J(),l!==d?c=g=[g,h,k,l]:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d);e!==d?a=b=ba(b,e):(f=a,a=d)}else f=a,a=d;return a}function D(){var b;42===a.charCodeAt(f)?(b=pd,f++):(b=d,0===t&&e(qd));b===d&&(47===a.charCodeAt(f)?(b=rd,f++):(b=d,0===t&&e(sd)));
return b}function J(){var b,c,g,h,k,l,m;m=U();if(m===d){var u,E,A,z;u=f;var n,p,v,D;n=f;p=Ib();p!==d?(v=L(),v!==d?(D=Jb(),D!==d?n=p=parseFloat(p+v+D):(f=n,n=d)):(f=n,n=d)):(f=n,n=d);n===d&&(n=f,p=Ib(),p!==d?(v=L(),v!==d?n=p=parseFloat(p+v):(f=n,n=d)):(f=n,n=d),n===d&&(n=f,p=Ib(),p!==d?(v=Jb(),v!==d?n=p=parseFloat(p+v):(f=n,n=d)):(f=n,n=d),n===d&&(n=f,p=Ib(),p!==d&&(p=parseFloat(p)),n=p)));E=n;E!==d?(A=f,t++,z=ca(),t--,z===d?A=void 0:(f=A,A=d),A!==d?u=E={type:"number",value:E}:(f=u,u=d)):(f=u,u=d);
m=u;if(m===d){var G,J;G=f;var V,ja,R,ka;V=f;a.substr(f,4).toLowerCase()===td?(ja=a.substr(f,4),f+=4):(ja=d,0===t&&e(ud));ja!==d?(R=f,t++,ka=r(),t--,ka===d?R=void 0:(f=R,R=d),R!==d?V=ja=[ja,R]:(f=V,V=d)):(f=V,V=d);J=V;J!==d&&(J={type:"bool",value:!0});G=J;if(G===d){G=f;var pa,ba,Ga,oa;pa=f;a.substr(f,5).toLowerCase()===vd?(ba=a.substr(f,5),f+=5):(ba=d,0===t&&e(wd));ba!==d?(Ga=f,t++,oa=r(),t--,oa===d?Ga=void 0:(f=Ga,Ga=d),Ga!==d?pa=ba=[ba,Ga]:(f=pa,pa=d)):(f=pa,pa=d);J=pa;J!==d&&(J={type:"bool",value:!1});
G=J}m=G;if(m===d){var ea,qa,eb,Ha,Ea;qa=f;a.substr(f,4).toLowerCase()===xd?(eb=a.substr(f,4),f+=4):(eb=d,0===t&&e(yd));eb!==d?(Ha=f,t++,Ea=r(),t--,Ea===d?Ha=void 0:(f=Ha,Ha=d),Ha!==d?qa=eb=[eb,Ha]:(f=qa,qa=d)):(f=qa,qa=d);ea=qa;ea!==d&&(ea={type:"null",value:null});m=ea;if(m===d){var ha,na,Fa,nc;ha=f;var ra,Kb,fb,Pa;ra=f;a.substr(f,4).toLowerCase()===zd?(Kb=a.substr(f,4),f+=4):(Kb=d,0===t&&e(Ad));Kb!==d?(fb=f,t++,Pa=r(),t--,Pa===d?fb=void 0:(f=fb,fb=d),fb!==d?ra=Kb="DATE":(f=ra,ra=d)):(f=ra,ra=d);
na=ra;na!==d?(Fa=x(),Fa!==d?(nc=F(),nc!==d?ha=na={type:"date",value:nc.value}:(f=ha,ha=d)):(f=ha,ha=d)):(f=ha,ha=d);m=ha;if(m===d){var ia,oc,Qa,pc;ia=f;var sa,Lb,gb,Ra;sa=f;a.substr(f,9).toLowerCase()===Bd?(Lb=a.substr(f,9),f+=9):(Lb=d,0===t&&e(Cd));Lb!==d?(gb=f,t++,Ra=r(),t--,Ra===d?gb=void 0:(f=gb,gb=d),gb!==d?sa=Lb="TIMESTAMP":(f=sa,sa=d)):(f=sa,sa=d);oc=sa;oc!==d?(Qa=x(),Qa!==d?(pc=F(),pc!==d?ia=oc={type:"timestamp",value:pc.value}:(f=ia,ia=d)):(f=ia,ia=d)):(f=ia,ia=d);m=ia}}}}}b=m;if(b===d){var M,
qc,Sa,Ta,Ua,rc,Va,Wa,Xa,sc,Ya,Za;M=f;var ta,Mb,hb,$a;ta=f;a.substr(f,7).toLowerCase()===Dd?(Mb=a.substr(f,7),f+=7):(Mb=d,0===t&&e(Ed));Mb!==d?(hb=f,t++,$a=r(),t--,$a===d?hb=void 0:(f=hb,hb=d),hb!==d?ta=Mb="EXTRACT":(f=ta,ta=d)):(f=ta,ta=d);qc=ta;if(qc!==d)if(Sa=x(),Sa!==d)if(Ta=fa(),Ta!==d)if(Ua=x(),Ua!==d){var W,ua,Nb,ib,ab;ua=f;a.substr(f,4).toLowerCase()===Fd?(Nb=a.substr(f,4),f+=4):(Nb=d,0===t&&e(Gd));Nb!==d?(ib=f,t++,ab=r(),t--,ab===d?ib=void 0:(f=ib,ib=d),ib!==d?ua=Nb="YEAR":(f=ua,ua=d)):(f=
ua,ua=d);W=ua;if(W===d){var va,Ob,jb,bb;va=f;a.substr(f,5).toLowerCase()===Hd?(Ob=a.substr(f,5),f+=5):(Ob=d,0===t&&e(Id));Ob!==d?(jb=f,t++,bb=r(),t--,bb===d?jb=void 0:(f=jb,jb=d),jb!==d?va=Ob="MONTH":(f=va,va=d)):(f=va,va=d);W=va;if(W===d){var wa,Pb,kb,cb;wa=f;a.substr(f,3).toLowerCase()===Jd?(Pb=a.substr(f,3),f+=3):(Pb=d,0===t&&e(Kd));Pb!==d?(kb=f,t++,cb=r(),t--,cb===d?kb=void 0:(f=kb,kb=d),kb!==d?wa=Pb="DAY":(f=wa,wa=d)):(f=wa,wa=d);W=wa;if(W===d){var xa,Qb,lb,db;xa=f;a.substr(f,4).toLowerCase()===
Ld?(Qb=a.substr(f,4),f+=4):(Qb=d,0===t&&e(Md));Qb!==d?(lb=f,t++,db=r(),t--,db===d?lb=void 0:(f=lb,lb=d),lb!==d?xa=Qb="HOUR":(f=xa,xa=d)):(f=xa,xa=d);W=xa;if(W===d){var ya,Rb,mb,wb;ya=f;a.substr(f,6).toLowerCase()===Nd?(Rb=a.substr(f,6),f+=6):(Rb=d,0===t&&e(Od));Rb!==d?(mb=f,t++,wb=r(),t--,wb===d?mb=void 0:(f=mb,mb=d),mb!==d?ya=Rb="MINUTE":(f=ya,ya=d)):(f=ya,ya=d);W=ya;if(W===d){var za,Sb,nb,xb;za=f;a.substr(f,6).toLowerCase()===Pd?(Sb=a.substr(f,6),f+=6):(Sb=d,0===t&&e(Qd));Sb!==d?(nb=f,t++,xb=r(),
t--,xb===d?nb=void 0:(f=nb,nb=d),nb!==d?za=Sb="SECOND":(f=za,za=d)):(f=za,za=d);W=za}}}}}rc=W;rc!==d?(Va=x(),Va!==d?(Wa=tc(),Wa!==d?(Xa=x(),Xa!==d?(sc=y(),sc!==d?(Ya=x(),Ya!==d?(Za=ga(),Za!==d?M=qc={type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:rc},sc]}}:(f=M,M=d)):(f=M,M=d)):(f=M,M=d)):(f=M,M=d)):(f=M,M=d)):(f=M,M=d)):(f=M,M=d)}else f=M,M=d;else f=M,M=d;else f=M,M=d;else f=M,M=d;b=M;if(b===d){var K,uc,yb,zb,Ab,Tb,Bb,Cb,Db,Ub,Eb,T,Ia,vc,wc,xc;K=f;var Aa,Vb,ob,Fb;
Aa=f;a.substr(f,9).toLowerCase()===Rd?(Vb=a.substr(f,9),f+=9):(Vb=d,0===t&&e(Sd));Vb!==d?(ob=f,t++,Fb=r(),t--,Fb===d?ob=void 0:(f=ob,ob=d),ob!==d?Aa=Vb="SUBSTRING":(f=Aa,Aa=d)):(f=Aa,Aa=d);uc=Aa;if(uc!==d)if(yb=x(),yb!==d)if(zb=fa(),zb!==d)if(Ab=x(),Ab!==d)if(Tb=y(),Tb!==d)if(Bb=x(),Bb!==d)if(Cb=tc(),Cb!==d)if(Db=x(),Db!==d)if(Ub=y(),Ub!==d)if(Eb=x(),Eb!==d){T=f;var Ba,Wb,pb,Gb;Ba=f;a.substr(f,3).toLowerCase()===Td?(Wb=a.substr(f,3),f+=3):(Wb=d,0===t&&e(Ud));Wb!==d?(pb=f,t++,Gb=r(),t--,Gb===d?pb=
void 0:(f=pb,pb=d),pb!==d?Ba=Wb="FOR":(f=Ba,Ba=d)):(f=Ba,Ba=d);Ia=Ba;Ia!==d?(vc=x(),vc!==d?(wc=y(),wc!==d?(xc=x(),xc!==d?T=Ia=[Ia,vc,wc,xc]:(f=T,T=d)):(f=T,T=d)):(f=T,T=d)):(f=T,T=d);T===d&&(T=null);T!==d?(Ia=ga(),Ia!==d?K=uc={type:"function",name:"substring",args:{type:"expr_list",value:T?[Tb,Ub,T[2]]:[Tb,Ub]}}:(f=K,K=d)):(f=K,K=d)}else f=K,K=d;else f=K,K=d;else f=K,K=d;else f=K,K=d;else f=K,K=d;else f=K,K=d;else f=K,K=d;else f=K,K=d;else f=K,K=d;else f=K,K=d;b=K;if(b===d){var C,Ja,Xb,Yb,Zb,X,$b,
Ka,ac,bc,Ec,yc,Fc,Gc;C=f;Ja=Hc();Ja!==d?(Xb=x(),Xb!==d?(Yb=fa(),Yb!==d?(Zb=x(),Zb!==d?(X=q(),X===d&&(X=null),X!==d?($b=x(),$b!==d?(Ka=y(),Ka!==d?(ac=x(),ac!==d?(bc=tc(),bc!==d?(Ec=x(),Ec!==d?(yc=y(),yc!==d?(Fc=x(),Fc!==d?(Gc=ga(),Gc!==d?C=Ja={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==X?"BOTH":X},Ka,yc]}}:(f=C,C=d)):(f=C,C=d)):(f=C,C=d)):(f=C,C=d)):(f=C,C=d)):(f=C,C=d)):(f=C,C=d)):(f=C,C=d)):(f=C,C=d)):(f=C,C=d)):(f=C,C=d)):(f=C,C=d)):(f=C,C=d);C===d&&(C=
f,Ja=Hc(),Ja!==d?(Xb=x(),Xb!==d?(Yb=fa(),Yb!==d?(Zb=x(),Zb!==d?(X=q(),X===d&&(X=null),X!==d?($b=x(),$b!==d?(Ka=y(),Ka!==d?(ac=x(),ac!==d?(bc=ga(),bc!==d?C=Ja={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==X?"BOTH":X},Ka]}}:(f=C,C=d)):(f=C,C=d)):(f=C,C=d)):(f=C,C=d)):(f=C,C=d)):(f=C,C=d)):(f=C,C=d)):(f=C,C=d)):(f=C,C=d));b=C;if(b===d){var N,zc,Ic,Jc,Kc,Ac,Lc,Mc,Nc,Bc,Oc,Pc;N=f;var Ca,cc,qb,Qc;Ca=f;a.substr(f,8).toLowerCase()===Vd?(cc=a.substr(f,8),f+=8):(cc=d,
0===t&&e(Wd));cc!==d?(qb=f,t++,Qc=r(),t--,Qc===d?qb=void 0:(f=qb,qb=d),qb!==d?Ca=cc="POSITION":(f=Ca,Ca=d)):(f=Ca,Ca=d);zc=Ca;zc!==d?(Ic=x(),Ic!==d?(Jc=fa(),Jc!==d?(Kc=x(),Kc!==d?(Ac=y(),Ac!==d?(Lc=x(),Lc!==d?(Mc=mc(),Mc!==d?(Nc=x(),Nc!==d?(Bc=y(),Bc!==d?(Oc=x(),Oc!==d?(Pc=ga(),Pc!==d?N=zc={type:"function",name:"position",args:{type:"expr_list",value:[Ac,Bc]}}:(f=N,N=d)):(f=N,N=d)):(f=N,N=d)):(f=N,N=d)):(f=N,N=d)):(f=N,N=d)):(f=N,N=d)):(f=N,N=d)):(f=N,N=d)):(f=N,N=d)):(f=N,N=d);b=N;if(b===d){var S,
dc,Rc,Sc,Tc,La,Uc,Vc;S=f;var Y,rb,sb,da;Y=f;Y=rb=B();if(Y===d)if(Y=f,96===a.charCodeAt(f)?(rb=Wc,f++):(rb=d,0===t&&e(Xc)),rb!==d){sb=[];Yc.test(a.charAt(f))?(da=a.charAt(f),f++):(da=d,0===t&&e(Zc));if(da!==d)for(;da!==d;)sb.push(da),Yc.test(a.charAt(f))?(da=a.charAt(f),f++):(da=d,0===t&&e(Zc));else sb=d;sb!==d?(96===a.charCodeAt(f)?(da=Wc,f++):(da=d,0===t&&e(Xc)),da!==d?Y=rb=sb.join(""):(f=Y,Y=d)):(f=Y,Y=d)}else f=Y,Y=d;dc=Y;dc!==d?(Rc=x(),Rc!==d?(Sc=fa(),Sc!==d?(Tc=x(),Tc!==d?(La=w(),La===d&&(La=
null),La!==d?(Uc=x(),Uc!==d?(Vc=ga(),Vc!==d?S=dc={type:"function",name:dc,args:La?La:{type:"expr_list",value:[]}}:(f=S,S=d)):(f=S,S=d)):(f=S,S=d)):(f=S,S=d)):(f=S,S=d)):(f=S,S=d)):(f=S,S=d);b=S;if(b===d){var ec,H,Ma,fc,Na,gc,la,Z,tb,$c,ad;H=f;Ma=hc();if(Ma!==d)if(fc=x(),fc!==d)if(Na=y(),Na!==d)if(gc=x(),gc!==d){la=[];for(Z=Hb();Z!==d;)la.push(Z),Z=Hb();la!==d?(Z=x(),Z!==d?(tb=ic(),tb!==d?H=Ma={type:"case_expression",format:"simple",operand:Na,clauses:la,else:null}:(f=H,H=d)):(f=H,H=d)):(f=H,H=d)}else f=
H,H=d;else f=H,H=d;else f=H,H=d;else f=H,H=d;if(H===d)if(H=f,Ma=hc(),Ma!==d)if(fc=x(),fc!==d)if(Na=y(),Na!==d)if(gc=x(),gc!==d){la=[];for(Z=Hb();Z!==d;)la.push(Z),Z=Hb();la!==d?(Z=x(),Z!==d?(tb=Dc(),tb!==d?($c=x(),$c!==d?(ad=ic(),ad!==d?H=Ma={type:"case_expression",format:"simple",operand:Na,clauses:la,else:tb.value}:(f=H,H=d)):(f=H,H=d)):(f=H,H=d)):(f=H,H=d)):(f=H,H=d)}else f=H,H=d;else f=H,H=d;else f=H,H=d;else f=H,H=d;ec=H;if(ec===d){var I,Oa,jc,ma,aa,ub,bd,cd;I=f;Oa=hc();if(Oa!==d)if(jc=x(),jc!==
d){ma=[];for(aa=O();aa!==d;)ma.push(aa),aa=O();ma!==d?(aa=x(),aa!==d?(ub=ic(),ub!==d?I=Oa={type:"case_expression",format:"searched",clauses:ma,else:null}:(f=I,I=d)):(f=I,I=d)):(f=I,I=d)}else f=I,I=d;else f=I,I=d;if(I===d)if(I=f,Oa=hc(),Oa!==d)if(jc=x(),jc!==d){ma=[];for(aa=O();aa!==d;)ma.push(aa),aa=O();ma!==d?(aa=x(),aa!==d?(ub=Dc(),ub!==d?(bd=x(),bd!==d?(cd=ic(),cd!==d?I=Oa={type:"case_expression",format:"searched",clauses:ma,else:ub.value}:(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)}else f=
I,I=d;else f=I,I=d;ec=I}b=ec;if(b===d){var vb,Da,Cc,kc,lc;Da=f;Cc=ca();if(Cc!==d){kc=[];for(lc=P();lc!==d;)kc.push(lc),lc=P();kc!==d?Da=Cc+=kc.join(""):(f=Da,Da=d)}else f=Da,Da=d;vb=Da;vb!==d&&(vb={type:"column_ref",table:"",column:vb});b=vb;b===d&&(b=Q(),b===d&&(b=f,c=fa(),c!==d?(g=x(),g!==d?(h=y(),h!==d?(k=x(),k!==d?(l=ga(),l!==d?(h.paren=!0,b=c=h):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)))}}}}}}}return b}function B(){var a,b,e,c;a=f;b=ca();if(b!==d){e=[];for(c=r();c!==d;)e.push(c),
c=r();e!==d?a=b+=e.join(""):(f=a,a=d)}else f=a,a=d;return a}function ca(){var b;Xd.test(a.charAt(f))?(b=a.charAt(f),f++):(b=d,0===t&&e(Yd));return b}function r(){var b;Zd.test(a.charAt(f))?(b=a.charAt(f),f++):(b=d,0===t&&e($d));return b}function P(){var b;ae.test(a.charAt(f))?(b=a.charAt(f),f++):(b=d,0===t&&e(be));return b}function Q(){var b,c,g;b=f;64===a.charCodeAt(f)?(c=ce,f++):(c=d,0===t&&e(de));c!==d?(g=B(),g!==d?b=c=[c,g]:(f=b,b=d)):(f=b,b=d);b!==d&&(b={type:"param",value:b[1]});return b}function q(){var b,
c,g;b=f;a.substr(f,7).toLowerCase()===ee?(c=a.substr(f,7),f+=7):(c=d,0===t&&e(fe));c!==d?(c=f,t++,g=r(),t--,g===d?c=void 0:(f=c,c=d),c!==d?b="LEADING":(f=b,b=d)):(f=b,b=d);b===d&&(b=f,a.substr(f,8).toLowerCase()===ge?(c=a.substr(f,8),f+=8):(c=d,0===t&&e(he)),c!==d?(c=f,t++,g=r(),t--,g===d?c=void 0:(f=c,c=d),c!==d?b="TRAILING":(f=b,b=d)):(f=b,b=d),b===d&&(b=f,a.substr(f,4).toLowerCase()===ie?(c=a.substr(f,4),f+=4):(c=d,0===t&&e(je)),c!==d?(c=f,t++,g=r(),t--,g===d?c=void 0:(f=c,c=d),c!==d?b="BOTH":
(f=b,b=d)):(f=b,b=d)));return b}function F(){var a;a=U();a===d&&(a=Q());return a}function U(){var b,c,g;b=f;39===a.charCodeAt(f)?(c=wb,f++):(c=d,0===t&&e(xb));c===d&&(a.substr(f,2)===yb?(c=yb,f+=2):(c=d,0===t&&e(ke)));if(c!==d){c=[];g=f;a.substr(f,2)===Ea?(g=Ea,f+=2):(g=d,0===t&&e(zb));g!==d&&(g="'");g===d&&(Ab.test(a.charAt(f))?(g=a.charAt(f),f++):(g=d,0===t&&e(Bb)));for(;g!==d;)c.push(g),g=f,a.substr(f,2)===Ea?(g=Ea,f+=2):(g=d,0===t&&e(zb)),g!==d&&(g="'"),g===d&&(Ab.test(a.charAt(f))?(g=a.charAt(f),
f++):(g=d,0===t&&e(Bb)));c!==d?(39===a.charCodeAt(f)?(g=wb,f++):(g=d,0===t&&e(xb)),g!==d?b=c={type:"string",value:c.join("")}:(f=b,b=d)):(f=b,b=d)}else f=b,b=d;return b}function O(){var a,b,e;a=f;b=Cb();b!==d?(b=x(),b!==d?(b=y(),b!==d?(e=x(),e!==d?(e=Db(),e!==d?(e=x(),e!==d?(e=y(),e!==d?a=b={type:"when_clause",operand:b,value:e}:(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d);return a}function Hb(){var a,b,e;a=f;b=Cb();b!==d?(b=x(),b!==d?(b=y(),b!==d?(e=x(),e!==d?(e=Db(),
e!==d?(e=x(),e!==d?(e=y(),e!==d?a=b={type:"when_clause",operand:b,value:e}:(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d);return a}function Dc(){var b,c;b=f;var g,h;c=f;a.substr(f,4).toLowerCase()===le?(g=a.substr(f,4),f+=4):(g=d,0===t&&e(me));g!==d?(g=f,t++,h=r(),t--,h===d?g=void 0:(f=g,g=d),g!==d?c="ELSE":(f=c,c=d)):(f=c,c=d);c!==d?(c=x(),c!==d?(c=y(),c!==d?b={type:"else_clause",value:c}:(f=b,b=d)):(f=b,b=d)):(f=b,b=d);return b}function Ib(){var b,c,g;b=V();b===d&&(b=
f,45===a.charCodeAt(f)?(c=cb,f++):(c=d,0===t&&e(db)),c===d&&(43===a.charCodeAt(f)?(c=ab,f++):(c=d,0===t&&e(bb))),c!==d?(g=V(),g!==d?b=c=c[0]+g:(f=b,b=d)):(f=b,b=d));return b}function L(){var b,c;b=f;46===a.charCodeAt(f)?(c=ne,f++):(c=d,0===t&&e(oe));c!==d?(c=V(),c===d&&(c=null),c!==d?b="."+(null!=c?c:""):(f=b,b=d)):(f=b,b=d);return b}function Jb(){var b,c,g;c=b=f;pe.test(a.charAt(f))?(g=a.charAt(f),f++):(g=d,0===t&&e(qe));g!==d?(re.test(a.charAt(f))?(g=a.charAt(f),f++):(g=d,0===t&&e(se)),g===d&&(g=
null),g!==d?c="e"+(null===g?"":g):(f=c,c=d)):(f=c,c=d);c!==d?(g=V(),g!==d?b=c+g:(f=b,b=d)):(f=b,b=d);return b}function V(){var a,b;a=[];b=ja();if(b!==d)for(;b!==d;)a.push(b),b=ja();else a=d;a!==d&&(a=a.join(""));return a}function ja(){var b;te.test(a.charAt(f))?(b=a.charAt(f),f++):(b=d,0===t&&e(ue));return b}function mc(){var b,c,g;b=f;a.substr(f,2).toLowerCase()===ve?(c=a.substr(f,2),f+=2):(c=d,0===t&&e(we));c!==d?(c=f,t++,g=r(),t--,g===d?c=void 0:(f=c,c=d),c!==d?b="IN":(f=b,b=d)):(f=b,b=d);return b}
function Pa(){var b,c,g;b=f;a.substr(f,2).toLowerCase()===xe?(c=a.substr(f,2),f+=2):(c=d,0===t&&e(ye));c!==d?(c=f,t++,g=r(),t--,g===d?c=void 0:(f=c,c=d),c!==d?b="IS":(f=b,b=d)):(f=b,b=d);return b}function Qa(){var b,c,g;b=f;a.substr(f,4).toLowerCase()===ze?(c=a.substr(f,4),f+=4):(c=d,0===t&&e(Ae));c!==d?(c=f,t++,g=r(),t--,g===d?c=void 0:(f=c,c=d),c!==d?b="LIKE":(f=b,b=d)):(f=b,b=d);return b}function ka(){var b,c,g;b=f;a.substr(f,3).toLowerCase()===Be?(c=a.substr(f,3),f+=3):(c=d,0===t&&e(Ce));c!==
d?(c=f,t++,g=r(),t--,g===d?c=void 0:(f=c,c=d),c!==d?b="NOT":(f=b,b=d)):(f=b,b=d);return b}function oa(){var b,c,g;b=f;a.substr(f,3).toLowerCase()===De?(c=a.substr(f,3),f+=3):(c=d,0===t&&e(Ee));c!==d?(c=f,t++,g=r(),t--,g===d?c=void 0:(f=c,c=d),c!==d?b="AND":(f=b,b=d)):(f=b,b=d);return b}function Ra(){var b,c,g;b=f;a.substr(f,2).toLowerCase()===Fe?(c=a.substr(f,2),f+=2):(c=d,0===t&&e(Ge));c!==d?(c=f,t++,g=r(),t--,g===d?c=void 0:(f=c,c=d),c!==d?b="OR":(f=b,b=d)):(f=b,b=d);return b}function Sa(){var b,
c,g;b=f;a.substr(f,7).toLowerCase()===He?(c=a.substr(f,7),f+=7):(c=d,0===t&&e(Ie));c!==d?(c=f,t++,g=r(),t--,g===d?c=void 0:(f=c,c=d),c!==d?b="BETWEEN":(f=b,b=d)):(f=b,b=d);return b}function tc(){var b,c,g;b=f;a.substr(f,4).toLowerCase()===Je?(c=a.substr(f,4),f+=4):(c=d,0===t&&e(Ke));c!==d?(c=f,t++,g=r(),t--,g===d?c=void 0:(f=c,c=d),c!==d?b="FROM":(f=b,b=d)):(f=b,b=d);return b}function Hc(){var b,c,g;b=f;a.substr(f,4).toLowerCase()===Le?(c=a.substr(f,4),f+=4):(c=d,0===t&&e(Me));c!==d?(c=f,t++,g=r(),
t--,g===d?c=void 0:(f=c,c=d),c!==d?b="TRIM":(f=b,b=d)):(f=b,b=d);return b}function hc(){var b,c,g;b=f;a.substr(f,4).toLowerCase()===Ne?(c=a.substr(f,4),f+=4):(c=d,0===t&&e(Oe));c!==d?(c=f,t++,g=r(),t--,g===d?c=void 0:(f=c,c=d),c!==d?b="CASE":(f=b,b=d)):(f=b,b=d);return b}function ic(){var b,c,g;b=f;a.substr(f,3).toLowerCase()===Pe?(c=a.substr(f,3),f+=3):(c=d,0===t&&e(Qe));c!==d?(c=f,t++,g=r(),t--,g===d?c=void 0:(f=c,c=d),c!==d?b="END":(f=b,b=d)):(f=b,b=d);return b}function Cb(){var b,c,g;b=f;a.substr(f,
4).toLowerCase()===Re?(c=a.substr(f,4),f+=4):(c=d,0===t&&e(Se));c!==d?(c=f,t++,g=r(),t--,g===d?c=void 0:(f=c,c=d),c!==d?b="WHEN":(f=b,b=d)):(f=b,b=d);return b}function Db(){var b,c,g;b=f;a.substr(f,4).toLowerCase()===Te?(c=a.substr(f,4),f+=4):(c=d,0===t&&e(Ue));c!==d?(c=f,t++,g=r(),t--,g===d?c=void 0:(f=c,c=d),c!==d?b="THEN":(f=b,b=d)):(f=b,b=d);return b}function Ta(){var b;44===a.charCodeAt(f)?(b=Ve,f++):(b=d,0===t&&e(We));return b}function fa(){var b;40===a.charCodeAt(f)?(b=Xe,f++):(b=d,0===t&&
e(Ye));return b}function ga(){var b;41===a.charCodeAt(f)?(b=Ze,f++):(b=d,0===t&&e($e));return b}function x(){var a,b;a=[];for(b=Eb();b!==d;)a.push(b),b=Eb();return a}function Eb(){var b;af.test(a.charAt(f))?(b=a.charAt(f),f++):(b=d,0===t&&e(bf));return b}function Wa(a,b,d,c){a={type:"binary_expr",operator:a,left:b,right:d};void 0!==c&&(a.escape=c);return a}function ba(a,b){for(var d=0;d<b.length;d++)a=Wa(b[d][1],a,b[d][3]);return a}p=void 0!==p?p:{};var d={},Fb={start:u},Gb=u,dd="!",ed=k("!",!1),
Ua="\x3d",Va=k("\x3d",!1),Xa="\x3e\x3d",hd=k("\x3e\x3d",!1),id="\x3e",jd=k("\x3e",!1),Ya="\x3c\x3d",kd=k("\x3c\x3d",!1),Za="\x3c\x3e",ld=k("\x3c\x3e",!1),md="\x3c",nd=k("\x3c",!1),$a="!\x3d",od=k("!\x3d",!1),ab="+",bb=k("+",!1),cb="-",db=k("-",!1),pd="*",qd=k("*",!1),rd="/",sd=k("/",!1),Xd=/^[A-Za-z_\x80-\uFFFF]/,Yd=b([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Zd=/^[A-Za-z0-9_]/,$d=b([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),ae=/^[A-Za-z0-9_.\x80-\uFFFF]/,be=b([["A","Z"],["a","z"],["0",
"9"],"_",".",["\u0080","\uffff"]],!1,!1),ce="@",de=k("@",!1),wb="'",xb=k("'",!1),yb="N'",ke=k("N'",!1),Ea="''",zb=k("''",!1),Ab=/^[^']/,Bb=b(["'"],!0,!1),ne=".",oe=k(".",!1),te=/^[0-9]/,ue=b([["0","9"]],!1,!1),pe=/^[eE]/,qe=b(["e","E"],!1,!1),re=/^[+\-]/,se=b(["+","-"],!1,!1),xd="null",yd=k("NULL",!0),td="true",ud=k("TRUE",!0),vd="false",wd=k("FALSE",!0),ve="in",we=k("IN",!0),xe="is",ye=k("IS",!0),ze="like",Ae=k("LIKE",!0),fd="escape",gd=k("ESCAPE",!0),Be="not",Ce=k("NOT",!0),De="and",Ee=k("AND",
!0),Fe="or",Ge=k("OR",!0),He="between",Ie=k("BETWEEN",!0),Je="from",Ke=k("FROM",!0),Td="for",Ud=k("FOR",!0),Rd="substring",Sd=k("SUBSTRING",!0),Dd="extract",Ed=k("EXTRACT",!0),Le="trim",Me=k("TRIM",!0),Vd="position",Wd=k("POSITION",!0),Bd="timestamp",Cd=k("TIMESTAMP",!0),zd="date",Ad=k("DATE",!0),ee="leading",fe=k("LEADING",!0),ge="trailing",he=k("TRAILING",!0),ie="both",je=k("BOTH",!0),Fd="year",Gd=k("YEAR",!0),Hd="month",Id=k("MONTH",!0),Jd="day",Kd=k("DAY",!0),Ld="hour",Md=k("HOUR",!0),Nd="minute",
Od=k("MINUTE",!0),Pd="second",Qd=k("SECOND",!0),Ne="case",Oe=k("CASE",!0),Pe="end",Qe=k("END",!0),Re="when",Se=k("WHEN",!0),Te="then",Ue=k("THEN",!0),le="else",me=k("ELSE",!0),Ve=",",We=k(",",!1),Xe="(",Ye=k("(",!1),Ze=")",$e=k(")",!1),af=/^[ \t\n\r]/,bf=b([" ","\t","\n","\r"],!1,!1),Wc="`",Xc=k("`",!1),Yc=/^[^`]/,Zc=b(["`"],!0,!1),f=0,ea=[{line:1,column:1}],R=0,Fa=[],t=0,na;if("startRule"in p){if(!(p.startRule in Fb))throw Error("Can't start parsing from rule \""+p.startRule+'".');Gb=Fb[p.startRule]}na=
Gb();if(na!==d&&f===a.length)return na;na!==d&&f<a.length&&e({type:"end"});throw function(a,b,d){return new v(v.buildMessage(a,b),a,b,d)}(Fa,R<a.length?a.charAt(R):null,R<a.length?m(R,R+1):m(R,R));}}})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["require","exports"],function(v,a){Object.defineProperty(a,"__esModule",{value:!0});a.queryCapabilities={supportsStatistics:!0,supportsCentroid:!0,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,
supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1}})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports @dojo/framework/shim/Set ../../../core/promiseUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./AttributesBuilder ./attributeSupport ./projectionSupport ./utils".split(" "),
function(v,a,p,k,b,h,m,e,u,w,y){function n(a){return a?JSON.parse(JSON.stringify(a,["latestWkid","wkid","wkt"])):a}Object.defineProperty(a,"__esModule",{value:!0});v=function(){function a(a,b){this.items=a;this.definitionExpression=b.definitionExpression;this.geometryType=b.geometryType;this.hasM=b.hasM;this.hasZ=b.hasZ;this.objectIdField=b.objectIdField;this.spatialReference=b.spatialReference;this.fieldsMap=b.fieldsMap}Object.defineProperty(a.prototype,"size",{get:function(){return this.items.length},
enumerable:!0,configurable:!0});a.prototype.createQueryResponse=function(a){return a.outStatistics?a.outStatistics.some(function(a){return"exceedslimit"===a.statisticType})?this._createExceedsLimitQueryResponse(a):this._createStatisticsQueryResponse(a):this._createFeatureQueryResponse(a)};a.prototype.executeAttributesQuery=function(a){var b=u.getWhereClause(a.where);if(!b)return k.resolve(this);if(b.isStandardized()){for(var e=0,c=[],g=0,h=this.items;g<h.length;g++){var l=h[g];b.testFeature(l.attributes)&&
(c[e++]=l)}b=this._createNew(c);b.definitionExpression=a.where;return k.resolve(b)}return k.reject(new TypeError("Where clause is not standardized"))};a.prototype.executeObjectIdsQuery=function(a){if(!a.objectIds||!a.objectIds.length)return k.resolve(this);var b=new p.default(a.objectIds);return k.resolve(this._createNew(this.items.filter(function(a){return b.has(a.objectId)})))};a.prototype.project=function(b){var e=this;return!b||h.equals(this.spatialReference,b)?k.resolve(this):w.projectMany(this.items.map(function(a){return y.getGeometry(e,
a)}),this.spatialReference,b).then(function(h){for(var c=[],g=0;g<e.items.length;g++)c[g]={attributes:e.items[g].attributes,geometry:h[g]};h=[];m.convertFromFeatures(h,c,e.geometryType,e.hasZ,e.hasM,e.objectIdField);return new a(h,{definitionExpression:e.definitionExpression,geometryType:e.geometryType,hasM:e.hasM,hasZ:e.hasZ,objectIdField:e.objectIdField,spatialReference:b,fieldsMap:e.fieldsMap})})};a.prototype._createFeatureQueryResponse=function(a){var e=this,h=this.items,c=this.geometryType,g=
this.hasM,k=this.hasZ,l=this.objectIdField,m=this.spatialReference,u=a.outFields,w=a.outSpatialReference,r=a.quantizationParameters,p=!1;if(null!=a.num&&null!=a.start)var Q=a.start+a.num,p=h.length>Q,h=h.slice(a.start,Math.min(h.length,Q));return{exceededTransferLimit:p,features:this._createFeatures(a,h),fields:u&&u.map(function(a){return e.fieldsMap.get(a)}),geometryType:c,hasM:g,hasZ:k,objectIdFieldName:l,spatialReference:n(w?w.toJSON():m),transform:r&&b.toTransform(r)}};a.prototype._createFeatures=
function(a,h){var k=new e.default(a,this.fieldsMap),c=a.quantizationParameters,g=a.returnGeometry,l=a.returnCentroid,m=a.maxAllowableOffset,u=a.orderByFields;a=[];var n=0;if(h.length&&u&&u.length){var u=u[0].split(" "),w=u[0],r="DESC"===u[1];h.sort(function(a,b){a=k.getFieldValue(a,w);b=k.getFieldValue(b,w);if("number"===typeof a&&"number"===typeof b)return r?b-a:a-b;if("string"===typeof a&&"string"===typeof b)return a=a.toUpperCase(),b=b.toUpperCase(),(r?a>b:a<b)?-1:(r?a<b:a>b)?1:0})}if(g||l)if(c=
b.toTransform(c),g&&!l)for(l=0;l<h.length;l++)g=h[l],a[n++]={attributes:k.getAttributes(g),geometry:y.getGeometry(this,g,m,c)};else if(!g&&l)for(m=0;m<h.length;m++)g=h[m],a[n++]={attributes:k.getAttributes(g),centroid:y.getCentroid(this,g,c)};else for(l=0;l<h.length;l++)g=h[l],a[n++]={attributes:k.getAttributes(g),centroid:y.getCentroid(this,g,c),geometry:y.getGeometry(this,g,m,c)};else for(m=0;m<h.length;m++)g=h[m],(g=k.getAttributes(g))&&(a[n++]={attributes:g});return a};a.prototype._createNew=
function(b){return new a(b,this)};a.prototype._createExceedsLimitQueryResponse=function(a){var b=!1,e=null;a.outStatistics.some(function(a){e=a;return"exceedslimit"===a.statisticType});var b=null!=e.maxPointCount?e.maxPointCount:Number.POSITIVE_INFINITY,c=null!=e.maxRecordCount?e.maxRecordCount:Number.POSITIVE_INFINITY;a=null!=e.maxVertexCount?e.maxVertexCount:Number.POSITIVE_INFINITY;"esriGeometryPoint"===this.geometryType?b=this.items.length>b:this.items.length>c?b=!0:(b=this.hasZ?this.hasM?4:3:
this.hasM?3:2,b=this.items.reduce(function(a,b){return a+(b.geometry&&b.geometry.coords.length||0)},0)/b>a);return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(b)}}]}};a.prototype._createStatisticsQueryResponse=function(a){var b=new e.default(a,this.fieldsMap),h=[],c=[],g=a.groupByFieldsForStatistics,k=a.having,l=g&&g.length,g=l&&g[0],m={},u={},n={},r={attributes:{}},
w=0;for(a=a.outStatistics;w<a.length;w++){var p=a[w],q=p.onStatisticField,F=p.outStatisticFieldName,U=p.statisticType,O="1"===q;if(l&&(q===g||O)&&"count"===U){m[q]||(m[q]=this._calculateUniqueValues(b,O?g:q));var U=m[q],v;for(v in U){var y=U[v],G=y.count,p=y.data,L=y.items,y=u[p]||{attributes:{}};if(!k||b.validateItems(L,k))y.attributes[F]=G,y.attributes[O?"EXPR_1":q]=p,u[p]=y}c.push({name:F,alias:F,type:"esriFieldTypeString"})}else{if(l)for(v in O=this._calculateUniqueValues(b,g),O){if(y=O[v],p=
y.data,L=y.items,!k||b.validateItems(L,k))y=u[p]||{attributes:{}},L=this._calculateStatistics(L,b,q),G="var"===U?"variance":U,y.attributes[F]=L[G],y.attributes[g]=p,u[p]=y}else n[q]||(n[q]=this._calculateStatistics(this.items,b,q)),L=n[q],G="var"===U?"variance":U,r.attributes[F]=L[G];c.push({name:F,alias:F,type:"esriFieldTypeDouble"})}}if(l)for(var Jb in u)h.push(u[Jb]);else h.push(r);return{fields:c,features:h}};a.prototype._calculateStatistics=function(a,b,e){for(var c=a.length,g=Number.POSITIVE_INFINITY,
h=Number.NEGATIVE_INFINITY,k=null,l=null,m=null,u=null,r=[],n=0;n<c;n++){var p=r[n]=b.getFieldValue(a[n],e);isNaN(p)||(k+=p,g=Math.min(g,p),h=Math.max(h,p))}if(c){l=k/c;for(b=a=0;b<r.length;b++)p=r[b],a+=Math.pow(p-l,2);u=1<c?a/(c-1):0;m=Math.sqrt(u)}else h=g=null;return{avg:l,count:c,max:h,min:g,stddev:m,sum:k,variance:u}};a.prototype._calculateUniqueValues=function(a,b){for(var e={},c=0,g=this.items;c<g.length;c++){var h=g[c],k=a.getFieldValue(h,b);if(null==k||"string"===typeof k&&""===k.trim())k=
null;null==e[k]?e[k]={count:1,data:k,items:[h]}:(e[k].count++,e[k].items.push(h))}return e};return a}();a.default=v})},"esri/geometry/support/quantizationUtils":function(){define(["require","exports","./jsonUtils"],function(v,a,p){function k(a,b){return Math.round((b-a.translate[0])/a.scale[0])}function b(a,b){return Math.round((a.translate[1]-b)/a.scale[1])}function h(a,c,e){for(var g=[],h,l,q,m,F=0;F<e.length;F++){var r=e[F];if(0<F){if(q=k(a,r[0]),m=b(a,r[1]),q!==h||m!==l)g.push(c(r,q-h,m-l)),h=
q,l=m}else h=k(a,r[0]),l=b(a,r[1]),g.push(c(r,h,l))}return 0<g.length?g:null}function m(a,b,c,e){return h(a,c?e?Q:P:e?P:r,b)}function e(a,b,c,e){var g=[];c=c?e?Q:P:e?P:r;for(e=0;e<b.length;e++){var k=h(a,c,b[e]);k&&3<=k.length&&g.push(k)}return g.length?g:null}function u(a,b,c,e){var g=[];c=c?e?Q:P:e?P:r;for(e=0;e<b.length;e++){var k=h(a,c,b[e]);k&&2<=k.length&&g.push(k)}return g.length?g:null}function w(a,b){return b*a.scale[0]+a.translate[0]}function y(a,b){return a.translate[1]-b*a.scale[1]}function n(a,
b,c){var e=Array(c.length);if(!c.length)return e;var g=a.scale,h=g[0],g=g[1],k=w(a,c[0][0]);a=y(a,c[0][1]);e[0]=b(c[0],k,a);for(var l=1;l<c.length;l++){var q=c[l],k=k+q[0]*h;a-=q[1]*g;e[l]=b(q,k,a)}return e}function G(a,b,c){for(var e=Array(c.length),g=0;g<c.length;g++)e[g]=n(a,b,c[g]);return e}function l(a,b,c,e){return n(a,c?e?Q:P:e?P:r,b)}function E(a,b,c,e){return G(a,c?e?Q:P:e?P:r,b)}function A(a,b,c,e){return G(a,c?e?Q:P:e?P:r,b)}function c(a,b,c){var e=c[0],g=e[0],e=e[1],h=Math.min(g,b[0]),
k=Math.min(e,b[1]),l=Math.max(g,b[2]);b=Math.max(e,b[3]);for(var q=1;q<c.length;q++){var m=c[q],r=m[0],m=m[1],g=g+r,e=e+m;0>r&&(h=Math.min(h,g));0<r&&(l=Math.max(l,g));0>m?k=Math.min(k,e):0<m&&(b=Math.max(b,e))}a[0]=h;a[1]=k;a[2]=l;a[3]=b;return a}function g(a,b){if(!b.length)return null;a[0]=a[1]=Number.POSITIVE_INFINITY;a[2]=a[3]=Number.NEGATIVE_INFINITY;for(var e=0;e<b.length;e++)c(a,a,b[e]);return a}function z(a,c,e,g,h){c.xmin=k(a,e.xmin);c.ymin=b(a,e.ymin);c.xmax=k(a,e.xmax);c.ymax=b(a,e.ymax);
c!==e&&(g&&(c.zmin=e.zmin,c.zmax=e.zmax),h&&(c.mmin=e.mmin,c.mmax=e.mmax));return c}function D(a,b,c,e,g){b.points=m(a,c.points,e,g);return b}function J(a,c,e,g,h){c.x=k(a,e.x);c.y=b(a,e.y);c!==e&&(g&&(c.z=e.z),h&&(c.m=e.m));return c}function B(a,b,c,g,h){a=e(a,c.rings,g,h);if(!a)return null;b.rings=a;return b}function ca(a,b,c,e,g){a=u(a,c.paths,e,g);if(!a)return null;b.paths=a;return b}Object.defineProperty(a,"__esModule",{value:!0});var r=function(a,b,c){return[b,c]},P=function(a,b,c){return[b,
c,a[2]]},Q=function(a,b,c){return[b,c,a[2],a[3]]};a.toTransform=function(a){return a?{originPosition:"upperLeft",scale:[a.tolerance,a.tolerance],translate:[a.extent.xmin,a.extent.ymax]}:null};a.equals=function(a,b){if(a===b||null==a&&null==b)return!0;if(null==a||null==b)return!1;var c,e,g,h;a&&"upperLeft"===a.originPosition?(c=a.translate[0],e=a.translate[1],a=a.scale[0]):(c=a.extent.xmin,e=a.extent.ymax,a=a.tolerance);b&&"upperLeft"===b.originPosition?(g=b.translate[0],h=b.translate[1],b=b.scale[0]):
(g=b.extent.xmin,h=b.extent.ymax,b=b.tolerance);return c===g&&e===h&&a===b};a.quantizeX=k;a.quantizeY=b;a.quantizeBounds=function(a,c,e){c[0]=k(a,e[0]);c[3]=b(a,e[1]);c[2]=k(a,e[2]);c[1]=b(a,e[3]);return c};a.quantizePoints=m;a.quantizeRings=e;a.quantizePaths=u;a.hydrateX=w;a.hydrateY=y;a.hydrateCoordsArray=n;a.hydrateCoordsArrayArray=G;a.hydrateBounds=function(a,b,c){return c?(b[0]=w(a,c[0]),b[1]=y(a,c[3]),b[2]=w(a,c[2]),b[3]=y(a,c[1]),b):[w(a,b[0]),y(a,b[3]),w(a,b[2]),y(a,b[1])]};a.hydratePoints=
l;a.hydratePaths=E;a.hydrateRings=A;a.getQuantizedBoundsCoordsArray=c;a.getQuantizedBoundsCoordsArrayArray=g;a.getQuantizedBoundsPoints=function(a){var b=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return c(b,b,a)};a.getQuantizedBoundsPaths=function(a){return g([0,0,0,0],a)};a.getQuantizedBoundsRings=function(a){return g([0,0,0,0],a)};a.quantizeExtent=z;a.quantizeMultipoint=D;a.quantizePoint=J;a.quantizePolygon=B;a.quantizePolyline=ca;a.quantizeGeometry=
function(a,b){return a&&b?p.isPoint(b)?J(a,{},b,!1,!1):p.isPolyline(b)?ca(a,{},b,!1,!1):p.isPolygon(b)?B(a,{},b,!1,!1):p.isMultipoint(b)?D(a,{},b,!1,!1):p.isExtent(b)?z(a,{},b,!1,!1):null:null};a.hydrateExtent=function(a,b,c,e,g){b.xmin=w(a,c.xmin);b.ymin=y(a,c.ymin);b.xmax=w(a,c.xmax);b.ymax=y(a,c.ymax);b!==c&&(e&&(b.zmin=c.zmin,b.zmax=c.zmax),g&&(b.mmin=c.mmin,b.mmax=c.mmax));return b};a.hydrateMultipoint=function(a,b,c,e,g){b.points=l(a,c.points,e,g);return b};a.hydratePoint=function(a,b,c,e,g){b.x=
w(a,c.x);b.y=y(a,c.y);b!==c&&(e&&(b.z=c.z),g&&(b.m=c.m));return b};a.hydratePolygon=function(a,b,c,e,g){b.rings=A(a,c.rings,e,g);return b};a.hydratePolyline=function(a,b,c,e,g){b.paths=E(a,c.paths,e,g);return b}})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["require","exports","@dojo/framework/shim/Map","./attributeSupport"],function(v,a,p,k){Object.defineProperty(a,"__esModule",{value:!0});v=function(){function a(a,b){this._fieldDataCache=new p.default;this._returnDistinctMap=
new p.default;this.returnDistinctValues=a.returnDistinctValues;this.fieldsMap=b;if((a=a.outFields)&&-1===a.indexOf("*")){this.outFields=a;for(var e=b=0;e<a.length;e++){var h=a[e],m=k.getExpressionFromFieldName(h),y=this.fieldsMap.has(m),m=y?null:k.getWhereClause(m),y=y?this.fieldsMap.get(h).name:k.getAliasFromFieldName(h)||"FIELD_EXP_"+b++;this._fieldDataCache.set(h,{alias:y,clause:m})}}}a.prototype.getAttributes=function(a){a=a.attributes;a=this._processAttributesForOutFields(a);return a=this._processAttributesForDistinctValues(a)};
a.prototype.getFieldValue=function(a,b){a=a.attributes;var e=this.fieldsMap.has(b),h=e?this.fieldsMap.get(b).name:b,m=null;this._fieldDataCache.has(h)?m=this._fieldDataCache.get(h).clause:e||(m=k.getWhereClause(b),this._fieldDataCache.set(h,{alias:h,clause:m}));return e?a[h]:m.calculateValue(a)};a.prototype.validateItem=function(a,b){this._fieldDataCache.has(b)||this._fieldDataCache.set(b,{alias:b,clause:k.getWhereClause(b)});return this._fieldDataCache.get(b).clause.testFeature(a.attributes)};a.prototype.validateItems=
function(a,b){var e=this;this._fieldDataCache.has(b)||this._fieldDataCache.set(b,{alias:b,clause:k.getWhereClause(b)});a=a.map(function(a){return e.getAttributes(a)});return this._fieldDataCache.get(b).clause.testSet(a)};a.prototype._processAttributesForOutFields=function(a){var b=this.outFields;if(!a||!b||!b.length)return a;for(var e={},h=0;h<b.length;h++){var k=this._fieldDataCache.get(b[h]),p=k.alias,k=k.clause;e[p]=k?k.calculateValue(a):a[p]}return e};a.prototype._processAttributesForDistinctValues=
function(a){if(!a||!this.returnDistinctValues)return a;var b=this.outFields,e=[];if(b)for(var h=0;h<b.length;h++){var k=this._fieldDataCache.get(b[h]).alias;e.push(a[k])}else for(k in a)e.push(a[k]);b=(b||["*"]).join(",")+"\x3d"+e.join(",");e=this._returnDistinctMap.get(b)||0;this._returnDistinctMap.set(b,++e);return 1<e?null:a};return a}();a.default=v})},"esri/layers/graphics/data/utils":function(){define(["require","exports","../featureConversionUtils","../OptimizedGeometry"],function(v,a,p,k){Object.defineProperty(a,
"__esModule",{value:!0});var b=new k.default,h=new k.default,m={esriGeometryPoint:p.convertToPoint,esriGeometryPolyline:p.convertToPolyline,esriGeometryPolygon:p.convertToPolygon,esriGeometryMultipoint:p.convertToMultipoint};a.getCentroid=function(a,b,m){if("esriGeometryPolygon"!==a.geometryType||!b.centroid&&!b.geometry)return null;b.centroid||(b.centroid=p.getCentroidOptimizedGeometry(new k.default,b.geometry,a.hasZ,a.hasM));return m?(b=p.quantizeOptimizedGeometry(h,b.centroid,a.hasZ,a.hasM,"esriGeometryPoint",
m),p.convertToPoint(b,a.hasZ,a.hasM)):p.convertToPoint(b.centroid,a.hasZ,a.hasM)};a.getGeometry=function(a,k,v,y){return k.geometry?v?(k=p.generalizeOptimizedGeometry(b,k.geometry,a.hasZ,a.hasM,a.geometryType,v),y&&(k=p.quantizeOptimizedGeometry(h,k,a.hasZ,a.hasM,a.geometryType,y)),m[a.geometryType](k,a.hasZ,a.hasM)):y?(k=p.quantizeOptimizedGeometry(h,k.geometry,a.hasZ,a.hasM,a.geometryType,y),m[a.geometryType](k,a.hasZ,a.hasM)):m[a.geometryType](k.geometry,a.hasZ,a.hasM):null}})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/Error ../../../core/promiseUtils ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/spatialReferenceUtils ./projectionSupport".split(" "),
function(v,a,p,k,b,h,m,e){function u(){return k.create(function(a){return v(["../../../geometry/geometryEngine"],a)})}Object.defineProperty(a,"__esModule",{value:!0});var w={intersects:!0,contains:!0,within:!0,crosses:!0,touches:!0,overlaps:!0,"envelope-intersects":!0},y={point:!0,multipoint:!0,polyline:!0,polygon:!0,extent:!0},n={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0};a.importGeometryEngine=u;a.getGeodesicBufferOperator=function(){return u().then(function(a){return a.geodesicBuffer})};
a.getSpatialQueryOperator=function(a,e,m){if("intersects"===a){if("polygon"===e.type&&"esriGeometryPoint"===m)return k.resolve(b.polygonContainsPoint.bind(null,e.toJSON()));if("extent"===e.type)return k.resolve(h.getExtentIntersector(m).bind(null,e))}return u().then(function(b){return b[a].bind(null,e.toJSON())})};a.checkSpatialQuerySupport=function(a,b,h){var l=a.geometry;return l?!0!==w[a.spatialRelationship]?k.reject(new p("feature-store:unsupported-query","Unsupported query spatial relationship",
{query:a})):m.isValid(l.spatialReference)&&m.isValid(h)?!0!==y[l.type]?k.reject(new p("feature-store:unsupported-query","Unsupported query geometry type",{query:a})):!0!==n[b]?k.reject(new p("feature-store:unsupported-query","Unsupported layer geometry type",{query:a})):e.checkProjectionSupport(a.geometry&&a.geometry.spatialReference,a.outSpatialReference):k.resolve():null};a.canQueryWithRBush=function(a){switch(a.type){case "extent":return!0;case "polygon":return a.rings.every(function(a){return 5!==
a.length?!1:a[0][0]===a[1][0]&&a[0][0]===a[4][0]&&a[2][0]===a[3][0]&&a[0][1]===a[3][1]&&a[0][1]===a[4][1]&&a[1][1]===a[2][1]});default:return!1}}})},"*noref":1}});
define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/has ../../../../core/promiseUtils ../../../../geometry/support/jsonUtils ../../featureConversionUtils ../../data/FeatureStore ../../data/projectionSupport ../../data/QueryEngine ../../../support/fieldType ../../../support/fieldUtils ../../../../tasks/support/Query".split(" "),function(v,a,p,k,b,h,m,e,u,w,y,n,G,l,E){function A(a){return e.isPoint(a)?null!=
a.z:!!a.hasZ}function c(a){return e.isPoint(a)?null!=a.m:!!a.hasM}function g(a,b){if(h("csp-restrictions"))return function(){return k({},a)};b="this."+b+" \x3d null;";for(var c in a)b+="this."+c+" \x3d "+JSON.stringify(a[c])+";";var e=new Function(b);return function(){return new e}}Object.defineProperty(a,"__esModule",{value:!0});var z={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,
supportsStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0}},D=function(){return function(){this.description=this.code=null}}(),J=function(){return function(a){this.error=new D;this.objectId=this.globalId=null;this.success=!1;this.uniqueId=null;this.error.description=
a}}(),B=function(){return function(a){this.globalId=null;this.success=!0;this.objectId=this.uniqueId=a}}();v=function(){function a(){this._nextObjectId=this._queryEngine=null;this._fieldsMap=new Map}a.prototype.load=function(a){var c=this,e=[],h=a.features,r=this._inferLayerProperties(h,a.fields),p=a.fields||[],u=null!=a.hasM?a.hasM:r.hasM,v=null!=a.hasZ?a.hasZ:r.hasZ,A=a.spatialReference||r.spatialReference,B=a.geometryType||r.geometryType,L=a.objectIdField||r.objectIdField;if(!A)return m.reject(new b("feature-layer:missing-property",
"spatialReference not set and couldn't be inferred from the provided features"));if(!B)return m.reject(new b("feature-layer:missing-property","geometryType not set and couldn't be inferred from the provided features"));if(!L)return m.reject(new b("feature-layer:missing-property","objectIdField not set and couldn't be found in the provided fields"));r.objectIdField&&L!==r.objectIdField&&(e.push({type:"feature-layer:duplicated-oid-field",message:'Provided objectIdField "'+L+'" doesn\'t match the field name "'+
r.objectIdField+'", found in the provided fields'}),L=r.objectIdField);if(L&&!r.objectIdField){var D=null;p.some(function(a){return a.name===L?(D=a,!0):!1})?(D.type="esriFieldTypeOID",D.editable=!1,D.nullable=!1):p.unshift({alias:L,name:L,type:"esriFieldTypeOID",editable:!1,nullable:!1})}for(r=0;r<p.length;r++){a=p[r];null==a.name&&(a.name=a.alias);null==a.alias&&(a.alias=a.name);if(!a.name)return m.reject(new b("feature-layer:invalid-field-name","field name is missing",{field:a}));a.name===L&&(a.type=
"esriFieldTypeOID");if(-1===G.kebabDict.jsonValues.indexOf(a.type))return m.reject(new b("feature-layer:invalid-field-type",'invalid type for field "'+a.name+'"',{field:a}))}var E={warnings:e,featureErrors:[],layerDefinition:k({},z,{extent:null,geometryType:B,objectIdField:L,fields:p,hasZ:!!v,hasM:!!u}),assignedObjectIds:{}};this._queryEngine=new n.default({fields:p,geometryType:B,hasM:u,hasZ:v,objectIdField:L,spatialReference:A,spatialIndex:new w.default({geometryType:B,hasM:u,hasZ:v})});e={};this._requiredFieldNames=
[];for(u=0;u<p.length;u++)a=p[u],"esriFieldTypeOID"!==a.type&&"esriFieldTypeGlobalID"!==a.type&&(a.editable=null==a.editable?!0:!!a.editable,a.nullable=null==a.nullable?!0:!!a.nullable,v=l.getFieldDefaultValue(a),a.nullable||void 0!==v?e[a.name]=v:this._requiredFieldNames.push(a.name)),this._fieldsMap.set(a.name.trim(),a),this._fieldsMap.set(a.name.trim().toLowerCase(),a);this._createDefaultAttributes=g(e,L);if(h&&h.length)return this._nextObjectId=1+h.reduce(function(a,b){b=b.attributes&&b.attributes[L];
return null==b||isNaN(b)||!isFinite(b)?a:Math.max(a,b)},0),y.checkProjectionSupport(h,A).then(function(){return c._loadInitialFeatures(E,h)});this._nextObjectId=1;return m.resolve(E)};a.prototype.applyEdits=function(a){var b=this,c=this._queryEngine.spatialReference;return y.checkProjectionSupport(a.adds,c).then(function(){return y.checkProjectionSupport(a.updates,c)}).then(function(){return b._applyEdits(a)})};a.prototype.queryFeatures=function(a){return this._queryEngine.executeQuery(E.fromJSON(a))};
a.prototype.queryFeatureCount=function(a){return this._queryEngine.executeQueryForCount(E.fromJSON(a))};a.prototype.queryObjectIds=function(a){return this._queryEngine.executeQueryForIds(E.fromJSON(a))};a.prototype.queryExtent=function(a){return this._queryEngine.executeQueryForExtent(E.fromJSON(a))};a.prototype._inferLayerProperties=function(a,b){for(var g=void 0,h=void 0,k=null,l=null,m=null,r=0;r<a.length;r++){var p=a[r].geometry;if(p&&(k||(k=e.getJsonType(p)),l||(l=p.spatialReference),null==g&&
(g=A(p)),null==h&&(h=c(p)),k&&l&&null!=g&&null!=h))break}if(b&&b.length){var u=null;b.some(function(a){var b="esriFieldTypeOID"===a.type,c=!a.type&&a.name&&"objectid"===a.name.toLowerCase();u=a;return b||c})&&(m=u.name)}return{geometryType:k,spatialReference:l,objectIdField:m,hasM:h,hasZ:g}};a.prototype._loadInitialFeatures=function(a,b){for(var c=this._queryEngine,g=c.geometryType,h=c.hasM,k=c.hasZ,l=c.objectIdField,m=c.spatialReference,c=c.spatialIndex,r=[],p=0;p<b.length;p++){var n=b[p];null!=
n.uid&&(a.assignedObjectIds[n.uid]=-1);if(n.geometry&&g!==e.getJsonType(n.geometry))a.featureErrors.push(new J("Incorrect geometry type."));else{var v=this._createDefaultAttributes(),w=this._mixAttributes(v,n.attributes,!0);w?a.featureErrors.push(w):(this._assignObjectId(v,n.attributes,!0),n.attributes=v,null!=n.uid&&(a.assignedObjectIds[n.uid]=n.attributes[l]),n.geometry&&(n.geometry=y.project(n.geometry,n.geometry.spatialReference,m)),r.push(n))}}c.addMany(u.convertFromFeatures([],r,g,k,h,l));a.layerDefinition.extent=
this._queryEngine.fullExtent;return a};a.prototype._applyEdits=function(a){var b=this._queryEngine.spatialIndex,c=a.adds,e=a.updates;a=a.deletes;var g={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};c&&c.length&&this._applyAddEdits(g,c);e&&e.length&&this._applyUpdateEdits(g,e);if(a&&a.length){for(c=0;c<a.length;c++)g.deleteResults.push(new B(a[c]));b.removeManyById(a)}return{fullExtent:this._queryEngine.fullExtent,featureEditResults:g}};a.prototype._applyAddEdits=function(a,b){for(var c=
a.addResults,g=this._queryEngine,h=g.geometryType,k=g.hasM,l=g.hasZ,m=g.objectIdField,p=g.spatialReference,g=g.spatialIndex,n=[],r=0;r<b.length;r++){var v=b[r];if(v.geometry&&h!==e.getJsonType(v.geometry))c.push(new J("Incorrect geometry type."));else{var w=this._createDefaultAttributes(),z=this._mixAttributes(w,v.attributes);z?c.push(z):(this._assignObjectId(w,v.attributes),v.attributes=w,null!=v.uid&&(a.uidToObjectId[v.uid]=v.attributes[m]),v.geometry&&(v.geometry=y.project(v.geometry,v.geometry.spatialReference,
p)),n.push(v),c.push(new B(v.attributes[m])))}}g.addMany(u.convertFromFeatures([],n,h,l,k,m))};a.prototype._applyUpdateEdits=function(a,b){a=a.updateResults;for(var c=this._queryEngine,g=c.geometryType,h=c.hasM,k=c.hasZ,l=c.objectIdField,m=c.spatialReference,c=c.spatialIndex,p=0;p<b.length;p++){var n=b[p],r=n.attributes,v=n.geometry,n=r&&r[l];if(null==n)a.push(new J("Identifier field "+l+" missing"));else if(c.hasFeature(n)){var w=u.convertToFeature(c.getFeature(n),g,k,h);if(v)if(g!==e.getJsonType(v)){a.push(new J("Incorrect geometry type."));
continue}else w.geometry=y.project(v,v.spatialReference,m);if(r&&(r=this._mixAttributes(w.attributes,r))){a.push(r);continue}c.add(u.convertFromFeature(w,g,k,h,l));a.push(new B(n))}else a.push(new J("Feature with object id "+n+" missing"))}};a.prototype._assignObjectId=function(a,b,c){void 0===c&&(c=!1);var e=this._queryEngine.objectIdField;c?b&&isFinite(b[e])?a[e]=b[e]:a[e]=this._nextObjectId++:a[e]=this._nextObjectId++};a.prototype._mixAttributes=function(a,b,c){void 0===c&&(c=!1);for(var e in b){var g=
l.sanitizeNullFieldValue(b[e]),h=this._fieldsMap.get(e)||this._fieldsMap.get(e.toLowerCase());if(h&&(c||h.editable)){var k=l.validateFieldValue(h,g);if(k)return new J(l.validationErrorToString(k,h,g));a[h.name]=g}}b=0;for(c=this._requiredFieldNames;b<c.length;b++)if(e=c[b],void 0===a[e])return new J('missing required field "'+e+'"');return null};return a}();a.default=v});