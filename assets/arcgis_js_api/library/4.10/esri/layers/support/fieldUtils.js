// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
define(["require","exports","@dojo/framework/shim/Set","../../core/object","./domains"],function(F,b,z,q,h){function r(a,c,b){if(a)for(var d=0;d<a.length;d++){var f=a[d],g=q.getDeepValue(f,c);(g=g&&"function"!==typeof g&&t(g,b))&&q.setDeepValue(f,g.name,c)}}function t(a,c){if("string"!==typeof a)return null;if(null!=c){a=a.toLowerCase();for(var b=0;b<c.length;b++){var e=c[b];if(e&&e.name.toLowerCase()===a)return e}}return null}function u(a){return"number"===typeof a&&!isNaN(a)&&isFinite(a)}function A(a){return null===
a||u(a)}function v(a){return"number"===typeof a&&isFinite(a)&&Math.floor(a)===a}function B(a){return null===a||v(a)}function w(a){return null!=a&&"string"===typeof a}function C(a){return null===a||w(a)}function D(a){return!0}function k(a,c){var b;switch(a.type){case "date":case "integer":case "long":case "small-integer":case "esriFieldTypeDate":case "esriFieldTypeInteger":case "esriFieldTypeLong":case "esriFieldTypeSmallInteger":b=a.nullable?B:v;break;case "double":case "single":case "esriFieldTypeSingle":case "esriFieldTypeDouble":b=
a.nullable?A:u;break;case "string":case "esriFieldTypeString":b=a.nullable?C:w;break;default:b=D}return 1===arguments.length?b:b(c)}function l(a){return null!=a&&E.has(a.type)}function x(a,b){return a.nullable&&null===b?null:l(a)&&!y(a.type,b)?m.OUT_OF_RANGE:k(a,b)?a.domain?h.validateDomainValue(a.domain,b):null:n.INVALID_TYPE}function y(a,b){return(a=p(a))?b>=a.min&&b<=a.max:!1}function p(a){switch(a){case "esriFieldTypeSmallInteger":case "small-integer":return b.smallIntegerRange;case "esriFieldTypeInteger":case "integer":return b.integerRange;
case "esriFieldTypeSingle":case "single":return b.singleRange;case "esriFieldTypeDouble":case "double":return b.doubleRange}}Object.defineProperty(b,"__esModule",{value:!0});b.fixRendererFields=function(a,c){if(null!=a&&null!=c){var d=0;for(a=Array.isArray(a)?a:[a];d<a.length;d++){var e=a[d];r(b.rendererFields,e,c);if("visualVariables"in e&&e.visualVariables)for(var f=0,e=e.visualVariables;f<e.length;f++)r(b.visualVariableFields,e[f],c)}}};b.getField=t;b.getFieldDefaultValue=function(a){var b=a.defaultValue;
if(void 0!==b&&k(a,b))return b;if(a.nullable)return null};b.isValueMatchingFieldType=k;b.rendererFields="field field2 field3 normalizationField rotationInfo.field proportionalSymbolInfo.field proportionalSymbolInfo.normalizationField colorInfo.field colorInfo.normalizationField".split(" ");b.visualVariableFields=["field","normalizationField"];b.numericTypes=["integer","small-integer","single","double"];var E=new z.default(b.numericTypes.concat(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle",
"esriFieldTypeDouble"]));b.isNumericField=l;b.isStringField=function(a){return null!=a&&("string"===a.type||"esriFieldTypeString"===a.type)};b.isDateField=function(a){return null!=a&&("date"===a.type||"esriFieldTypeDate"===a.type)};b.isValidFieldValue=function(a,b){return null===x(a,b)};var m;(m=b.NumericRangeValidationError||(b.NumericRangeValidationError={})).OUT_OF_RANGE="numeric-range-validation-error::out-of-range";var n;(n=b.TypeValidationError||(b.TypeValidationError={})).INVALID_TYPE="type-validation-error::invalid-type";
b.sanitizeNullFieldValue=function(a){return null==a?null:a};b.validateFieldValue=x;b.isNumberInRange=y;b.getFieldRange=function(a){var b=h.getDomainRange(a.domain);if(b)return b;if(l(a))return p(a.type)};b.smallIntegerRange={min:-32768,max:32767};b.integerRange={min:-2147483648,max:2147483647};b.singleRange={min:-3.4E38,max:1.2E38};b.doubleRange={min:-Number.MAX_VALUE,max:Number.MAX_VALUE};b.validationErrorToString=function(a,b,d){switch(a){case h.DomainValidationError.INVALID_CODED_VALUE:return"Value "+
d+" is not in the coded domain - field: "+b.name+", domain: "+JSON.stringify(b.domain);case h.DomainValidationError.VALUE_OUT_OF_RANGE:return"Value "+d+" is out of the range of valid values - field: "+b.name+", domain: "+JSON.stringify(b.domain);case n.INVALID_TYPE:return"Value "+d+" is not a valid value for the field type - field: "+b.name+", type: "+b.type+", nullable: "+b.nullable;case m.OUT_OF_RANGE:return a=p(b.type),"Value "+d+" is out of range for the number type - field: "+b.name+", type: "+
b.type+", value range is "+a.min+" to "+a.max}}});