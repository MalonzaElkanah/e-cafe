// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/assignHelper dojo/dom-construct dojo/i18n!../nls/SymbolStyler dojo/on ../../../core/promiseUtils ../../../core/screenUtils ../../../symbols/support/Symbol3DOutline ../../../symbols/support/symbolLayerUtils".split(" "),function(T,c,R,C,g,D,E,n,S,F){function q(a,b){a[b]||(a[b]={})}function f(a,b){return-1<a.indexOf(b)}function h(a){return a&&"icon"===a.type}function l(a){return a&&"object"===a.type}function t(a){return a&&"extrude"===a.type}function u(a){return a&&
"text"===a.type}function v(a){return k(a,"simple-line","2d")}function p(a){return k(a,"simple-marker","2d")}function w(a){return k(a,"picture-marker","2d")}function d(a){return f(a.type,"3d")}function e(a){return a.symbolLayers.getItemAt(0)}function G(a,b){return k(a,"marker",b)||k(a,"point",b)}function k(a,b,m){b=f(a&&a.type,b);return m?b&&("3d"===m?d(a):!d(a)):b}function H(a,b){return k(a,"line",b)}function I(a,b){return k(a,"fill",b)}function x(a){return d(a)?!1:a&&"string"===typeof a.style&&f(r,
a.style)}function y(a){if(d(a))return a=(a=e(a))&&"fill"===a.type&&a.outline||h(a)&&J(a)?{color:a.outline.color,size:n.pt2px(a.outline.size)}:a&&"line"===a.type||a&&"path"===a.type?{color:a.material&&a.material.color,size:n.pt2px(a.size)}:null,a;a=v(a)?{color:a.color,size:a.width}:k(a,"fill","2d")||p(a)?{color:a.get("outline.color"),size:a.get("outline.width")}:null;return a}function K(a,b){!isNaN(b)&&a&&(d(a)?(a=e(a),h(a)||a&&"fill"===a.type?(q(a,"outline"),a.outline.size=n.px2pt(b)):a&&"line"===
a.type?(q(a,"size"),a.size=n.px2pt(b)):a&&"path"===a.type&&(q(a,"size"),a.size=b)):v(a)?a.width=b:a&&a.outline&&(a.outline.width=b))}function L(a,b){b&&a&&!d(a)&&(b=y(a).color?b:"none",v(a)?a.style=b:a&&a.outline&&(a.outline.style=b))}function M(a,b){if(a&&!isNaN(b))if(d(a))if(a=e(a),h(a)||u(a))a.size=n.px2pt(b);else if(l(a)){var m=a.width,c=a.height,g=a.depth;b/=Math.max(m,c,g);a.set({width:m*b,height:c*b,depth:g*b})}else t(a)&&(a.size=b);else m=a.width,m!==b&&(w(a)?(c=a.url,b=N({dimensions:a,targetDimension:"width",
targetSize:b}),a.height=b.height,a.width=b.width,c&&"http://"!==c&&(f(c,"http://")||f(c,"data:"))&&(a.xoffset||a.yoffset)&&(b=a.width/m,a.xoffset=Math.round(a.xoffset*b),a.yoffset=Math.round(a.yoffset*b))):a.size=b)}function O(a,b){d(a)?z(a,{color:b}):a.color=b}function A(a,b){if(d(a)){var c=e(a);c&&"line"===c.type||c&&"path"===c.type?z(a,{color:b}):(q(c,"outline"),c.outline.color=b)}else y(a).color=b}function N(a){var b=a.dimensions,c=a.targetSize;return"height"===("height"===a.targetDimension?"height":
"width")?{height:c,width:b.width/b.height*c}:{height:b.height/b.width*c,width:c}}function z(a,b){a=e(a);a.material=b.color?R({},a.material,b):void 0}function P(a){return h(a)&&f(r,a.get("resource.primitive"))}function J(a){return h(a)?a.outline&&!a.get("resource.href"):!1}function Q(a,b){return d(a)&&d(b)?(a=e(a),b=e(b),h(a)&&h(b)&&!a.resource.href&&!b.resource.href&&!f(r,a.resource.primitive)&&f(r,b.resource.primitive)):B(a,b)}function B(a,b){return p(a)&&p(b)&&!x(a)&&x(b)}Object.defineProperty(c,
"__esModule",{value:!0});var r=["x","cross"];c.is3d=d;c.getSymbolLayer=e;c.isPoint=G;c.hasExtrudeSymbolLayer=function(a){return d(a)&&t(e(a))};c.hasTextSymbolLayer=function(a){return d(a)&&u(e(a))};c.isLine=H;c.isPolygon=I;c.hasPureOutlineStyle=x;c.getOutline=y;c.setOutlineWidth=K;c.setOutlineStyle=L;c.setSize=M;c.getMarkerLength=function(a){if(d(a)){a=e(a);if(h(a)||u(a))return n.pt2px(a.size);if(l(a))return Math.max(a.width,a.height,a.depth);if(t(a))return a.size}else{if(p(a))return a.size;if(w(a))return Math.max(a.width,
a.height,a.depth)}};c.setFillColor=O;c.getFillColor=function(a){return d(a)?e(a).get("material.color"):a.color};c.setOutlineColor=A;c.preserveAspectRatio=N;c.testImageUrl=function(a){var b,c,d,e=E.create(function(m,e){d=C.create("img");b=D(d,"load",function(){0===d.width&&0===d.height?e("image has both width and height of 0"):m({width:d.width,height:d.height})});c=D(d,"error",function(a){e("error ocurred while loading image")});d.src=a});e.catch(function(){}).then(function(){b.remove();c.remove();
C.destroy(d)});return e};c.updateShape=function(a){d(a.symbol);M(a.symbol,a.size)};c.updateFill=function(a){d(a.symbol);O(a.symbol,a.color)};c.updateOutline=function(a){d(a.symbol)?A(a.symbol,a.color):(A(a.symbol,a.color),L(a.symbol,a.pattern));K(a.symbol,a.size)};c.blendsIntoBackground=function(a){if(d(a))return!1;var b=void 0;return(b=a&&a.outline?a.outline.color:a.color)&&246<b.r&&246<b.g&&246<b.b};c.updateMaterial=z;c.ensureSupportedSimpleFillSymbolStyle=function(a){k(a,"simple-fill","2d")&&"solid"!==
a.style&&"none"!==a.style&&(a.style="solid")};c.getApplicableTabs=function(a,b){void 0===b&&(b=[]);if(d(a)){a=e(a);var c=a.type,g=["icon","object"],k=["icon","object","fill","extrude","text"],l=["icon","fill","line","path"];return{shape:{state:f(b,"shape")||!f(g,c)?"excluded":"enabled"},fill:{state:f(b,"fill")||!f(k,c)?"excluded":P(a)?"disabled":"enabled"},outline:{state:f(b,"outline")||!f(l,c)?"excluded":!h(a)||J(a)||P(a)?"enabled":"disabled"}}}var c=a.type,g=["simple-marker","picture-marker"],k=
["simple-marker","simple-fill"],l=["simple-marker","simple-line","simple-fill"],n=H(a),p=I(a);return{shape:{state:f(b,"shape")||n||p?"excluded":f(g,c)?"enabled":"disabled"},fill:{state:f(b,"fill")||n?"excluded":k[0]===c&&f(["circle","square","diamond"],a.style)||k[1]===c?"enabled":"disabled"},outline:{state:f(b,"outline")?"excluded":f(l,c)?"enabled":"disabled"}}};c.getSizeUnit=function(a){return d(a)&&(a=e(a).type,"extrude"===a||"object"===a)?"meters":"pixels"};c.getOutlineUnit=function(a){return d(a)&&
"path"===e(a).type?"meters":"pixels"};c.getSymbolSource=function(a){return d(a)?G(a)?(a=e(a),l(a)?"web-style:volumetric":h(a)?"web-style:flat":"web-style"):"web-style":"symbol-set"};c.getDimensionality=function(a){a=e(a).type;return"object"===a||"path"===a||"extrude"===a?"volumetric":"flat"};c.ensureProps=function(a){if(d(a)){var b=e(a);if(h(b)&&(b.outline||(b.outline=new S.Symbol3DOutline({color:void 0,size:0})),void 0===b.size))return F.computeLayerSize(b).then(function(c){b.size=c[0];return a});
if(l(b)&&void 0===b.width&&void 0===b.height&&void 0===b.depth)return F.computeLayerSize(b).then(function(c){b.set({width:c[0],height:c[1],depth:c[2]});return a})}return E.resolve(a)};c.switchedFromRasterToVectorSymbol=function(a,b){return d(a)&&d(b)?(a=e(a),b=e(b),h(a)&&l(b)&&!!a.resource.href&&!b.resource.href&&!!b.resource.primitive):w(a)&&p(b)};c.switchedToPureOutline=Q;c.switchedFromPureOutline=function(a,b){return d(a)&&d(b)?Q(b,a):B(b,a)};c.switchedSmsStyleToPureOutline=B;c.getSymbolName=function(a){if(!d(a))return"";
var b=e(a);if(!h(b)&&!l(b))return"";if(a.styleOrigin)return a.styleOrigin.name;if(b.get("resource.href")||!b.get("resource.primitive"))return"";a=b.get("resource.primitive");if(h(b))return g[a];if(l(b)){var c=b.depth,f=b.height,b=b.width;return{sphere:g.sphere,cylinder:g.cylinder,"tall-cylinder":g.tallCylinder,cube:g.cube,"tall-cube":g.tallCube,cone:g.cone,"tall-cone":g.tallCone,"inverted-cone":g.invertedCone,diamond:g.diamond,tetrahedron:g.tetrahedron}[b&&c&&f&&b===c&&b<f?"tall-"+a:a]}}});