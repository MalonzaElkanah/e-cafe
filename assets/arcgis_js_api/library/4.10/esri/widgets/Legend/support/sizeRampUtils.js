// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
define("require exports ../../../symbols ../../../core/numberUtils ../../../symbols/support/utils ./utils".split(" "),function(N,p,z,q,v,E){function F(a,b){var c=null,e=null;if("simple"===a.type)c=a.symbol;else if("unique-value"===a.type||"class-breaks"===a.type)c=(c=(a=a.classBreakInfos||a.uniqueValueInfos)&&a[0])&&c.symbol,e=1<a.length;if(!c||G(c))return null;c=c.clone();if(b||e)-1<c.type.indexOf("3d")?H(c):(b=c,-1!==b.type.indexOf("line")?b.color=r:(b.color=A,"simple-marker"===b.type&&(b.outline=
{color:r,width:1.5})));return c}function G(a){if(a)return z.isSymbol3D(a)?a.symbolLayers?a.symbolLayers.some(function(a){return a&&"fill"===a.type}):!1:-1!==a.type.indexOf("fill")}function H(a){v.isVolumetricSymbol(a)||("line-3d"===a.type?a.symbolLayers.forEach(function(a){a.material={color:r}}):a.symbolLayers.forEach(function(a){"icon"!==a.type||a.resource&&a.resource.href?a.material={color:I}:(a.material={color:A},a.outline={color:r,size:1.5})}))}function J(a,b,c,e,h){var f=a.getSizeRangeAtScale(b,
e,h),k=f&&K(f);if(f||k){for(var d=k.map(function(a){var c=f.minSize,e=f.maxSize,d=b.minDataValue,h=b.maxDataValue;return a<=c?d:a>=e?h:(a-c)/(e-c)*(h-d)+d}),d=q.round(d),m=1;m<d.length-1;m++){var l=L(a,b,c,d[m],d[m-1],e,h);l&&(d[m]=l[0],k[m]=l[1])}return d}}function K(a){var b=a.minSize;a=(a.maxSize-b)/4;for(var c=[],e=0;5>e;e++)c.push(b+a*e);return c}function L(a,b,c,e,h,f,k){var d,m=w(a,b,c,e,f,k);h=w(a,b,c,h,f,k);var l=q.numDigits(e),t=l.fractional,g=l.integer,u=l=null;0<e&&1>e&&(l=Math.pow(10,
t),e*=l,g=q.numDigits(e).integer);for(t=g-1;0<=t;t--){var n=Math.pow(10,t),g=Math.floor(e/n)*n,n=Math.ceil(e/n)*n;null!=l&&(g/=l,n/=l);d=(g+n)/2;d=q.round([g,d,n],{indexes:[1]});d=d[1];var p=w(a,b,c,g,f,k),B=w(a,b,c,n,f,k),C=w(a,b,c,d,f,k),D=q.percentChange(m,p,h,null),v=q.percentChange(m,B,h,null),r=q.percentChange(m,C,h,null),x=20>=D.previous,y=20>=v.previous;x&&y&&(D.previous<=v.previous?(x=!0,y=!1):(y=!0,x=!1));x?u=[g,p]:y?u=[n,B]:20>=r.previous&&(u=[d,C]);if(u)break}return u}function w(a,b,c,
e,h,f){return a.getSize(e,{sizeInfo:b,scale:h,view:f,shape:-1!==c.type.indexOf("marker-symbol")?c.style:null})}function M(a,b){a=a.clone();if(z.isSymbol3D(a))v.isVolumetricSymbol(a)||a.symbolLayers.forEach(function(a){"fill"!==a.type&&(a.size=b)});else if("esri.symbols.SimpleMarkerSymbol"===a.declaredClass)a.size=b;else if("esri.symbols.PictureMarkerSymbol"===a.declaredClass){var c=a.width,e=a.height;a.height=b;a.width=c/e*b}else"esri.symbols.SimpleLineSymbol"===a.declaredClass?a.width=b:"esri.symbols.TextSymbol"===
a.declaredClass&&a.font&&(a.font.size=b);return a}Object.defineProperty(p,"__esModule",{value:!0});p.REAL_WORLD_MAX_SIZE=30;p.REAL_WORLD_MIN_SIZE=12;var A=[255,255,255],I=[200,200,200],r=[128,128,128];p.getRampStops=function(a,b,c,e,h){var f=b.legendOptions,f=f&&f.customValues,k=F(a,c);c=null!=b.minSize&&null!=b.maxSize;var d=b.stops&&1<b.stops.length,m=!!b.target;if(k&&(f||c||d&&!m)){var l=v.isVolumetricSymbol(k),t=null,g=null,u=null,g=l&&!d?q.round([b.minDataValue,b.maxDataValue]):f||J(a,b,k,e,
h);!g&&d&&(g=b.stops.map(function(a){return a.value}),(t=b.stops.some(function(a){return!!a.label}))&&(u=b.stops.map(function(a){return a.label})));f=!l||g&&2===g.length;if(!g||!f)return null;var n=[p.REAL_WORLD_MIN_SIZE,p.REAL_WORLD_MAX_SIZE],r=v.getSymbolOutlineSize(k);return g.map(function(c,d){var f=l?n[d]:w(a,b,k,c,e,h),m=M(k,f);d=t?u[d]:E.getLabelPrefix(d,g.length-1)+q.format(c);return{value:c,symbol:m,label:d,size:f,outlineSize:r}}).reverse()}}});