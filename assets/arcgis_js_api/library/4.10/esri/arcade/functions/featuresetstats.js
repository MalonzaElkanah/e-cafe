// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
define("require exports dojo/Deferred dojo/promise/all ../languageUtils ../featureset/support/WhereClause ../kernel ./fieldStats".split(" "),function(v,q,h,u,f,r,g,p){function m(c,d,a,b,k,e){if(1===b.length){if(f.isArray(b[0]))return a=new h,a.resolve(p.calculateStat(c,b[0],f.defaultUndefined(b[1],-1))),a.promise;if(f.isImmutableArray(b[0]))return a=new h,a.resolve(p.calculateStat(c,b[0].toArray(),f.defaultUndefined(b[1],-1))),a.promise}else if(2===b.length){if(f.isArray(b[0]))return a=new h,a.resolve(p.calculateStat(c,
b[0],f.defaultUndefined(b[1],-1))),a.promise;if(f.isImmutableArray(b[0]))return a=new h,a.resolve(p.calculateStat(c,b[0].toArray(),f.defaultUndefined(b[1],-1))),a.promise;if(f.isFeatureSet(b[0])){var n=new h;t(r.create(b[1]),e,k).then(g.callback(function(a){b[0]._qStat(c,a,f.defaultUndefined(b[2],1E3),d.progressTracker).then(g.callback(function(b){n.resolve(b)},n),g.errback(n))},n),g.errback(n));return n.promise}}else if(3===b.length&&f.isFeatureSet(b[0])){var l=new h;t(r.create(b[1]),e,k).then(g.callback(function(a){b[0]._qStat(c,
a,f.defaultUndefined(b[2],1E3),d.progressTracker).then(g.callback(function(b){l.resolve(b)},l),g.errback(l))},l),g.errback(l));return l.promise}a=new h;a.resolve(p.calculateStat(c,b,-1));return a.promise}function t(c,d,a){var b=new h;try{var k=c.getVariables();if(0<k.length){for(var e=[],f=0;f<k.length;f++)e.push(d.evaluateIdentifier(a,{name:k[f]}));u(e).then(g.callback(function(a){for(var d={},e=0;e<k.length;e++)d[k[e]]=a[e];c.setVariablesDictionary(d);b.resolve(c)},b),g.errback(b))}else b.resolve(c)}catch(l){b.reject(l)}return b.promise}
Object.defineProperty(q,"__esModule",{value:!0});q.registerFunctions=function(c){"async"===c.mode&&(c.functions.stdev=function(d,a){return c.standardFunctionAsync(d,a,function(b,a,e){return m("stdev",b,a,e,d,c)})},c.functions.variance=function(d,a){return c.standardFunctionAsync(d,a,function(b,a,e){return m("variance",b,a,e,d,c)})},c.functions.average=function(d,a){return c.standardFunctionAsync(d,a,function(b,a,e){return m("mean",b,a,e,d,c)})},c.functions.mean=function(d,a){return c.standardFunctionAsync(d,
a,function(b,a,e){return m("mean",b,a,e,d,c)})},c.functions.sum=function(d,a){return c.standardFunctionAsync(d,a,function(b,a,e){return m("sum",b,a,e,d,c)})},c.functions.min=function(d,a){return c.standardFunctionAsync(d,a,function(b,a,e){return m("min",b,a,e,d,c)})},c.functions.max=function(d,a){return c.standardFunctionAsync(d,a,function(a,f,e){return m("max",a,f,e,d,c)})},c.functions.count=function(d,a){return c.standardFunctionAsync(d,a,function(a,c,e){f.pcCheck(e,1,1);if(f.isFeatureSet(e[0])){var b=
e[0].count();d.progressTracker.then(function(){d.progressTracker.isCanceled()&&!1===b.isFulfilled()&&b.cancel(Error("Operation has been cancelled."))},function(a){d.progressTracker.isCanceled()&&!1===b.isFulfilled()&&b.cancel(Error("Operation has been cancelled."))});return b}if(f.isArray(e[0])||f.isString(e[0]))return e[0].length;if(f.isImmutableArray(e[0]))return e[0].length();throw Error("Invalid Parameters for Count");})})}});