// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/Logger ../../../core/libs/gl-matrix-2/gl-matrix ./projection ../../../views/3d/support/projectionUtils".split(" "),function(A,g,x,d,p,h){function q(b,e,a){void 0===a&&(a=y);if(b)for(d.mat4.identity(l),d.mat4.rotate(l,l,e[3],e),e=0;e<b.length;e+=3){for(var c=0;3>c;c++)k[c]=b[e+c]-a[c];d.vec3.transformMat4(k,k,l);for(c=0;3>c;c++)b[e+c]=k[c]+a[c]}}Object.defineProperty(g,"__esModule",{value:!0});var z=x.getLogger("esri.geometry.support.meshUtils.rotate");g.rotate=
function(b,e,a){if(b.vertexAttributes&&b.vertexAttributes.position&&0!==e[3]){var c=b.spatialReference,f=a&&a.origin||b.extent.center;if(c.isWGS84||c.isWebMercator&&(!a||!1!==a.geographic)){a=b.spatialReference;c=t;h.pointToVector(f,c,h.SphericalECEFSpatialReference)||h.pointToVector(b.extent.center,c,h.SphericalECEFSpatialReference);var f=b.vertexAttributes.position,m=b.vertexAttributes.normal,n=new Float64Array(f.length),g=new Float32Array(m?m.length:0);h.computeLinearTransformation(h.SphericalECEFSpatialReference,
c,l,h.SphericalECEFSpatialReference);d.mat3.fromMat4(u,l);var k=v;d.vec3.transformMat3(v,e,u);k[3]=e[3];p.projectToECEF(f,a,n);m&&p.projectNormalToECEF(m,f,n,a,g);q(n,k,c);p.projectFromECEF(n,f,a);m&&(q(g,k),p.projectNormalFromECEF(g,f,n,a,m))}else a=t,h.pointToVector(f,a,b.spatialReference)||(c=b.extent.center,a[0]=c.x,a[1]=c.y,a[2]=c.z,z.error("Failed to project specified origin (wkid:"+f.spatialReference.wkid+") to mesh spatial reference (wkid:"+b.spatialReference.wkid+"). Using mesh extent.center instead")),
q(b.vertexAttributes.position,e,a),q(b.vertexAttributes.normal,e);b.clearCache()}};g.axisAngleFrom=function(b,e,a){d.vec3.copy(a,b);a[3]=e;return a};g.axisAngleMultiply=function(b,e,a){d.quat.setAxisAngle(r,b,b[3]);d.quat.setAxisAngle(w,e,e[3]);d.quat.multiply(r,w,r);a[3]=d.quat.getAxisAngle(a,r);return a};var k=d.vec3f64.create(),v=d.vec4f64.create(),r=d.quatf64.create(),w=d.quatf64.create(),l=d.mat4f64.create(),u=d.mat3f64.create(),y=d.vec3f64.create(),t=d.vec3f64.create()});