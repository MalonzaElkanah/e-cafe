// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/Logger ../../../core/libs/gl-matrix-2/gl-matrix ./projection ../../../views/3d/support/projectionUtils".split(" "),function(w,r,v,k,l,d){Object.defineProperty(r,"__esModule",{value:!0});var p=v.getLogger("esri.geometry.support.meshUtils.centerAt");r.centerAt=function(b,a,c){if(b.vertexAttributes&&b.vertexAttributes.position){var f=b.spatialReference,e=c&&c.origin||b.extent.center;if(f.isWGS84||f.isWebMercator&&(!c||!1!==c.geographic)){c=b.spatialReference;var f=
t,g=u;if(d.pointToVector(a,g,d.SphericalECEFSpatialReference)){d.pointToVector(e,f,d.SphericalECEFSpatialReference)||d.pointToVector(b.extent.center,f,d.SphericalECEFSpatialReference);e=b.vertexAttributes.position;a=b.vertexAttributes.normal;var m=new Float64Array(e.length),q=new Float32Array(a?a.length:0);l.projectToECEF(e,c,m);a&&l.projectNormalToECEF(a,e,m,c,q);d.computeLinearTransformation(d.SphericalECEFSpatialReference,f,n,d.SphericalECEFSpatialReference);d.computeLinearTransformation(d.SphericalECEFSpatialReference,
g,h,d.SphericalECEFSpatialReference);k.mat4.invert(n,n);k.mat4.multiply(h,h,n);l.transformBufferInPlace(m,h);k.mat4.invert(h,h);k.mat4.transpose(h,h);a&&l.transformBufferInPlace(q,h,!0);l.projectFromECEF(m,e,c);a&&l.projectNormalFromECEF(q,e,m,c,a);b.clearCache()}else p.error("Failed to project centerAt location (wkid:"+a.spatialReference.wkid+") to ECEF")}else if(c=t,f=u,d.pointToVector(a,f,b.spatialReference)){d.pointToVector(e,c,b.spatialReference)||(a=b.extent.center,c[0]=a.x,c[1]=a.y,c[2]=a.z,
p.error("Failed to project specified origin (wkid:"+e.spatialReference.wkid+") to mesh spatial reference (wkid:"+b.spatialReference.wkid+"). Using mesh extent.center instead"));if(e=b.vertexAttributes.position)for(a=0;a<e.length;a+=3)for(g=0;3>g;g++)e[a+g]+=f[g]-c[g];b.clearCache()}else p.error("Failed to project centerAt location (wkid:"+a.spatialReference.wkid+") to mesh spatial reference (wkid:"+b.spatialReference.wkid+")")}};var u=k.vec3f64.create(),t=k.vec3f64.create(),n=k.mat4f64.create(),h=
k.mat4f64.create()});