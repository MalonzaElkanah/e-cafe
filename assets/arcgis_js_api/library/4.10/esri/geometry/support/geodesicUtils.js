// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
define("require exports ../../core/Error ../../core/Logger ../../core/unitUtils ../Point ../Polygon ../Polyline ../SpatialReference".split(" "),function(S,r,C,M,J,N,O,P,Q){function D(a){return a&&A(a)?H[a.wkid]:H[4326]}function F(a,m,d){var e=D(d);d=e.a;var e=e.eSq,f=Math.sqrt(e),b=Math.sin(m[1]*v);m=d*m[0]*v;d=0<e?d*(1-e)*(b/(1-e*b*b)-1/(2*f)*Math.log((1-f*b)/(1+f*b)))*.5:d*b;a[0]=m;a[1]=d;return a}function A(a){return!!(a&&a.wkid&&H[a.wkid])}function K(a,m){if("polyline"!==a.type&&"polygon"!==a.type)throw E.error("invalid geometry: the input geometry is neither polyline nor polygon"),
new C("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");if(!A(a.spatialReference))throw E.error("invalid spatialreference: the input geometry spatialreference is not supported"),new C("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");var d=a.spatialReference,e=D(d).radius/1E4;m<e&&(m=e);for(var e=[],f=0,b="polyline"===a.type?a.paths:a.rings;f<b.length;f++){var c=b[f],h=[];e.push(h);h.push([c[0][0],c[0][1]]);
for(var n=c[0][0]*v,l=c[0][1]*v,g=void 0,k=void 0,w=0;w<c.length-1;w++)if(g=c[w+1][0]*v,k=c[w+1][1]*v,n!==g||l!==k){var k=I(l,n,k,g,d),g=k.azimuth,k=k.geodesicDistance,x=k/m;if(1<x){for(var t=1;t<=x-1;t++){var B=G(l,n,g,t*m,d);h.push([B.x,B.y])}x=G(l,n,g,(k+Math.floor(x-1)*m)/2,d);h.push([x.x,x.y])}l=G(l,n,g,k,d);h.push([l.x,l.y]);n=l.x*v;l=l.y*v}}return"polyline"===a.type?new P({paths:e,spatialReference:d}):new O({rings:e,spatialReference:d})}function G(a,m,d,e,f){var b=D(f),c=b.a,h=b.b,b=b.f,n=
Math.sin(d);d=Math.cos(d);var l=(1-b)*Math.tan(a);a=1/Math.sqrt(1+l*l);for(var g=l*a,k=Math.atan2(l,d),l=a*n,w=l*l,x=1-w,c=x*(c*c-h*h)/(h*h),t=1+c/16384*(4096+c*(-768+c*(320-175*c))),B=c/1024*(256+c*(-128+c*(74-47*c))),c=e/(h*t),L=2*Math.PI,u,p,q,r;1E-12<Math.abs(c-L);)q=Math.cos(2*k+c),u=Math.sin(c),p=Math.cos(c),r=B*u*(q+B/4*(p*(-1+2*q*q)-B/6*q*(-3+4*u*u)*(-3+4*q*q))),L=c,c=e/(h*t)+r;e=g*u-a*p*d;h=b/16*x*(4+b*(4-3*x));return new N((m+(Math.atan2(u*n,a*p-g*u*d)-(1-h)*b*l*(c+h*u*(q+h*p*(-1+2*q*q)))))/
v,Math.atan2(g*p+a*u*d,(1-b)*Math.sqrt(w+e*e))/v,f||R)}function I(a,m,d,e,f){var b=D(f),c=b.a;f=b.b;var h=b.f,n=b.radius,l=e-m,g=Math.atan((1-h)*Math.tan(a)),k=Math.atan((1-h)*Math.tan(d)),b=Math.sin(g),g=Math.cos(g),w=Math.sin(k),k=Math.cos(k),x=1E3,t=l,v,r,u,p,q,A,y,z;do{p=Math.sin(t);q=Math.cos(t);u=Math.sqrt(k*p*k*p+(g*w-b*k*q)*(g*w-b*k*q));if(0===u)return{geodesicDistance:0};q=b*w+g*k*q;A=Math.atan2(u,q);y=g*k*p/u;r=1-y*y;p=q-2*b*w/r;isNaN(p)&&(p=0);z=h/16*r*(4+h*(4-3*r));v=t;t=l+(1-z)*h*y*(A+
z*u*(p+z*q*(-1+2*p*p)))}while(1E-12<Math.abs(t-v)&&0<--x);if(0===x)return f=e-m,{azimuth:Math.atan2(Math.sin(f)*Math.cos(d),Math.cos(a)*Math.sin(d)-Math.sin(a)*Math.cos(d)*Math.cos(f)),geodesicDistance:Math.acos(Math.sin(a)*Math.sin(d)+Math.cos(a)*Math.cos(d)*Math.cos(e-m))*n};a=r*(c*c-f*f)/(f*f);m=a/1024*(256+a*(-128+a*(74-47*a)));return{azimuth:Math.atan2(k*Math.sin(t),g*w-b*k*Math.cos(t)),geodesicDistance:f*(1+a/16384*(4096+a*(-768+a*(320-175*a))))*(A-m*u*(p+m/4*(q*(-1+2*p*p)-m/6*p*(-3+4*u*u)*
(-3+4*p*p)))),reverseAzimuth:Math.atan2(g*Math.sin(t),g*w*Math.cos(t)-b*k)}}Object.defineProperty(r,"__esModule",{value:!0});var E=M.getLogger("esri.geometry.support.geodesicUtils"),v=Math.PI/180,R=new Q({wkid:4326}),H={4326:{a:6378137,b:6356752.31424518,f:1/298.257223563,eSq:.006694379990197414,radius:6371008.771415059},104900:{a:2439700,b:2439700,f:0,eSq:0,radius:2439700},104901:{a:6051E3,b:6051E3,f:0,eSq:0,radius:6051E3},104902:{a:6051800,b:6051800,f:0,eSq:0,radius:6051800},104903:{a:1737400,b:1737400,
f:0,eSq:0,radius:1737400},104904:{a:3393400,b:3375730,f:1/192.04301075,eSq:.01038722,radius:3387510},104905:{a:3396190,b:3376200,f:1/169.89444722,eSq:.01173737,radius:3389526.6666666665},104906:{a:6200,b:6200,f:0,eSq:0,radius:6200},104907:{a:11100,b:11100,f:0,eSq:0,radius:11100},104912:{a:2409300,b:2409300,f:0,eSq:0,radius:2409300},104915:{a:1562090,b:1562090,f:0,eSq:0,radius:1562090},104916:{a:2632345,b:2632345,f:0,eSq:0,radius:2632345},104918:{a:1821460,b:1821460,f:0,eSq:0,radius:1821460},104929:{a:249400,
b:249400,f:0,eSq:0,radius:249400},104943:{a:2575E3,b:2575E3,f:0,eSq:0,radius:2575E3},104971:{a:3396190,b:3396190,f:0,eSq:0,radius:3396190},104972:{a:47E4,b:47E4,f:0,eSq:0,radius:47E4},104973:{a:255E3,b:255E3,f:0,eSq:0,radius:255E3},104974:{a:2439400,b:2439400,f:0,eSq:0,radius:2439400}},y=[0,0],z=[0,0];r.isSupported=A;r.geodesicAreas=function(a,m){if(a.some(function(a){return!A(a.spatialReference)}))throw E.error("invalid spatialreference: the input geometries spatialreference is not supported"),new C("geodesic-areas:invalid-spatial-reference",
"the input geometries spatial reference is not supported");for(var d=[],e=0;e<a.length;e++){var f=a[e],b=f.spatialReference,b=.0015696101447650193*D(b).radius;d.push(K(f,b))}a=[];for(e=0;e<d.length;e++){for(var b=d[e],f=b.rings,b=b.spatialReference,c=0,h=0;h<f.length;h++){var n=f[h];F(y,n[0],b);F(z,n[n.length-1],b);for(var l=z[0]*y[1]-y[0]*z[1],g=0;g<n.length-1;g++)F(y,n[g+1],b),F(z,n[g],b),l+=z[0]*y[1]-y[0]*z[1];c+=l}c=J.convertUnit(c,"square-meters",m);a.push(c/-2)}return a};r.geodesicLengths=function(a,
m){if(!a&&!a)throw E.error("invalid geometry type: the input geometries type is not supported"),new C("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(a.some(function(a){return!A(a.spatialReference)}))throw E.error("invalid spatialreference: the input geometries spatialreference is not supported"),new C("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");for(var d=[],e=0;e<a.length;e++){for(var f=a[e],b=f.spatialReference,
f="polyline"===f.type?f.paths:f.rings,c=0,h=0;h<f.length;h++){for(var n=f[h],l=0,g=1;g<n.length;g++){var k=n[g-1][0]*v,w=n[g][0]*v,r=n[g-1][1]*v,t=n[g][1]*v;if(r!==t||k!==w)k=I(r,k,t,w,b),l+=k.geodesicDistance}c+=l}c=J.convertUnit(c,"meters",m);d.push(c)}return d};r.geodesicDensify=K;r.directGeodeticSolver=G;r.inverseGeodeticSolver=I});