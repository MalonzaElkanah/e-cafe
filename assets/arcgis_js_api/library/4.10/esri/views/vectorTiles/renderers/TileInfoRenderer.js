// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/libs/gl-matrix-2/gl-matrix ../GeometryUtils ../../webgl/BufferObject ../../webgl/Texture ../../webgl/VertexArrayObject".split(" "),function(m,n,h,k,f,l,g){return function(){function e(a){this._initialized=!1;this._color=h.vec4f32.fromValues(1,0,0,1);this._maxWidth=0;this._programOptions={id:!1,pattern:!1};this._programCache=a}e.prototype.dispose=function(){this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=
null);this._tileInfoVertexArrayObject&&(this._tileInfoVertexArrayObject.dispose(),this._tileInfoVertexArrayObject=null)};e.prototype.render=function(a,d){this._initialized||this._initialize(a);var b=this._programCache.getProgram(0,0,this._programOptions);if(b&&(a.bindVAO(this._outlineVertexArrayObject),a.bindProgram(b),b.setUniformMatrix4fv("u_transformMatrix",d.tileTransform.transform),b.setUniform2fv("u_normalized_origin",d.tileTransform.displayCoord),b.setUniform1f("u_coord_range",d.coordRange),
b.setUniform1f("u_depth",0),b.setUniform4fv("u_color",this._color),a.setLineWidth(2),a.drawArrays(3,0,4),a.bindVAO(),b=this._getTexture(a,d))){var c=this._programCache.getProgram(7,0,null);c&&(a.bindVAO(this._tileInfoVertexArrayObject),a.bindProgram(c),a.bindTexture(b,0),c.setUniformMatrix4fv("u_transformMatrix",d.tileTransform.transform),c.setUniform2fv("u_normalized_origin",d.tileTransform.displayCoord),c.setUniform1f("u_depth",0),c.setUniform1f("u_coord_ratio",d.coordRange/512),c.setUniform2f("u_delta",
8,8),c.setUniform2f("u_dimensions",b.descriptor.width,b.descriptor.height),a.drawArrays(5,0,4),a.bindVAO())}};e.prototype._initialize=function(a){if(this._initialized)return!0;var d={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},b=new Int8Array([0,0,1,0,1,1,0,1]),b=f.createVertex(a,35044,b),b=new g(a,this._programCache.getProgramAttributes(0),d,{geometry:b}),c=new Int8Array([0,0,1,0,0,1,1,1]),c=f.createVertex(a,35044,c);a=new g(a,this._programCache.getProgramAttributes(7),
d,{geometry:c});this._outlineVertexArrayObject=b;this._tileInfoVertexArrayObject=a;return this._initialized=!0};e.prototype._getTexture=function(a,d){if(d.texture)return d.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","256"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var b=d.key.id,c=this._canvas.getContext("2d");c.font="24px sans-serif";c.textAlign=
"left";c.textBaseline="middle";var e=c.measureText(b),e=Math.pow(2,Math.ceil(k.log2(e.width+2)));e>this._maxWidth&&(this._maxWidth=e);c.clearRect(0,0,this._maxWidth,32);c.fillStyle=d.key.level>d.refKey.level?"red":"blue";c.fillText(b,0,16);d.texture=new l(a,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728},this._canvas);return d.texture};return e}()});