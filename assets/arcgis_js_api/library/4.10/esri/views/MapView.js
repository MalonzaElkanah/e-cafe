// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/BreakpointsOwner":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper dojo/dom-class ../core/Accessor ../core/ArrayPool ../core/Handles ../core/watchUtils ../core/accessorSupport/decorators ./DOMContainer".split(" "),function(q,g,n,d,h,m,f,b,c,e,r,a){var t={widthBreakpoint:{getValue:function(a){var b=a.viewSize[0];a=a.breakpoints;var d=this.values;return b<=a.xsmall?d.xsmall:b<=a.small?
d.small:b<=a.medium?d.medium:b<=a.large?d.large:d.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",
large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue:function(a){var b=a.viewSize[1];a=a.breakpoints;var d=this.values;return b<=a.xsmall?d.xsmall:b<=a.small?d.small:b<=a.medium?d.medium:
b<=a.large?d.large:d.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",
large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue:function(a){a=a.viewSize;var b=this.values;return a[1]>=a[0]?b.portrait:b.landscape},values:{portrait:"portrait",landscape:"landscape"},
valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},p={xsmall:544,small:768,medium:992,large:1200};return function(a){function l(){var b=null!==a&&a.apply(this,arguments)||this;b._breakpointsHandles=new c;b.breakpoints=p;b.orientation=null;b.widthBreakpoint=null;b.heightBreakpoint=null;return b}n(l,a);l.prototype.initialize=function(){this._breakpointsHandles.add([e.init(this,["breakpoints","size"],this._updateClassNames)])};l.prototype.destroy=
function(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles.destroy(),this._breakpointsHandles=null)};l.prototype._updateClassNames=function(){if(this.container){var a=b.acquire(),d=b.acquire(),l=!1,c,p,e;for(c in t)p=this[c],e=t[c].getValue({viewSize:this.size,breakpoints:this.breakpoints}),p!==e&&(l=!0,this[c]=e,d.push(t[c].valueToClassName[p]),a.push(t[c].valueToClassName[e]));l&&(this._applyClassNameChanges(a,d),b.release(a),b.release(d))}};l.prototype._applyClassNameChanges=
function(a,b){var d=this.container;d&&(m.remove(d,b),m.add(d,a))};l.prototype._removeActiveClassNames=function(){var a=this.container;if(a)for(var b in t)m.remove(a,t[b].valueToClassName[this[b]])};d([r.property({set:function(a){var b=this._get("breakpoints");if(a!==b){b=(b=a)&&b.xsmall<b.small&&b.small<b.medium&&b.medium<b.large;if(!b){var d=JSON.stringify(p,null,2);console.warn("provided breakpoints are not valid, using defaults:"+d)}a=b?a:p;this._set("breakpoints",h({},a))}}})],l.prototype,"breakpoints",
void 0);d([r.property()],l.prototype,"orientation",void 0);d([r.property()],l.prototype,"widthBreakpoint",void 0);d([r.property()],l.prototype,"heightBreakpoint",void 0);return l=d([r.subclass("esri.views.BreakpointsOwner")],l)}(r.declared(f,a))})},"esri/views/DOMContainer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/dom dojo/dom-construct dojo/on ../core/Accessor ../core/domUtils ../core/Evented ../core/Handles ../core/scheduling ../core/watchUtils ../core/accessorSupport/decorators ./overlay/ViewOverlay ../widgets/Popup".split(" "),
function(q,g,n,d,h,m,f,b,c,e,r,a,t,p,u,l){function k(a){a&&(c.orphan(a),a.parentNode&&a.parentNode.removeChild(a))}var w=[0,0];return function(b){function c(){var a=b.call(this)||this;a._domHandles=new r;a._freqInfo={freq:16,time:750};a._overlayRenderTaskHandle=null;a.height=0;a.position=null;a.resizing=!1;a.root=null;a.surface=null;a.suspended=!0;a.ui=null;a.userContent=null;a.width=0;a.watch("cursor",function(b){var c=a.surface;c&&c.setAttribute("data-cursor",b)});a.watch("interacting",function(b){var c=
a.surface;c&&c.setAttribute("data-interacting",b.toString())});return a}n(c,b);c.prototype.initialize=function(){var a=this;this.watch("ui",this._handleUIChange);this._wireUI(this.ui);this._focusHandle=this.on("focus",function(){return a.notifyChange("focused")});this._blurHandle=this.on("blur",function(){return a.notifyChange("focused")})};c.prototype.destroy=function(){this.ui.destroy();this.popup&&!this.popup.destroyed&&this.popup.destroy();this.container=null;this._domHandles.destroy();this._focusHandle&&
(this._focusHandle.remove(),this._focusHandle=null);this._blurHandle&&(this._blurHandle.remove(),this._blurHandle=null)};Object.defineProperty(c.prototype,"container",{set:function(b){var c=this,d=this._get("container");if(d!==b)if(this._domHandles.remove("dom-size"),this._stopMeasuring(),d&&(d.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay.destroy(),this._set("overlay",null),k(this.root),this._set("root",
null),k(this.userContent),this._set("userContent",null)),b){b.classList.add("esri-view");d=document.createElement("div");for(d.className="esri-view-user-storage";b.hasChildNodes();)d.appendChild(b.firstChild);b.appendChild(d);d=document.createElement("div");d.className="esri-view-root";b.insertBefore(d,b.firstChild);this._set("root",d);var l=document.createElement("div");l.className="esri-view-surface";l.setAttribute("role","application");l.tabIndex=0;h.setSelectable(l,!1);d.appendChild(l);this._set("surface",
l);var e=new u;d.appendChild(e.surface);this._set("overlay",e);e.watch("needsRender",function(b){b&&!c._overlayRenderTaskHandle?c._overlayRenderTaskHandle=a.addFrameTask({render:function(){c.overlay.render()}}):c._overlayRenderTaskHandle&&(c._overlayRenderTaskHandle.remove(),c._overlayRenderTaskHandle=null)});this._forceReadyCycle();this._domHandles.add(t.init(this,"size",function(a){var b=a[1];l.classList.toggle("esri-view-surface--inset-outline",a[0]>=document.body.clientWidth||b>=document.body.clientHeight)}),
"dom-size");this._set("container",b);this._startMeasuring()}else this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),this._set("container",null)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"focused",{get:function(){var a=document.activeElement===this.surface;return document.hasFocus()&&a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"popup",{get:function(){return this._get("popup")||new l({view:this})},
set:function(a){var b=this._get("popup");b&&b!==a&&b.destroy();this._set("popup",a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"size",{get:function(){return[this.width,this.height]},enumerable:!0,configurable:!0});c.prototype.blur=function(){this.surface&&this.surface.blur()};c.prototype.focus=function(){this.surface&&this.surface.focus()};c.prototype.pageToContainer=function(a,b,c){var d=this.position;a-=d[0];b-=d[1];c?(c[0]=a,c[1]=b):c=[a,b];return c};c.prototype.containerToPage=
function(a,b,c){var d=this.position;a+=d[0];b+=d[1];c?(c[0]=a,c[1]=b):c=[a,b];return c};c.prototype._handleUIChange=function(a,b){b&&(this._domHandles.remove("ui"),b.destroy());a&&this._wireUI(a);this._set("ui",a)};c.prototype._wireUI=function(a){this._domHandles.remove("ui");a&&(a.view=this,this._domHandles.add([t.init(this,"root",function(b){a.container=b?m.create("div",null,b):null}),t.init(this,"popup",function(b,c){c&&a.remove(c,"popup");b&&(b.view=a.view,a.add(b,{key:"popup",position:"manual"}))})],
"ui"))};c.prototype._stopMeasuring=function(){this._domHandles.remove("measuring");this._get("resizing")&&this._set("resizing",!1)};c.prototype._startMeasuring=function(){var b=this,c=this._freqInfo;c.freq=16;c.time=750;this._domHandles.add([f(window,"resize",function(){c.freq=16;c.time=750}),a.addFrameTask({prepare:function(a){var c=b._measure(),d=b._freqInfo;d.time+=a.deltaTime;c&&(d.freq=16,b._get("resizing")||b._set("resizing",!0));d.time<d.freq||(d.time=0,b._position()||c?d.freq=16:d.freq=Math.min(750,
2*d.freq),!c&&512<=d.freq&&b._get("resizing")&&b._set("resizing",!1))}})],"measuring");this._measure();this._position()};c.prototype._measure=function(){var a=this.container,b=a?a.clientWidth:0,c=a?a.clientHeight:0;if(0===b||0===c||"hidden"===window.getComputedStyle(a).visibility)return this.suspended||this._set("suspended",!0),!1;var a=this.width,d=this.height;if(b===a&&c===d)return this.suspended&&this._set("suspended",!1),!1;this._set("width",b);this._set("height",c);this.suspended&&this._set("suspended",
!1);this.emit("resize",{oldWidth:a,oldHeight:d,width:b,height:c});return!0};c.prototype._position=function(){var a=this.container,b=this.position,c=(a.ownerDocument||window.document).defaultView,a=a.getBoundingClientRect();w[0]=a.left+c.pageXOffset;w[1]=a.top+c.pageYOffset;return b&&w[0]===b[0]&&w[1]===b[1]?!1:(this._set("position",[w[0],w[1]]),!0)};d([p.property({value:null,cast:function(a){return h.byId(a)}})],c.prototype,"container",null);d([p.property({readOnly:!0,dependsOn:["surface"]})],c.prototype,
"focused",null);d([p.property({readOnly:!0})],c.prototype,"height",void 0);d([p.property({type:l})],c.prototype,"popup",null);d([p.property({type:u})],c.prototype,"overlay",void 0);d([p.property({readOnly:!0})],c.prototype,"position",void 0);d([p.property({readOnly:!0})],c.prototype,"resizing",void 0);d([p.property({readOnly:!0})],c.prototype,"root",void 0);d([p.property({value:null,dependsOn:["width","height"],readOnly:!0})],c.prototype,"size",null);d([p.property({readOnly:!0})],c.prototype,"surface",
void 0);d([p.property({readOnly:!0})],c.prototype,"suspended",void 0);d([p.property()],c.prototype,"ui",void 0);d([p.property({readOnly:!0})],c.prototype,"userContent",void 0);d([p.property({readOnly:!0})],c.prototype,"width",void 0);return c=d([p.subclass("esri.views.DOMContainer")],c)}(p.declared(b,e))})},"esri/core/domUtils":function(){define(["require","exports","../widgets/support/widget"],function(q,g,n){function d(d){return n.isWidgetBase(d)?d.domNode:d}Object.defineProperty(g,"__esModule",
{value:!0});g.show=function(h){if(h=d(h))h.style.display="block"};g.getNode=d;g.hide=function(h){if(h=d(h))h.style.display="none"};g.toggle=function(h){if(h=d(h))h.style.display="none"===h.style.display?"block":"none"};g.orphan=function(d){for(;d.hasChildNodes();)d.removeChild(d.firstChild)}})},"esri/views/overlay/ViewOverlay":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper dojo/dom ../../core/Accessor ../../core/Collection ../../core/accessorSupport/decorators maquette".split(" "),
function(q,g,n,d,h,m,f,b,c){return function(e){function r(){var a=null!==e&&e.apply(this,arguments)||this;a.items=new f;a._callbacks=new Map;a._projector=c.createProjector();a._hiddenProjector=c.createProjector();return a}n(r,e);Object.defineProperty(r.prototype,"needsRender",{get:function(){return 0<this.items.length},enumerable:!0,configurable:!0});r.prototype.initialize=function(){var a=this,b=document.createElement("div");b.className="esri-overlay-surface";h.setSelectable(b,!1);this._set("surface",
b);this._hiddenSurface=document.createElement("div");this._hiddenSurface.setAttribute("style","visibility: hidden;");b.appendChild(this._hiddenSurface);this._itemsChangeHandle=this.items.on("change",function(b){b.added.map(function(b){var c=function(){return b.render()};a._callbacks.set(b,c);a._projector.append(a.surface,c)});b.removed.map(function(b){var c=a._projector.detach(a._callbacks.get(b));a.surface.removeChild(c.domNode);a._callbacks.delete(b)})})};r.prototype.addItem=function(a){this.items.add(a)};
r.prototype.removeItem=function(a){this.items.remove(a)};r.prototype.destroy=function(){this.items.removeAll();this._itemsChangeHandle.remove();this._projector=this._callbacks=null};r.prototype.render=function(){this._projector.renderNow()};r.prototype.computeBoundingRect=function(a){var b=this._hiddenSurface,c=this._hiddenProjector,d=null,l=function(){return d=a.render()};c.append(b,l);c.renderNow();var e={left:0,top:0,right:0,bottom:0};if(d&&d.domNode){var f=d.domNode.getBoundingClientRect();e.left=
f.left;e.top=f.top;e.right=f.right;e.bottom=f.bottom}for(c.detach(l);b.firstChild;)b.removeChild(b.firstChild);return e};r.prototype.overlaps=function(a,b){a=this.computeBoundingRect(a);b=this.computeBoundingRect(b);return Math.max(a.left,b.left)<=Math.min(a.right,b.right)&&Math.max(a.top,b.top)<=Math.min(a.bottom,b.bottom)};Object.defineProperty(r.prototype,"hasVisibleItems",{get:function(){return this.items.some(function(a){return a.visible})},enumerable:!0,configurable:!0});r.prototype.renderCanvas=
function(a){if(this.items.some(function(a){return a.visible})){var b=a.getContext("2d");b.save();b.font="10px "+getComputedStyle(this.surface).fontFamily;this.items.forEach(function(a){b.save();a.renderCanvas(b);b.restore()});b.restore()}};d([b.property({readOnly:!0})],r.prototype,"surface",void 0);d([b.property({readOnly:!0})],r.prototype,"items",void 0);d([b.property({readOnly:!0,dependsOn:["items.length"]})],r.prototype,"needsRender",null);return r=d([b.subclass("esri.views.overlay.ViewOverlay")],
r)}(b.declared(m))})},"esri/widgets/Popup":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper dojo/dom-geometry dojo/i18n!../nls/common dojo/i18n!./Popup/nls/Popup dojo/keys ../core/Handles ../core/lang ../core/Logger ../core/watchUtils ../core/accessorSupport/decorators ./Feature ./Spinner ./Widget ./Popup/PopupViewModel ./support/widget ./support/widgetUtils".split(" "),function(q,g,n,d,h,m,f,b,c,e,r,a,t,p,u,
l,k,w,v,C){function A(a,b){return void 0===b?"esri-popup__"+a:"esri-popup__"+a+"-"+b}var x={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},z=a.getLogger("esri.widgets.Popup");return function(a){function k(b){var c=a.call(this)||this;c._blurContainer=!1;c._containerNode=null;c._mainContainerNode=null;c._featureMenuNode=null;c._actionsMenuNode=null;c._focusContainer=!1;c._focusDockButton=!1;c._focusFeatureMenuButton=!1;c._focusActionsMenuButton=!1;c._focusFirstFeature=!1;c._focusFirstAction=
!1;c._handles=new e;c._pointerOffsetInPx=16;c._spinner=null;c.actions=null;c.alignment="auto";c.autoCloseEnabled=null;c.autoOpenEnabled=null;c.content=null;c.collapsed=!1;c.collapseEnabled=!0;c.dockEnabled=!1;c.featureCount=null;c.features=null;c.featureNavigationEnabled=!0;c.goToOverride=null;c.highlightEnabled=null;c.location=null;c.featureWidgets=[];c.promises=null;c.selectedFeature=null;c.selectedFeatureIndex=null;c.selectedFeatureWidget=null;c.spinnerEnabled=!0;c.title=null;c.updateLocationEnabled=
null;c.view=null;c.viewModel=new w;c.visible=null;c._addSelectedFeatureIndexHandle();c.own([t.watch(c,"viewModel.screenLocation",function(){return c._positionContainer()}),t.watch(c,["viewModel.visible","dockEnabled"],function(){return c._toggleScreenLocationEnabled()}),t.watch(c,"viewModel.screenLocation",function(a,b){!!a!==!!b&&c.reposition()}),t.watch(c,"viewModel.features",function(a){return c._createFeatureWidgets(a)}),t.watch(c,"viewModel.view.padding viewModel.view.size viewModel.visible viewModel.waitingForResult viewModel.location alignment".split(" "),
function(){return c.reposition()}),t.watch(c,"spinnerEnabled",function(a){return c._spinnerEnabledChange(a)}),t.watch(c,"viewModel.view.size",function(a,b){return c._updateDockEnabledForViewSize(a,b)}),t.watch(c,"viewModel.view",function(a,b){return c._viewChange(a,b)}),t.watch(c,"viewModel.view.ready",function(a,b){return c._viewReadyChange(a,b)}),t.watch(c,["viewModel.waitingForResult","viewModel.location"],function(){return c._displaySpinner()}),t.watch(c,["featureWidgets","viewModel.selectedFeatureIndex"],
function(){return c._updateFeatureWidget()}),t.watch(c,"selectedFeatureWidget.viewModel.title",function(a){return c._setTitleFromFeatureWidget(a)}),t.watch(c,["selectedFeatureWidget.viewModel.content","selectedFeatureWidget.viewModel.waitingForContent"],function(){return c._setContentFromFeatureWidget()}),t.whenFalse(c,"collapsed",function(){"xsmall"===c.get("viewModel.view.widthBreakpoint")&&c.visible&&c.collapseEnabled&&c.viewModel.centerAtLocation()})]);return c}n(k,a);k.prototype.destroy=function(){this._destroyFeatureWidgets();
this._destroySpinner();this._handles&&this._handles.destroy();this._handles=null};Object.defineProperty(k.prototype,"actionsMenuOpen",{get:function(){return this.viewModel.visible?this._get("actionsMenuOpen"):!1},set:function(a){this._set("actionsMenuOpen",!!a)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"currentAlignment",{get:function(){return this._getCurrentAlignment()},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"currentDockPosition",{get:function(){return this._getCurrentDockPosition()},
enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"dockOptions",{get:function(){return this._get("dockOptions")||x},set:function(a){var b=h({},x),c=this.get("viewModel.view.breakpoints"),d={};c&&(d.width=c.xsmall,d.height=c.xsmall);a=h({},b,a);b=h({},b.breakpoint,d);d=a.breakpoint;!0===d?a.breakpoint=b:"object"===typeof d&&(a.breakpoint=h({},b,d));this._set("dockOptions",a);this._setCurrentDockPosition();this.reposition()},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,
"featureMenuOpen",{get:function(){return this.viewModel.visible?this._get("featureMenuOpen"):!1},set:function(a){this._set("featureMenuOpen",!!a)},enumerable:!0,configurable:!0});k.prototype.blur=function(){this.visible||z.warn("Popup cannot be blurred while visible is false");this._blurContainer=!0;this.scheduleRender()};k.prototype.clear=function(){};k.prototype.close=function(){this.visible=!1};k.prototype.focus=function(){this.visible||z.warn("Popup cannot be focused while visible is false");
this._focusContainer=!0;this.scheduleRender()};k.prototype.next=function(){return null};k.prototype.open=function(a){this._handles.remove("selected-index");var b={collapsed:a?!!a.collapsed:!1,actionsMenuOpen:a?!!a.actionsMenuOpen:!1,featureMenuOpen:a?!!a.featureMenuOpen:!1};"xsmall"===this.get("viewModel.view.widthBreakpoint")&&(b.collapsed=!0,a.updateLocationEnabled=!0);this.set(b);this.viewModel.open(a);this._addSelectedFeatureIndexHandle()};k.prototype.previous=function(){return null};k.prototype.reposition=
function(){this.renderNow();this._positionContainer();this._setCurrentAlignment()};k.prototype.triggerAction=function(a){return null};k.prototype.render=function(){var a,c,d,l,e,p,t,k=this.actionsMenuOpen,u=this.collapsed,h=this.collapseEnabled,m=this.dockEnabled,w=this.featureMenuOpen,n=this.featureNavigationEnabled,x=this.featureWidgets,g=this.visible,q=this.viewModel,z=q.allActions,y=q.content,B=q.featureCount,Y=q.pendingPromisesCount,T=q.selectedFeatureIndex,P=q.title,Q=z&&z.length,R=1<B&&n,n=
1<B&&w,z=1<Q&&k,u=h&&!n&&u,E=R&&this._getPageText(B,T),U=this._renderContent(),J=C.isRTL(),V=this.get("selectedFeatureWidget")?this.get("selectedFeatureWidget.viewModel.waitingForContent")||this.get("selectedFeatureWidget.viewModel.content"):U,K=this.get("viewModel.view.widthBreakpoint"),M=m?b.undock:b.dock,B=this.currentAlignment,q=this.currentDockPosition,Y=Y?v.tsx("div",{key:A("loading-container"),role:"presentation",class:"esri-popup__loading-container","aria-label":f.loading,title:f.loading},
v.tsx("span",{"aria-hidden":"true",class:this.classes("esri-popup__icon","esri-icon-loading-indicator","esri-rotating")})):null,aa=(a={},a["esri-icon-right-triangle-arrow"]=J,a["esri-popup__pagination-previous-icon--rtl"]=J,a["esri-icon-left-triangle-arrow"]=!J,a["esri-popup__pagination-previous-icon"]=!J,a);a=v.tsx("span",{"aria-hidden":"true",class:this.classes("esri-popup__icon",aa)});aa=v.tsx("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes("esri-popup__button",
"esri-popup__pagination-previous"),"aria-label":b.previous,title:b.previous},a);a=(c={},c["esri-icon-left-triangle-arrow"]=J,c["esri-popup__pagination-next-icon--rtl"]=J,c["esri-icon-right-triangle-arrow"]=!J,c["esri-popup__pagination-next-icon"]=!J,c);c=v.tsx("span",{"aria-hidden":"true",class:this.classes("esri-popup__icon",a)});J=v.tsx("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes("esri-popup__button","esri-popup__pagination-next"),"aria-label":b.next,
title:b.next},c);a=C.cssTransition("enter","esri-popup--feature-updated");c=this.id+"-feature-menu";w=v.tsx("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:this.classes("esri-popup__button","esri-popup__feature-menu-button"),"aria-haspopup":"true","aria-controls":c,"aria-expanded":w,"aria-label":f.menu,title:f.menu},E);w=R?[aa,Y||w,J]:null;E=this._wouldDockTo();
E=(d={},d["esri-icon-minimize"]=m,d["esri-popup__icon--dock-icon"]=!m,d["esri-icon-dock-right"]=!m&&("top-right"===E||"bottom-right"===E),d["esri-icon-dock-left"]=!m&&("top-left"===E||"bottom-left"===E),d["esri-icon-maximize"]=!m&&"top-center"===E,d["esri-icon-dock-bottom"]=!m&&"bottom-center"===E,d);d=v.tsx("span",{"aria-hidden":"true",class:this.classes(E,"esri-popup__icon")});d="xsmall"!==K&&this.get("dockOptions.buttonEnabled")?v.tsx("div",{role:"button","aria-label":M,title:M,tabIndex:0,bind:this,
onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes("esri-popup__button","esri-popup__button--dock")},d):null;h=!!(h&&P&&(V||Q||R));K=(l={},l["esri-popup__header-container--button"]=h,l);M=h?"button":"heading";E=h?u?f.expand:f.collapse:"";l=this.id+"-popup-title";P=P?v.tsx("div",{class:this.classes("esri-popup__header-container",K),key:P,enterAnimation:a,id:l,role:M,"aria-label":E,title:E,
tabIndex:h?0:-1,bind:this,onclick:this._toggleCollapsed,onkeydown:this._toggleCollapsed},v.tsx("h2",{class:"esri-popup__header-title",innerHTML:P})):null;K=v.tsx("span",{"aria-hidden":"true",class:this.classes("esri-popup__icon","esri-icon-close")});K=v.tsx("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:"esri-popup__button","aria-label":f.close,title:f.close},K);d=v.tsx("header",{class:"esri-popup__header"},P,v.tsx("div",{class:"esri-popup__header-buttons"},
d,K));K=this.id+"-popup-content";y=V&&!u?v.tsx("article",{key:y,enterAnimation:a,id:K,class:"esri-popup__content"},U):null;V="bottom-left"===B||"bottom-center"===B||"bottom-right"===B||"top-left"===q||"top-center"===q||"top-right"===q;U="top-left"===B||"top-center"===B||"top-right"===B||"bottom-left"===q||"bottom-center"===q||"bottom-right"===q;M=k?f.close:f.open;a=(E=(a=this._getSingleAction())&&this._renderAction({action:a,index:0,key:"actions",singleButton:!0}))?v.tsx("div",{key:"single-action-container",
class:"esri-popup__single-action-container"},E):null;M=!E&&Q?v.tsx("div",{key:A("actions-menu-button"),class:this.classes("esri-popup__button","esri-popup__actions-menu-button"),role:"button",id:this.id+"-actions-menu-button","aria-haspopup":"true","aria-controls":k?this.id+"-actions-menu":null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":M,title:M},v.tsx("span",
{"aria-hidden":"true",class:"esri-icon-handle-horizontal"})):null;E=(e={},e["esri-popup__navigation--with-single-action"]=1===Q,e);e=v.tsx("section",{key:A("navigation"),class:this.classes("esri-popup__navigation",E)},w);e=R||Q?v.tsx("div",{key:A("feature-buttons"),class:"esri-popup__footer"},e,M,a):null;k=Q&&k?v.tsx("ul",{id:this.id+"-actions-menu",role:"menu","aria-labelledby":this.id+"-actions-menu-button",key:A("actions"),class:"esri-popup__actions",bind:this,onkeyup:this._handleActionMenuKeyup,
afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},this._renderActions()):null;T=this._renderFeatureMenuNode(x,T,c);x=r.substitute({total:x.length},b.selectedFeatures);R=v.tsx("section",{key:A("menu"),class:"esri-popup__feature-menu"},v.tsx("h2",{class:"esri-popup__feature-menu-header"},x),v.tsx("nav",{class:"esri-popup__feature-menu-viewport",afterCreate:this._featureMenuViewportNodeUpdated,afterUpdate:this._featureMenuViewportNodeUpdated},T));x=m?null:v.tsx("div",
{key:A("pointer"),class:"esri-popup__pointer",role:"presentation"},v.tsx("div",{class:this.classes("esri-popup__pointer-direction","esri-popup--shadow")}));T=this.get("selectedFeature.layer.title");Q=this.get("selectedFeature.layer.id");u=(p={},p["esri-popup--shadow"]=m,p["esri-popup--is-collapsible"]=h,p["esri-popup--is-collapsed"]=u,p);p=(t={},t["esri-popup--aligned-top-center"]=g&&"top-center"===B,t["esri-popup--aligned-bottom-center"]=g&&"bottom-center"===B,t["esri-popup--aligned-top-left"]=g&&
"top-left"===B,t["esri-popup--aligned-bottom-left"]=g&&"bottom-left"===B,t["esri-popup--aligned-top-right"]=g&&"top-right"===B,t["esri-popup--aligned-bottom-right"]="bottom-right"===B,t["esri-popup--is-docked"]=g&&m,t["esri-popup--shadow"]=g&&!m,t["esri-popup--is-docked-top-left"]=g&&"top-left"===q,t["esri-popup--is-docked-top-center"]=g&&"top-center"===q,t["esri-popup--is-docked-top-right"]=g&&"top-right"===q,t["esri-popup--is-docked-bottom-left"]=g&&"bottom-left"===q,t["esri-popup--is-docked-bottom-center"]=
g&&"bottom-center"===q,t["esri-popup--is-docked-bottom-right"]=g&&"bottom-right"===q,t["esri-popup--feature-menu-open"]=g&&n,t["esri-popup--actions-menu-open"]=g&&z,t);t=V?[R,k]:null;m=U?[R,k]:null;n=V?e:null;z=U?e:null;t=v.tsx("div",{class:this.classes("esri-popup__main-container","esri-widget",u),tabIndex:-1,role:"dialog","aria-labelledby":P?l:"","aria-describedby":y?K:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},
n,t,d,y,z,m);return v.tsx("div",{key:A("base"),class:this.classes("esri-popup",p),role:"presentation","data-layer-title":T,"data-layer-id":Q,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},g?[t,x]:null)};k.prototype._getSingleAction=function(){var a=this.viewModel.allActions;if(1===a.length)return a.find(function(a){return"button"===a.type})};k.prototype._featureMenuOpenChanged=function(a){a?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0};k.prototype._actionsMenuOpenChanged=
function(a){a?this._focusFirstAction=!0:this._focusActionsMenuButton=!0};k.prototype._setTitleFromFeatureWidget=function(a){this.selectedFeatureWidget&&(this.viewModel.title=a||"")};k.prototype._setContentFromFeatureWidget=function(){var a=this.selectedFeatureWidget;a&&(this.viewModel.content=a)};k.prototype._handleFeatureMenuKeyup=function(a){a.keyCode===c.ESCAPE&&(a.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender())};k.prototype._handleActionMenuKeyup=
function(a){a.keyCode===c.ESCAPE&&(a.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender())};k.prototype._handleFeatureMenuItemKeyup=function(a){var b=a.keyCode,d=this._featureMenuNode,l=a.currentTarget["data-feature-index"];if(d){var d=d.querySelectorAll("li"),e=d.length;b===c.UP_ARROW?(a.stopPropagation(),d[(l-1+e)%e].focus()):b===c.DOWN_ARROW?(a.stopPropagation(),d[(l+1+e)%e].focus()):b===c.HOME?(a.stopPropagation(),d[0].focus()):b===c.END&&(a.stopPropagation(),
d[d.length-1].focus())}};k.prototype._handleActionMenuItemKeyup=function(a){var b=a.keyCode,d=this._actionsMenuNode,l=a.currentTarget["data-action-index"];if(d){var d=d.querySelectorAll("li"),e=d.length;b===c.UP_ARROW?(a.stopPropagation(),d[(l-1+e)%e].focus()):b===c.DOWN_ARROW?(a.stopPropagation(),d[(l+1+e)%e].focus()):b===c.HOME?(a.stopPropagation(),d[0].focus()):b===c.END&&(a.stopPropagation(),d[d.length-1].focus())}};k.prototype._handleMainKeyup=function(a){var b=a.keyCode;b===c.LEFT_ARROW&&(a.stopPropagation(),
this.previous());b===c.RIGHT_ARROW&&(a.stopPropagation(),this.next())};k.prototype._spinnerEnabledChange=function(a){this._destroySpinner();a&&(a=this.get("viewModel.view"),this._createSpinner(a))};k.prototype._displaySpinner=function(){var a=this._spinner;if(a){var b=this.viewModel,c=b.location;b.waitingForResult?a.show({location:c}):a.hide()}};k.prototype._getIconStyles=function(a){return{"background-image":a?"url("+a+")":""}};k.prototype._renderAction=function(a){var b=this,c,d,l=a.action,e=a.index,
p=a.key;a=a.singleButton;var f=t.watch(l,"active className disabled id title image visible".split(" "),function(){return b.scheduleRender()});this._handles.add(f,p);var f=this.get("selectedFeature.attributes"),p=l.title,k=l.className,u=l.image,k=u||k?k:"esri-icon-default-action",p=p&&f?r.substitute(f,p):p,h=k&&f?r.substitute(f,k):k,f=u&&f?r.substitute(f,u):u,u=(c={},c["esri-icon-loading-indicator"]=l.active,c["esri-rotating"]=l.active,c["esri-popup__icon"]=!!k,c["esri-popup__action-image"]=!l.active&&
!!f,c);h&&(u[h]=!l.active);c=(d={},d["esri-popup__action"]="toggle"!==l.type,d["esri-popup__action-toggle"]="toggle"===l.type,d["esri-popup__action-toggle--on"]="toggle"===l.type&&l.value,d["esri-popup__button--disabled"]=l.disabled,d);d=v.tsx("span",{key:"text",class:"esri-popup__action-text"},p);d=[v.tsx("span",{key:"icon","aria-hidden":"true",class:this.classes("esri-popup__icon",u),styles:this._getIconStyles(f)}),d];e=a?v.tsx("div",{key:l,role:"button",tabIndex:0,title:p,"aria-label":p,class:this.classes("esri-popup__button",
c),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-index":e,onclick:this._triggerAction,onkeydown:this._triggerAction},d):v.tsx("li",{key:l,role:"menuitem",tabIndex:0,title:p,"aria-label":p,class:this.classes("esri-popup__button",c),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-index":e,onclick:this._triggerAction,onkeydown:this._triggerAction},d);return l.visible?e:null};k.prototype._renderActions=function(){var a=this;this._handles.remove("actions");var b=this.viewModel.allActions;
if(b)return b.map(function(b,c){return a._renderAction({action:b,index:c,key:"actions"})}).toArray()};k.prototype._addSelectedFeatureIndexHandle=function(){var a=this,b=t.watch(this,"viewModel.selectedFeatureIndex",function(b,c){return a._selectedFeatureIndexUpdated(b,c)});this._handles.add(b,"selected-index")};k.prototype._selectedFeatureIndexUpdated=function(a,b){this.featureCount&&a!==b&&-1!==a&&(this.featureMenuOpen=this.actionsMenuOpen=!1)};k.prototype._updateFeatureWidget=function(){var a=this.featureWidgets[this.viewModel.selectedFeatureIndex]||
null;a&&!a.contentEnabled&&(a.contentEnabled=!0);this._set("selectedFeatureWidget",a)};k.prototype._destroyFeatureWidgets=function(){this.featureWidgets.forEach(function(a){return a.destroy()});this._set("featureWidgets",[])};k.prototype._createFeatureWidgets=function(a){var b=this.featureWidgets.slice(0),c=this.get("viewModel.view"),d=[];a.forEach(function(a,l){if(a){var e=null;b.some(function(c,d){c&&c.graphic===a&&(e=c,b.splice(d,1));return!!e});d[l]=e||new u({contentEnabled:!1,graphic:a,view:c})}});
b.forEach(function(a){return a&&a.destroy()});this._set("featureWidgets",d)};k.prototype._isScreenLocationWithinView=function(a,b){return-1<a.x&&-1<a.y&&a.x<=b.width&&a.y<=b.height};k.prototype._isOutsideView=function(a){var b=a.popupHeight,c=a.popupWidth,d=a.screenLocation,l=a.side;a=a.view;if(isNaN(c)||isNaN(b)||!a||!d)return!1;var e=a.padding;return"right"===l&&d.x+c/2>a.width-e.right||"left"===l&&d.x-c/2<e.left||"top"===l&&d.y-b<e.top||"bottom"===l&&d.y+b>a.height-e.bottom?!0:!1};k.prototype._determineCurrentAlignment=
function(){var a=this._pointerOffsetInPx,b=this._containerNode,c=this._mainContainerNode,d=this.viewModel,l=d.screenLocation,d=d.view;if(!l||!d||!b)return"top-center";if(!this._isScreenLocationWithinView(l,d))return this._get("currentAlignment")||"top-center";var e=c?window.getComputedStyle(c,null):null,c=e?parseInt(e.getPropertyValue("max-height").replace(/[^-\d\.]/g,""),10):0,e=e?parseInt(e.getPropertyValue("height").replace(/[^-\d\.]/g,""),10):0,p=m.getContentBox(b),b=p.w+a,p=Math.max(p.h,c,e)+
a,a=this._isOutsideView({popupHeight:p,popupWidth:b,screenLocation:l,side:"right",view:d}),c=this._isOutsideView({popupHeight:p,popupWidth:b,screenLocation:l,side:"left",view:d}),e=this._isOutsideView({popupHeight:p,popupWidth:b,screenLocation:l,side:"top",view:d}),l=this._isOutsideView({popupHeight:p,popupWidth:b,screenLocation:l,side:"bottom",view:d});return c?e?"bottom-right":"top-right":a?e?"bottom-left":"top-left":e?l?"top-center":"bottom-center":"top-center"};k.prototype._getCurrentAlignment=
function(){var a=this.alignment;return this.dockEnabled?null:"auto"===a?this._determineCurrentAlignment():"function"===typeof a?a.call(this):a};k.prototype._setCurrentAlignment=function(){this._set("currentAlignment",this._getCurrentAlignment())};k.prototype._setCurrentDockPosition=function(){this._set("currentDockPosition",this._getCurrentDockPosition())};k.prototype._getDockPosition=function(){var a=this.get("dockOptions.position");return"auto"===a?this._determineCurrentDockPosition():"function"===
typeof a?a.call(this):a};k.prototype._getCurrentDockPosition=function(){return this.dockEnabled?this._getDockPosition():null};k.prototype._wouldDockTo=function(){return this.dockEnabled?null:this._getDockPosition()};k.prototype._renderFeatureMenuItemNode=function(a,c,d){var l,e=c===d,p=(l={},l["esri-popup__feature-menu-item--selected"]=e,l);l=e?v.tsx("span",{key:A("feature-menu-selected-feature-"+d),title:b.selectedFeature,"aria-label":b.selectedFeature,class:"esri-icon-check-mark"}):null;a=v.tsx("span",
{innerHTML:a.title||f.untitled});return v.tsx("li",{role:"menuitem",tabIndex:-1,key:A("feature-menu-feature-"+d),class:this.classes(p,"esri-popup__feature-menu-item"),bind:this,"data-feature-index":c,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature},v.tsx("span",{class:"esri-popup__feature-menu-title"},a,l))};k.prototype._renderFeatureMenuNode=function(a,b,c){var d=this;return 1<a.length?v.tsx("ol",{class:"esri-popup__feature-menu-list",id:c,bind:this,
afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},a.map(function(a,c){return d._renderFeatureMenuItemNode(a,c,b)})):null};k.prototype._determineCurrentDockPosition=function(){var a=this.get("viewModel.view"),b=C.isRTL()?"top-left":"top-right";if(!a)return b;var c=a.padding||{left:0,right:0,top:0,bottom:0},c=a.width-c.left-c.right;return(a=a.get("breakpoints"))&&c<=a.xsmall?"bottom-center":b};k.prototype._renderContent=
function(){var a=this.get("viewModel.content");if("string"===typeof a)return v.tsx("div",{key:a,innerHTML:a});if(v.isWidget(a))return v.tsx("div",{key:a},a.render());if(a instanceof HTMLElement)return v.tsx("div",{key:a,bind:a,afterCreate:this._attachToNode});if(v.isWidgetBase(a))return v.tsx("div",{key:a,bind:a.domNode,afterCreate:this._attachToNode})};k.prototype._attachToNode=function(a){a.appendChild(this)};k.prototype._positionContainer=function(a){void 0===a&&(a=this._containerNode);a&&(this._containerNode=
a);if(a){var b=this.viewModel.screenLocation,c=m.getContentBox(a);if(b=this._calculatePositionStyle(b,c))a.style.top=b.top,a.style.left=b.left,a.style.bottom=b.bottom,a.style.right=b.right}};k.prototype._calculateFullWidth=function(a){var b=this.currentAlignment,c=this._pointerOffsetInPx;return"top-left"===b||"bottom-left"===b||"top-right"===b||"bottom-right"===b?a+c:a};k.prototype._calculateAlignmentPosition=function(a,b,c,d){var l=this.currentAlignment,e=this._pointerOffsetInPx;d/=2;var p=c.height-
b;c=c.width-a;var f=this.view.padding;if("bottom-center"===l)return{top:b+e-f.top,left:a-d-f.left};if("top-left"===l)return{bottom:p+e-f.bottom,right:c+e-f.right};if("bottom-left"===l)return{top:b+e-f.top,right:c+e-f.right};if("top-right"===l)return{bottom:p+e-f.bottom,left:a+e-f.left};if("bottom-right"===l)return{top:b+e-f.top,left:a+e-f.left};if("top-center"===l)return{bottom:p+e-f.bottom,left:a-d-f.left}};k.prototype._calculatePositionStyle=function(a,b){var c=this.view;if(c){if(this.dockEnabled)return{left:"",
top:"",right:"",bottom:""};if(a&&b&&(b=this._calculateFullWidth(b.w),a=this._calculateAlignmentPosition(a.x,a.y,c,b)))return{top:void 0!==a.top?a.top+"px":"auto",left:void 0!==a.left?a.left+"px":"auto",bottom:void 0!==a.bottom?a.bottom+"px":"auto",right:void 0!==a.right?a.right+"px":"auto"}}};k.prototype._viewChange=function(a,b){a&&b&&(this.close(),this.clear())};k.prototype._viewReadyChange=function(a,b){a?(a=this.get("viewModel.view"),this._wireUpView(a)):b&&(this.close(),this.clear())};k.prototype._wireUpView=
function(a){this._destroySpinner();a&&(this.spinnerEnabled&&this._createSpinner(a),this._setDockEnabledForViewSize(this.dockOptions))};k.prototype._dockingThresholdCrossed=function(a,b,c){var d=a[0];a=a[1];var l=b[0];b=b[1];var e=c.width;c=c.height;return d<=e&&l>e||d>e&&l<=e||a<=c&&b>c||a>c&&b<=c};k.prototype._updateDockEnabledForViewSize=function(a,b){if(a&&b){var c=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},d=c.left+c.right,l=c.top+c.bottom,c=[],e=[];c[0]=a[0]-d;c[1]=a[1]-
l;e[0]=b[0]-d;e[1]=b[1]-l;a=this.dockOptions;this._dockingThresholdCrossed(c,e,a.breakpoint)&&this._setDockEnabledForViewSize(a);this._setCurrentDockPosition()}};k.prototype._focusDockButtonNode=function(a){this._focusDockButton&&(this._focusDockButton=!1,a.focus())};k.prototype._mainContainerNodeUpdated=function(a){this._mainContainerNode=a;this._focusContainer?(this._focusContainer=!1,a.focus()):this._blurContainer&&(this._blurContainer=!1,a.blur())};k.prototype._featureMenuNodeUpdated=function(a){(this._featureMenuNode=
a)&&this._focusFirstFeature&&(this._focusFirstFeature=!1,a=a.querySelectorAll("li"),a.length&&a[0].focus())};k.prototype._actionsMenuNodeUpdated=function(a){(this._actionsMenuNode=a)&&this._focusFirstAction&&(this._focusFirstAction=!1,a=a.querySelectorAll("li"),a.length&&a[0].focus())};k.prototype._focusFeatureMenuButtonNode=function(a){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,a.focus())};k.prototype._focusActionsMenuButtonNode=function(a){this._focusActionsMenuButton&&(this._focusActionsMenuButton=
!1,a.focus())};k.prototype._featureMenuViewportNodeUpdated=function(a){a&&(a.scrollTop=0)};k.prototype._toggleScreenLocationEnabled=function(){var a=this.dockEnabled,b=this.viewModel;b&&(b.screenLocationEnabled=this.visible&&!a)};k.prototype._shouldDockAtCurrentViewSize=function(a){a=a.breakpoint;var b=this.get("viewModel.view.ui"),c=b.width,b=b.height;if(isNaN(c)||isNaN(b))return!1;c=a.hasOwnProperty("width")&&c<=a.width;a=a.hasOwnProperty("height")&&b<=a.height;return c||a};k.prototype._setDockEnabledForViewSize=
function(a){a.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(a))};k.prototype._getPageText=function(a,c){return r.substitute({index:c+1,total:a},b.pageText)};k.prototype._destroySpinner=function(){var a=this._spinner,b=this.view;a&&(b&&b.ui.remove(this._spinner,"popup-spinner"),a.destroy(),this._spinner=null)};k.prototype._createSpinner=function(a){a&&(this._spinner=new l({view:a}),a.ui.add(this._spinner,{key:"popup-spinner",position:"manual"}))};k.prototype._toggleCollapsed=function(){this.collapsed=
!this.collapsed};k.prototype._close=function(){this.close();this.view&&this.view.focus()};k.prototype._toggleDockEnabled=function(){this.dockEnabled=!this.dockEnabled;this._focusDockButton=!0;this.scheduleRender()};k.prototype._toggleFeatureMenu=function(){var a=!this.featureMenuOpen;this._featureMenuOpenChanged(a);this.actionsMenuOpen=!1;this.featureMenuOpen=a};k.prototype._toggleActionsMenu=function(){var a=!this.actionsMenuOpen;this._actionsMenuOpenChanged(a);this.featureMenuOpen=!1;this.actionsMenuOpen=
a};k.prototype._triggerAction=function(a){a=a.currentTarget["data-action-index"];var b=this.viewModel.allActions.getItemAt(a);b&&"toggle"===b.type&&(b.value=!b.value);this.actionsMenuOpen=!1;this.viewModel.triggerAction(a)};k.prototype._selectFeature=function(a){a=a.currentTarget["data-feature-index"];isNaN(a)||(this.viewModel.selectedFeatureIndex=a);this._focusFeatureMenuButton=!0;this.scheduleRender()};k.prototype._next=function(){this.next()};k.prototype._previous=function(){this.previous()};d([p.aliasOf("viewModel.actions"),
v.renderable()],k.prototype,"actions",void 0);d([p.property({dependsOn:["viewModel.visible"]}),v.renderable()],k.prototype,"actionsMenuOpen",null);d([p.property()],k.prototype,"alignment",void 0);d([p.aliasOf("viewModel.autoCloseEnabled")],k.prototype,"autoCloseEnabled",void 0);d([p.aliasOf("viewModel.autoOpenEnabled")],k.prototype,"autoOpenEnabled",void 0);d([p.aliasOf("viewModel.content"),v.renderable()],k.prototype,"content",void 0);d([p.property(),v.renderable()],k.prototype,"collapsed",void 0);
d([p.property(),v.renderable()],k.prototype,"collapseEnabled",void 0);d([p.property({readOnly:!0,dependsOn:["dockEnabled","alignment"]}),v.renderable()],k.prototype,"currentAlignment",null);d([p.property({readOnly:!0,dependsOn:["viewModel.view.ready","dockEnabled","dockOptions"]}),v.renderable()],k.prototype,"currentDockPosition",null);d([p.property(),v.renderable()],k.prototype,"dockOptions",null);d([p.property(),v.renderable()],k.prototype,"dockEnabled",void 0);d([p.aliasOf("viewModel.featureCount"),
v.renderable()],k.prototype,"featureCount",void 0);d([p.property({dependsOn:["viewModel.visible"]}),v.renderable()],k.prototype,"featureMenuOpen",null);d([p.aliasOf("viewModel.features"),v.renderable()],k.prototype,"features",void 0);d([p.property(),v.renderable()],k.prototype,"featureNavigationEnabled",void 0);d([p.aliasOf("viewModel.goToOverride")],k.prototype,"goToOverride",void 0);d([p.aliasOf("viewModel.highlightEnabled")],k.prototype,"highlightEnabled",void 0);d([p.aliasOf("viewModel.location"),
v.renderable()],k.prototype,"location",void 0);d([p.property({readOnly:!0}),v.renderable()],k.prototype,"featureWidgets",void 0);d([p.aliasOf("viewModel.promises")],k.prototype,"promises",void 0);d([p.aliasOf("viewModel.selectedFeature"),v.renderable()],k.prototype,"selectedFeature",void 0);d([p.aliasOf("viewModel.selectedFeatureIndex"),v.renderable()],k.prototype,"selectedFeatureIndex",void 0);d([p.property({readOnly:!0}),v.renderable()],k.prototype,"selectedFeatureWidget",void 0);d([p.property()],
k.prototype,"spinnerEnabled",void 0);d([p.aliasOf("viewModel.title"),v.renderable()],k.prototype,"title",void 0);d([p.aliasOf("viewModel.updateLocationEnabled")],k.prototype,"updateLocationEnabled",void 0);d([p.aliasOf("viewModel.view")],k.prototype,"view",void 0);d([p.property({type:w}),v.renderable("viewModel.view.widthBreakpoint viewModel.allActions viewModel.screenLocation viewModel.screenLocationEnabled viewModel.state viewModel.pendingPromisesCount viewModel.promiseCount viewModel.waitingForResult".split(" ")),
v.vmEvent(["triggerAction","trigger-action"])],k.prototype,"viewModel",void 0);d([p.aliasOf("viewModel.visible"),v.renderable()],k.prototype,"visible",void 0);d([p.aliasOf("viewModel.clear")],k.prototype,"clear",null);d([p.aliasOf("viewModel.next")],k.prototype,"next",null);d([p.aliasOf("viewModel.previous")],k.prototype,"previous",null);d([p.aliasOf("viewModel.triggerAction")],k.prototype,"triggerAction",null);d([v.accessibleHandler()],k.prototype,"_toggleCollapsed",null);d([v.accessibleHandler()],
k.prototype,"_close",null);d([v.accessibleHandler()],k.prototype,"_toggleDockEnabled",null);d([v.accessibleHandler()],k.prototype,"_toggleFeatureMenu",null);d([v.accessibleHandler()],k.prototype,"_toggleActionsMenu",null);d([v.accessibleHandler()],k.prototype,"_triggerAction",null);d([v.accessibleHandler()],k.prototype,"_selectFeature",null);d([v.accessibleHandler()],k.prototype,"_next",null);d([v.accessibleHandler()],k.prototype,"_previous",null);return k=d([p.subclass("esri.widgets.Popup")],k)}(p.declared(k))})},
"esri/widgets/Feature":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./Feature/nls/Feature dojo/keys ../core/lang ../core/promiseUtils ../core/watchUtils ../core/accessorSupport/decorators ./Widget ./Feature/FeatureViewModel ./Feature/support/attachmentUtils ./support/uriUtils ./support/widget".split(" "),function(q,g,n,d,h,m,f,b,c,e,r,a,t,p,u){function l(a,b){return void 0===b?"esri-feature__"+a:"esri-feature__"+a+"-"+b}return function(r){function k(b){b=
r.call(this)||this;b._chartMap=new Map;b._activeMediaMap=new Map;b._chartRequirePromise=null;b._refreshTimers=new Map;b._mediaInfo=new Map;b.contentEnabled=null;b.graphic=null;b.title=null;b.view=null;b.viewModel=new a;return b}n(k,r);k.prototype.postInitialize=function(){var a=this;this.own(c.init(this,"viewModel.content",function(){return a._setupMediaRefreshTimers()}))};k.prototype.destroy=function(){this._clearMediaRefreshTimers();this._activeMediaMap.clear();this._activeMediaMap=null;this._cancelChartModules();
this._destroyCharts()};k.prototype.render=function(){var a=u.tsx("div",{key:l("loading-container"),class:"esri-feature__loading-container"},u.tsx("span",{class:this.classes("esri-icon-loading-indicator esri-rotating","esri-feature__loading-spinner")})),a=this.viewModel.waitingForContent?a:[this._renderContent(),this._renderLastEditInfo()];return u.tsx("div",{class:this.classes("esri-feature","esri-widget")},u.tsx("div",{class:"esri-feature__size-container"},u.tsx("div",{class:"esri-feature__main-container"},
a)))};k.prototype.goToMedia=function(a,b){this._setContentElementMedia(a,b)};k.prototype.nextMedia=function(a){this._pageContentElementMedia(a,"next")};k.prototype.previousMedia=function(a){this._pageContentElementMedia(a,"previous")};k.prototype._cancelChartModules=function(){var a=this._chartRequirePromise;a&&a.cancel();this._chartRequirePromise=null};k.prototype._destroyChart=function(a){var b=this._chartMap.get(a);b&&(b.chart.destroy(),b.tooltip.destroy());this._chartMap.delete(a)};k.prototype._destroyCharts=
function(){this._chartMap.forEach(function(a){a.chart.destroy();a.tooltip.destroy()});this._chartMap.clear()};k.prototype._renderContent=function(){this._destroyCharts();var a=this.viewModel.content;if("string"===typeof a)return u.tsx("div",{key:l("content-string"),innerHTML:a});if(u.isWidget(a))return u.tsx("div",{key:l("content-widget")},a.render());if(a instanceof HTMLElement)return u.tsx("div",{key:l("content-html-element"),bind:a,afterCreate:this._attachToNode});if(u.isWidgetBase(a))return u.tsx("div",
{key:l("content-dijit"),bind:a.domNode,afterCreate:this._attachToNode});if(Array.isArray(a))return a.length?u.tsx("div",{key:l("content-content-elements")},a.map(this._renderContentElement,this)):null};k.prototype._renderContentElement=function(a,b){switch(a.type){case "attachments":return this._renderAttachments(a,b);case "fields":return this._renderFields(a,b);case "media":return this._renderMedia(a,b);case "text":return this._renderText(a,b);default:return null}};k.prototype._renderAttachmentInfo=
function(a){var b,c,d=a.attachmentInfo,l=a.supportsResizeAttachments,e=d.contentType;a=d.name;var p=d.url,k=l&&t.isSupportedImage(e),f=-1===p.indexOf("?")?"?":"\x26",e=k?""+p+f+"w\x3d48":t.getIconPath(e),k=(b={},b["esri-feature__attachment-item-mask--icon"]=!k,b);b=(c={},c["esri-feature__attachments-image--resizable"]=l,c);return u.tsx("li",{class:"esri-feature__attachments-item",key:d},u.tsx("a",{class:"esri-feature__attachments-item-link",href:p,target:"_blank"},u.tsx("div",{class:this.classes(k,
"esri-feature__attachment-item-mask")},u.tsx("img",{alt:"",class:this.classes(b,"esri-feature__attachments-image"),src:e}),u.tsx("span",{class:"esri-feature__attachments-image-overlay"},u.tsx("span",{"aria-hidden":"true",class:"esri-feature__attachments-link-icon esri-icon-link-external"}))),u.tsx("span",{class:"esri-feature__attachments-filename"},a||h.noTitle)))};k.prototype._renderAttachments=function(a,b){var c=this,d,e=a.displayType,p=(b=a.attachmentInfos)&&b.length,k=this.get("graphic.layer.capabilities.operations.supportsResizeAttachments"),
e=(d={},d["esri-feature__attachments--list"]="preview"!==e,d["esri-feature__attachments--preview"]="preview"===e,d);return p?u.tsx("div",{key:l("attachments-element"),class:this.classes("esri-feature__attachments","esri-feature__content-element",e)},u.tsx("div",{class:"esri-feature__attachments-title"},h.attach),u.tsx("ul",{class:"esri-feature__attachments-items"},b.map(function(b,d){return c._renderAttachmentInfo({attachmentInfo:b,attachmentInfoIndex:d,supportsResizeAttachments:k,contentElement:a})}))):
null};k.prototype._forceLTR=function(a){return"\x26lrm;"+a};k.prototype._renderFieldInfo=function(a,b){var c,d=this.viewModel.formattedAttributes,e=d?d.content[b]||d.global:null,k=a.fieldName,d=a.label||k,e=e?null==e[k]?"":e[k]:"";a=!(!a.format||!a.format.dateFormat);e="number"!==typeof e||a?p.autoLink(e):this._forceLTR(e);a=(c={},c["esri-feature__field-data--date"]=a,c);return u.tsx("tr",{key:l("fields-element-info-row",b)},u.tsx("th",{key:l("fields-element-info-row-header",b),class:"esri-feature__field-header",
innerHTML:d}),u.tsx("td",{key:l("fields-element-info-row-data",b),class:this.classes("esri-feature__field-data",a),innerHTML:e}))};k.prototype._renderFields=function(a,b){var c=this;return(a=a.fieldInfos)?u.tsx("div",{key:l("fields-element",b),class:this.classes("esri-feature__fields","esri-feature__content-element")},u.tsx("table",{class:"esri-widget__table",summary:h.fieldsSummary,key:l("fields-element-table",b)},u.tsx("tbody",{key:l("fields-element-table-body",b)},a.map(function(a){return c._renderFieldInfo(a,
b)})))):null};k.prototype._shouldOpenInNewTab=function(a){void 0===a&&(a="");if(a)return!/^(?:mailto:|tel:)/.test(a.trim().toLowerCase())};k.prototype._clearMediaRefreshTimers=function(){this._refreshTimers.forEach(function(a){return clearTimeout(a)});this._refreshTimers.clear()};k.prototype._clearMediaRefreshTimer=function(a){var b=this._refreshTimers.get(a);b&&(clearTimeout(b),this._refreshTimers.delete(a))};k.prototype._getImageSource=function(a,b){var c=-1!==a.indexOf("?")?"\x26":"?";a=a.split("#");
var d=a[1],d=void 0===d?"":d;return""+a[0]+c+"timestamp\x3d"+b+(d?"#":"")+d};k.prototype._setupMediaRefreshTimer=function(a){var b=this.get("viewModel.content");if(Array.isArray(b)&&(b=b[a])&&"media"===b.type){var c=this._activeMediaMap.get(a);isNaN(c)&&(c=0);(b=b.mediaInfos[c])&&"image"===b.type&&b.refreshInterval&&this._setRefreshTimeout(a,b)}};k.prototype._setupMediaRefreshTimers=function(){var a=this;this._clearMediaRefreshTimers();var b=this.get("viewModel.content");Array.isArray(b)&&b.forEach(function(b,
c){return a._setupMediaRefreshTimer(c)})};k.prototype._updateMediaInfoTimestamp=function(a,b){var c=Date.now();this._mediaInfo.set(b,{timestamp:c,sourceURL:this._getImageSource(a,c)});this.scheduleRender()};k.prototype._setRefreshTimeout=function(a,b){var c=this,d=b.refreshInterval,e=b.value;d&&(b=6E4*d,this._updateMediaInfoTimestamp(e.sourceURL,a),b=setInterval(function(){c._updateMediaInfoTimestamp(e.sourceURL,a)},b),this._refreshTimers.set(a,b))};k.prototype._renderMediaInfoType=function(a,b){var c=
a.title,c=void 0===c?"":c;if("image"===a.type){var d=a.value,e=a.refreshInterval,k=d.sourceURL,d=d.linkURL;a=this._shouldOpenInNewTab(d)?"_blank":"_self";k=(e=e?this._mediaInfo.get(b):null)?e.sourceURL:k;b=u.tsx("img",{alt:c,key:l("media-image-"+(e?e.timestamp:0),b),src:k});return(c=d?u.tsx("a",{title:c,href:d,target:a},b):null)?c:b}if(-1!==a.type.indexOf("chart"))return u.tsx("div",{key:l("chart",b),bind:this,"data-media-info":a,"data-content-element-index":b,class:"esri-feature__media-chart",afterCreate:this._getChartDependencies,
afterUpdate:this._getChartDependencies})};k.prototype._getChartDependencies=function(a){var c=this,d=a["data-media-info"],e=a["data-content-element-index"],l=d.value,k=l.theme||"Claro",p=d.type,f=k;"string"===typeof k&&(f=k.replace(/\./g,"/"));this._cancelChartModules();this._chartRequirePromise=b.create(function(a){return q(["dojox/charting/Chart2D","dojox/charting/action2d/Tooltip","dojox/charting/themes/"+f],function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return a(b)})}).then(function(b){c._renderChart(a,
e,p,l,b[0],b[1],b[2]);c._chartRequirePromise=null})};k.prototype._renderChart=function(a,b,c,d,e,l,k){a=new e(a,{margins:{l:4,t:4,r:4,b:4}});k&&a.setTheme(k);switch(c){case "pie-chart":a.addPlot("default",{type:"Pie",labels:!1});a.addSeries("Series A",d.series);break;case "line-chart":a.addPlot("default",{type:"Markers"});a.addAxis("x",{min:0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1});a.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});d.series.forEach(function(a,b){a.x=
b+1});a.addSeries("Series A",d.series);break;case "column-chart":a.addPlot("default",{type:"Columns",gap:3});a.addAxis("y",{includeZero:!0,vertical:!0,fixUpper:"minor"});a.addSeries("Series A",d.series);break;case "bar-chart":a.addPlot("default",{type:"Bars",gap:3}),a.addAxis("x",{includeZero:!0,fixUpper:"minor",minorLabels:!1}),a.addAxis("y",{vertical:!0,majorTicks:!1,minorTicks:!1,majorLabels:!1,minorLabels:!1}),a.addSeries("Series A",d.series)}c=new l(a);a.render();this._chartMap.set(b,{chart:a,
tooltip:c})};k.prototype._renderMediaInfo=function(a,b){this._destroyChart(b);var c=this._renderMediaInfoType(a,b),d=a.title?u.tsx("div",{key:l("media-title",b),class:"esri-feature__media-item-title",innerHTML:a.title}):null;a=a.caption?u.tsx("div",{key:l("media-caption",b),class:"esri-feature__media-item-caption",innerHTML:a.caption}):null;return u.tsx("div",{key:l("media-container",b),class:"esri-feature__media-item-container"},u.tsx("div",{key:l("media-item-container",b),class:"esri-feature__media-item"},
c),d,a)};k.prototype._renderMediaStatsItem=function(a,b,c){c="chart"===c?this.classes("esri-feature__media-chart-icon","esri-icon-chart"):this.classes("esri-feature__media-image-icon","esri-icon-media");return u.tsx("li",{class:"esri-feature__media-image-summary"},u.tsx("span",{"aria-hidden":"true",class:c}),u.tsx("span",{class:"esri-feature__media-count","aria-label":a},"("+b+")"))};k.prototype._renderMediaPageButton=function(a,b){var c=(a="previous"===a)?h.previous:h.next,d=a?this.classes("esri-feature__button",
"esri-feature__media-previous"):this.classes("esri-feature__button","esri-feature__media-next"),e=a?this.classes("esri-feature__icon","esri-feature__media-previous-icon","esri-icon-left-triangle-arrow"):this.classes("esri-feature__icon","esri-feature__media-next-icon","esri-icon-right-triangle-arrow"),k=a?this.classes("esri-feature__icon","esri-feature__media-previous-icon--rtl","esri-icon-right-triangle-arrow"):this.classes("esri-feature__icon","esri-feature__media-next-icon--rtl","esri-icon-left-triangle-arrow"),
p=a?this._previousClick:this._nextClick;return u.tsx("div",{key:l(a?"previous":"next",b),title:c,tabIndex:0,role:"button",class:d,"data-content-element-index":b,bind:this,onkeydown:p,onclick:p},u.tsx("span",{"aria-hidden":"true",class:e}),u.tsx("span",{"aria-hidden":"true",class:k}),u.tsx("span",{class:"esri-icon-font-fallback-text"},c))};k.prototype._handleMediaKeyup=function(a){var b=a.currentTarget["data-content-element-index"],c=a.keyCode;c===m.LEFT_ARROW&&(a.stopPropagation(),this.previousMedia(b));
c===m.RIGHT_ARROW&&(a.stopPropagation(),this.nextMedia(b))};k.prototype._renderMedia=function(a,b){var c;a=a.mediaInfos;var d=this._getMediaStats(a),e=d.total,k=(c={},c["esri-feature--media-pagination-visible"]=1<d.total,c);c=this._renderMediaStatsItem(h.numImages,d.images,"image");var d=this._renderMediaStatsItem(h.numCharts,d.charts,"chart"),p=this._renderMediaPageButton("previous",b),f=this._renderMediaPageButton("next",b),t=this._activeMediaMap.get(b);isNaN(t)&&(this._activeMediaMap.set(b,0),
t=0);return e?u.tsx("div",{key:l("media-element",b),"data-content-element-index":b,bind:this,onkeyup:this._handleMediaKeyup,class:this.classes("esri-feature__media","esri-feature__content-element",k)},u.tsx("ul",{class:"esri-feature__media-summary"},c,d),u.tsx("div",{key:l("media-element-container",b),class:"esri-feature__media-container"},p,this._renderMediaInfo(a[t],b),f)):null};k.prototype._renderLastEditInfo=function(){var a=this.viewModel.lastEditInfo;if(!a)return null;var b=a.user,a=f.substitute({date:a.date,
user:b},"edit"===a.type?b?h.lastEditedByUser:h.lastEdited:b?h.lastCreatedByUser:h.lastCreated);return u.tsx("div",{key:l("edit-info-element"),class:this.classes("esri-feature__last-edited-info","esri-feature__content-element")},a)};k.prototype._renderText=function(a,b){return a.text?u.tsx("div",{key:l("text-element",b),innerHTML:a.text,class:this.classes("esri-feature__text","esri-feature__content-element")}):null};k.prototype._attachToNode=function(a){a.appendChild(this)};k.prototype._getMediaStats=
function(a){var b=0,c=0;a.forEach(function(a){a=a.type;"image"===a?b++:-1!==a.indexOf("chart")&&c++});return{total:c+b,images:b,charts:c}};k.prototype._setContentElementMedia=function(a,b){this._clearMediaRefreshTimer(a);var c=this.viewModel.content;(c=(c=c&&c[a])&&c.mediaInfos)&&c.length&&(this._activeMediaMap.set(a,(b+c.length)%c.length),this._setupMediaRefreshTimer(a),this.scheduleRender())};k.prototype._pageContentElementMedia=function(a,b){b="previous"===b?-1:1;b=this._activeMediaMap.get(a)+
b;this._setContentElementMedia(a,b)};k.prototype._previousClick=function(a){this.previousMedia(a.currentTarget["data-content-element-index"])};k.prototype._nextClick=function(a){this.nextMedia(a.currentTarget["data-content-element-index"])};d([e.aliasOf("viewModel.contentEnabled")],k.prototype,"contentEnabled",void 0);d([e.aliasOf("viewModel.graphic")],k.prototype,"graphic",void 0);d([e.aliasOf("viewModel.title")],k.prototype,"title",void 0);d([e.aliasOf("viewModel.view")],k.prototype,"view",void 0);
d([e.property({type:a}),u.renderable(["viewModel.waitingForContent","viewModel.content","viewModel.lastEditInfo"])],k.prototype,"viewModel",void 0);d([u.accessibleHandler()],k.prototype,"_previousClick",null);d([u.accessibleHandler()],k.prototype,"_nextClick",null);return k=d([e.subclass("esri.widgets.Feature")],k)}(e.declared(r))})},"esri/widgets/Feature/FeatureViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/assignHelper dojo/i18n!dojo/cldr/nls/number ../../Graphic ../../core/date ../../core/Error ../../core/Handles ../../core/lang ../../core/Logger ../../core/promiseUtils ../../core/throttle ../../core/watchUtils ../../core/accessorSupport/decorators ../../support/arcadeUtils ../../support/ContentElement/Text ../../support/ContentElement/Media/Chart/Series ../../support/FieldInfo/Format ../../tasks/support/AttachmentQuery ./support/featureUtils ./support/RelatedFeatures ../support/widget".split(" "),
function(q,g,n,d,h,m,f,b,c,e,r,a,t,p,u,l,k,w,v,C,A,x,z,y){function B(a,b){return a&&"feature"===a.type?a.getField(b):null}function D(a){return a.replace(/[\u00A0-\u99999<>\&]/gim,function(a){return"\x26#"+a.charCodeAt(0)+";"})}var L=a.getLogger("esri.widgets.FeatureViewModel"),N=/^\s*expression\//i,F=new RegExp(""+m.group,"g"),H=new c("cancelled-query","cancelled feature query"),I=b.getFormat("short-date-short-time"),G="DateFormat"+I;return function(a){function c(b){var c=a.call(this)||this;c._handles=
new e;c._featurePromise=void 0;c._layerDateFields=null;c._expressionAttributes=null;c._graphicChangedThrottled=p.throttle(c._graphicChanged,1,c);c._effectivePopupTemplate=null;c.content=null;c.contentEnabled=!0;c.formattedAttributes=null;c.graphic=null;c.lastEditInfo=null;c.title="";c.view=null;c._handles.add(u.watch(c,"graphic graphic.sourceLayer.popupTemplate.title graphic.sourceLayer.popupTemplate.content graphic.sourceLayer.popupTemplate.fieldInfos graphic.sourceLayer.popupTemplate.lastEditInfoEnabled graphic.popupTemplate.title graphic.popupTemplate.content graphic.popupTemplate.fieldInfos graphic.popupTemplate.lastEditInfoEnabled contentEnabled".split(" "),
function(){return c._graphicChangedThrottled()}));return c}n(c,a);c.prototype.destroy=function(){this._clear();this._cancelFeatureQuery();this._handles.destroy();this._expressionAttributes=this._layerDateFields=this.graphic=this.view=this._handles=null};Object.defineProperty(c.prototype,"waitingForContent",{get:function(){return!!this._featurePromise},enumerable:!0,configurable:!0});c.prototype._clear=function(){this._set("title","");this._set("content",null);this._set("formattedAttributes",null)};
c.prototype._graphicChanged=function(){var a=this;this._cancelFeatureQuery();this._clear();var b=this.graphic;if(b){this._layerDateFields=(b=x.getSourceLayer(b))?this._getDateFields(b):[];var c=!1,b=this._queryFeature().catch(function(a){a!==H&&L.error("error","error loading template",a)}).then(function(){c=!0;a._featurePromise=null;a.notifyChange("waitingForContent")});c||(this._featurePromise=b,this.notifyChange("waitingForContent"))}};c.prototype._cancelFeatureQuery=function(){var a=this._featurePromise;
a&&"function"===typeof a.cancel&&a.cancel(H);this._featurePromise=null;this.notifyChange("waitingForContent")};c.prototype._compileContent=function(a,b){var c=this;if(a&&(a.nodeName||a&&y.isWidgetBase(a)||y.isWidget(a)))return a;if("string"===typeof a)return this._compileText(new w({text:a})).text;if(Array.isArray(a))return a.map(function(a,d){d=(d=b&&b[d])&&d.value;if("attachments"===a.type)return c._compileAttachments(a,d);if("fields"===a.type)return c._compileFields(a);if("media"===a.type)return c._compileMedia(a);
if("text"===a.type)return c._compileText(a)});a&&L.warn("invalid content type.")};c.prototype._compileFields=function(a){var b=this,c=this._effectivePopupTemplate;a=r.clone(a);var d=c&&c.expressionInfos,c=a.fieldInfos?void 0:c&&c.fieldInfos,c=a.fieldInfos||r.clone(c),e=[];c&&c.forEach(function(a){var c=a.fieldName.toLowerCase();if(!a.hasOwnProperty("visible")||a.visible)c=b._isExpressionField(c)?b._getExpressionInfo(d,c):null,a.label=c?c.title:a.label,e.push(a)});a.fieldInfos=e;return a};c.prototype._setImageValue=
function(a){var b=a.value,c=a.formattedAttributes;a=a.layer;var d=b.linkURL,e=b.sourceURL;e&&(e=this._fixTokens(e,a),b.sourceURL=this._substituteAttributes(c,e));d&&(a=this._fixTokens(d,a),b.linkURL=this._substituteAttributes(c,a))};c.prototype._compileMedia=function(a){var b=this,c=this._expressionAttributes,d=this._layerDateFields,e=this.graphic;a=r.clone(a);var l=a.mediaInfos,k=h({},e.attributes,c),p=x.getSourceLayer(e),f=this.formattedAttributes.global,t={dateFormat:{properties:d,formatter:G}};
a.mediaInfos=l&&l.map(function(a){if(a=r.clone(a)){var c=a.title?b._processFieldsInLinks(a.title,k):"",d=a.caption?b._processFieldsInLinks(a.caption,k):"";a.title=c?b._substituteAttributes(f,c,t):"";a.caption=d?b._substituteAttributes(f,d,t):"";if("image"===a.type)return c=a.value,b._setImageValue({value:c,formattedAttributes:f,layer:p}),a.value.sourceURL?a:void 0;if("pie-chart"===a.type||"line-chart"===a.type||"column-chart"===a.type||"bar-chart"===a.type)return c=a.value,b._setChartValue({value:c,
attributes:k,formattedAttributes:f,layer:p}),a}}).filter(Boolean);return a};c.prototype._substituteAttributes=function(a,b,c){return(""+this._removeEmptyHref(r.substitute(a,b,c))).trim()};c.prototype._compileText=function(a){var b=this._expressionAttributes,c=this._layerDateFields,d=this.graphic;(a=r.clone(a))&&a.text&&(d=h({},d.attributes,b),b=this.formattedAttributes.global,c={dateFormat:{properties:c,formatter:G}},d=this._processFieldsInLinks(a.text,d),a.text=this._substituteAttributes(b,d,c));
return a};c.prototype._formatEditInfo=function(a,b){var c=a.creatorField,d=a.creationDateField,e=a.editorField;if(b){a=b[a.editDateField];if("number"===typeof a)return b=b[e],c=r.substitute({myKey:a},"{myKey:"+G+"}"),{type:"edit",date:c,user:b};d=b[d];if("number"===typeof d)return b=b[c],c=r.substitute({myKey:d},"{myKey:"+G+"}"),{type:"create",date:c,user:b}}};c.prototype._compileLastEditInfo=function(){var a=this._effectivePopupTemplate,b=this.graphic;if(a){var a=a.lastEditInfoEnabled,c=b.get("sourceLayer.editFieldsInfo");
if(a&&c)return this._formatEditInfo(c,b.attributes)}};c.prototype._compileTitle=function(){var a=this._effectivePopupTemplate,b=this._layerDateFields,c=this.graphic,a=a&&a.title,d=h({},c.attributes,this._expressionAttributes),b={dateFormat:{properties:b,formatter:G}},e=this.formattedAttributes.global;return"function"===typeof a?a.call(null,{graphic:c}):"string"===typeof a&&a?(c=this._processFieldsInLinks(a,d),this._substituteAttributes(e,c,b)):""};c.prototype._getExpressionInfo=function(a,b){if(this._isExpressionField(b)){var c=
b.replace(N,"").toLowerCase(),d;a.some(function(a){if(a.name.toLowerCase()===c)return d=a,!0});return d}};c.prototype._fixTokens=function(a,b){return a.replace(/(\{([^\{\r\n]+)\})/g,function(a,c,d){return(a=B(b,d))?"{"+a.name+"}":c})};c.prototype._encodeAttributes=function(a){var b=a?r.clone(a):{};Object.keys(b).forEach(function(a){var c=b[a];"string"===typeof c&&(c=encodeURIComponent(c).replace(/\'/g,"\x26apos;"),b[a]=c)});return b};c.prototype._formatAttributesToFieldInfos=function(a,b,c){var d=
this,e=r.clone(this._layerDateFields);a.forEach(function(l){var k=d._getFixedFieldName(l.fieldName,b);l.fieldName=k;c[k]=d._formatValue(c[k],{fieldInfos:a,fieldName:k,layer:b});e&&l.format&&l.format.dateFormat&&(l=e.indexOf(k),-1<l&&e.splice(l,1))})};c.prototype._getArcadeViewingMode=function(a){return a&&"local"===a.viewingMode?"localScene":"globalScene"};c.prototype._getViewInfo=function(){var a=this.view;if(a){var b="3d"===a.type?this._getArcadeViewingMode(a):"map";return k.getViewInfo({viewingMode:b,
scale:a.scale,spatialReference:a.spatialReference})}};c.prototype._formatAttributes=function(a){var b=this,c=this._expressionAttributes,d=this.graphic,e=d.attributes,d=x.getSourceLayer(d),e=e?r.clone(e):{},l=h({},e,c);this.addRelatedFeatureAttributes(l);a&&this._formatAttributesToFieldInfos(a,d,l);Object.keys(l).forEach(function(a){var c=l[a];null!=c&&(l[a]=b._getDomainName(a,c)||b._getTypeName(a)||k.applyTextFormattingHTML(c))});return l};c.prototype._formatValue=function(a,c){var d={dateFormat:{properties:this._layerDateFields,
formatter:G}},e=c.fieldName,l=this._getFieldInfo(c.fieldInfos,e),k=r.clone(l),l=c.preventPlacesFormatting;(c=B(c.layer,e))&&"date"===c.type&&(c=k.format||new C,c.dateFormat=c.dateFormat||"short-date-short-time",k.format=c);e=k&&k.format;if(null==a||!k||null==e)return a;var p=[];c=(k=!e.dateFormat&&(e.hasOwnProperty("places")||e.hasOwnProperty("digitSeparator")))&&e.hasOwnProperty("digitSeparator")?e.digitSeparator:!0;l=k&&null!=e.places&&(!l||0<e.places);k&&l&&p.push("places: "+Number(e.places));
l=k?l?"NumberFormat("+p.join(",")+")":"NumberFormat":e.dateFormat?"DateFormat"+(b.getFormat(e.dateFormat)||I):void 0;if(!l)return a;a=r.substitute({myKey:a},"{myKey:"+l+"}",d)||"";return k&&!c&&m.group?a.replace(F,""):a};c.prototype._getDomainName=function(a,b){if(this.isRelatedField(a))return null;var c=this.graphic,d=x.getSourceLayer(c);return d&&"feature"===d.type?(a=d.getFieldDomain(a,{feature:c}))&&"coded-value"===a.type?a.getName(b):null:null};c.prototype._getFieldInfo=function(a,b){if(a&&a.length&&
b){var c=b.toLowerCase(),d=void 0;a.some(function(a){if(a.fieldName&&a.fieldName.toLowerCase()===c)return d=a,!0});return d}};c.prototype._getTypeName=function(a){if(this.isRelatedField(a))return null;var b=this.graphic,c=x.getSourceLayer(b);return c&&"feature"===c.type&&a===c.typeIdField?(a=c.getFeatureType(b))?a.name:null:null};c.prototype._removeEmptyHref=function(a){return a.replace(/href=(""|'')/gi,"")};c.prototype._processFieldsInLinks=function(a,b){var c=this.get("graphic.layer");a=this._fixTokens(a,
c);var d=this._encodeAttributes(b),c=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi;return a?a.replace(c,function(a,c,e){c=(""+(c||e)).trim();return r.substitute(c&&"{"===c[0]?b:d,a)}):a};c.prototype._compileAttachments=function(a,b){a=r.clone(a);if(!b||b&&0===b.length)return a;a.attachmentInfos=b;return a};c.prototype._queryAttachments=function(){var a=this.graphic,b=x.getSourceLayer(a);if(!b)return t.resolve([]);if((b="scene"===b.type&&b.associatedLayer?b.associatedLayer:b)&&"feature"===b.type){var c=
b.objectIdField,d=(a=a.attributes)&&a[c],a=new A({objectIds:[d]});return b.queryAttachments(a).then(function(a){return a[d]||[]})}return t.resolve([])};c.prototype._queryContentElements=function(a){var b=this;if(!Array.isArray(a))return t.resolve();var c={};a.forEach(function(a,d){"attachments"===a.type&&(a=b._queryAttachments())&&(c[d]=a)});return Object.keys(c).length?t.eachAlways(c):t.resolve()};c.prototype._getContent=function(){var a=this._effectivePopupTemplate,b=this.graphic;if(!this.contentEnabled||
!b)return t.resolve();a=a&&a.content;b="function"===typeof a?a.call(null,{graphic:b}):a;return t.isThenable(b)?b:t.resolve(b)};c.prototype._enableGeometryOperations=function(){var a=this._effectivePopupTemplate;return a&&k.hasGeometryOperations(a)?k.enableGeometryOperations():t.resolve(!1)};c.prototype._queryFeature=function(){var a=this,b=this.graphic;this._effectivePopupTemplate=b&&b.getEffectivePopupTemplate();return this._enableGeometryOperations().then(function(){return a._getContent().then(function(b){return a._checkForRelatedFeatures(b).then(function(){a._expressionAttributes=
a._createFormattedExpressions();a._set("formattedAttributes",a._createFormattedAttributes(b));a._set("title",a._compileTitle());return a._queryContentElements(b).then(function(c){var d=a._compileLastEditInfo();a._set("lastEditInfo",d||null);c=a._compileContent(b,c);a._set("content",c||null);return c})})})})};c.prototype._isExpressionField=function(a){return N.test(a)};c.prototype._createCompiledExpressionDictionary=function(a){var b=new Map;if(!a)return b;a.forEach(function(a){return b.set(a.name,
k.createFunction(a.expression))});return b};c.prototype._getDateFields=function(a){return(a=a.fields)?a.filter(function(a){return"date"===a.type}).map(function(a){return a.name}):[]};c.prototype._formatArcadeArray=function(a){return'\x3cul class\x3d"esri-widget__list"\x3e'+a.map(function(a){return"\x3cli\x3e"+("string"===typeof a?D(a):a)+"\x3c/li\x3e"}).join("")+"\x3c/ul\x3e"};c.prototype._formatArcadeDictionary=function(a){return'\x3ctable class\x3d"esri-widget__table"\x3e'+a.keys().map(function(b){var c=
a.field(b),c="string"===typeof c?D(c):c;return"\x3ctr\x3e\x3cth\x3e"+b+"\x3c/th\x3e\x3ctd\x3e"+c+"\x3c/td\x3e\x3c/tr\x3e"}).join("")+"\x3c/table\x3e"};c.prototype._createFormattedExpressions=function(){var a=this,b=this._effectivePopupTemplate,c=this.graphic,b=b&&b.expressionInfos,d=this._createCompiledExpressionDictionary(b),e={};b&&b.forEach(function(b){var l="expression/"+b.name;b=d.get(b.name);var p=a._getViewInfo();b=k.executeFunction(b,k.createExecContext(c,p));e[l]="string"===typeof b?D(b):
Array.isArray(b)?a._formatArcadeArray(b):b&&"esri.arcade.Dictionary"===b.declaredClass?a._formatArcadeDictionary(b):b});return e};c.prototype._createFormattedAttributes=function(a){var b=this,c=this._effectivePopupTemplate,d={global:this._formatAttributes(c&&c.fieldInfos),content:[]};Array.isArray(a)&&a.forEach(function(a,c){"fields"===a.type&&a.fieldInfos&&(d.content[c]=b._formatAttributes(a.fieldInfos))});return d};c.prototype._getAllFieldInfos=function(a){var b=this._effectivePopupTemplate,c=[];
(b=b&&b.fieldInfos)&&c.push.apply(c,b);if(!a||!Array.isArray(a))return c;a.forEach(function(a){"fields"===a.type&&c.push.apply(c,a&&a.fieldInfos)});return c};c.prototype._checkForRelatedFeatures=function(a){var b=this.graphic;a=this._getAllFieldInfos(a);return this.queryRelatedInfos(b,a)};c.prototype._getChartOption=function(a){var b=a.value,c=a.attributes,d=a.formattedAttributes,e=a.fieldName,l=a.relatedFieldName,k=a.fieldInfos,p=a.index;a=x.getSourceLayer(this.graphic);var f=b.normalizeField,b=
b.tooltipField,f=f?this.isRelatedField(f)?c[this.getRelatedFieldInfo(f).fieldName]:c[f]:null,t=l&&void 0!==c[l]?c[l]:void 0!==c[e]?c[e]:d[e],t="string"===typeof t&&m.group?parseFloat(t.replace(F,"")):t,t=void 0===t?null:t&&f?t/f:t,p=new v({x:p,y:t});if(this.isRelatedField(e))return d=this.getRelatedFieldInfo(e),e=(e=this.getRelatedFieldInfo(b))?e.fieldName:null,k=this._formatValue(t,{fieldInfos:k,fieldName:l,layer:a,preventPlacesFormatting:!!f}),l=d?d.label||d.fieldName:l,p.tooltip=(e&&void 0!==c[e]?
c[e]:l)+": "+k,p;c=this._getFieldInfo(k,e);l=this._getFixedFieldName(e,a);c=c?c.label||c.fieldName:e;p.tooltip=(b&&void 0!==d[b]?d[b]:c)+": "+d[l];return p};c.prototype._getFixedFieldName=function(a,b){return(b=B(b,a))?b.name:a};c.prototype._getFixedFieldNames=function(a,b){var c=this;return a&&a.map(function(a){return c._getFixedFieldName(a,b)})};c.prototype._setChartValue=function(a){var b=this,c=a.value,d=a.attributes,e=a.formattedAttributes;a=a.layer;var l=this._effectivePopupTemplate,k=this.relatedInfoCount,
p=c.fields,f=c.normalizeField;c.fields=this._getFixedFieldNames(p,a);f&&(c.normalizeField=this._getFixedFieldName(f,a));if(p.some(function(a){return!!(null!=e[a]||b.isRelatedField(a)&&k)})){var t=l&&l.fieldInfos;p.forEach(function(a,l){b.isRelatedField(a)?c.series=c.series.concat(b._getRelatedChartInfos({fieldInfos:t,fieldName:a,formattedAttributes:e,value:c})):(a=b._getChartOption({value:c,index:l,attributes:d,formattedAttributes:e,fieldName:a,fieldInfos:t}),c.series.push(a))})}};c.prototype._getRelatedChartInfos=
function(a){var b=this,c=a.fieldInfos,d=a.fieldName,e=a.formattedAttributes,l=a.value,k=[];a=this.getRelatedFieldInfo(d);var p=a.fieldName,f=this.getRelatedInfo(a.layerId);if(!f)return k;a=f.relatedFeatures;f=f.relation;if(!f||!a)return k;f=f.cardinality;a.forEach(function(a,f){var t=a.attributes;t&&Object.keys(t).forEach(function(a){a===p&&k.push(b._getChartOption({value:l,index:f,attributes:t,formattedAttributes:e,fieldName:d,relatedFieldName:a,fieldInfos:c}))})});return"one-to-many"===f||"many-to-many"===
f?k:[k[0]]};d([l.property({readOnly:!0})],c.prototype,"content",void 0);d([l.property()],c.prototype,"contentEnabled",void 0);d([l.property({readOnly:!0})],c.prototype,"formattedAttributes",void 0);d([l.property({type:f})],c.prototype,"graphic",void 0);d([l.property({readOnly:!0})],c.prototype,"lastEditInfo",void 0);d([l.property({readOnly:!0})],c.prototype,"title",void 0);d([l.property()],c.prototype,"view",void 0);d([l.property({readOnly:!0})],c.prototype,"waitingForContent",null);return c=d([l.subclass("esri.widgets.FeatureViewModel")],
c)}(l.declared(z))})},"esri/core/throttle":function(){define(["require","exports"],function(q,g){function n(d,h,m,f){var b=null,c=1E3;"number"===typeof h?(c=h,f=m):(b=h,c=m);var e=0,r,a=function(){e=0;d.apply(f,r)};h=function(){for(var d=[],p=0;p<arguments.length;p++)d[p]=arguments[p];b&&b.apply(f,d);r=d;c?e||(e=setTimeout(a,c)):a()};h.remove=function(){e&&(clearTimeout(e),e=0)};h.forceUpdate=function(){e&&(clearTimeout(e),a())};h.hasPendingUpdates=function(){return!!e};return h}Object.defineProperty(g,
"__esModule",{value:!0});g.throttle=n;g.default=n})},"esri/widgets/Feature/support/featureUtils":function(){define(["require","exports"],function(q,g){Object.defineProperty(g,"__esModule",{value:!0});g.getSourceLayer=function(n){if(n)return n.get("sourceLayer")||n.get("layer")}})},"esri/widgets/Feature/support/RelatedFeatures":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../request ../../../core/Accessor ../../../core/Error ../../../core/Logger ../../../core/promiseUtils ../../../core/accessorSupport/decorators ../../../tasks/QueryTask ../../../tasks/support/Query ../../../tasks/support/StatisticDefinition ./featureUtils".split(" "),
function(q,g,n,d,h,m,f,b,c,e,r,a,t,p){var u=new Map,l=b.getLogger("esri.widgets.Popup.support.RelatedFeatures");return function(b){function k(a){a=b.call(this)||this;a.relatedInfoCount=null;a.relatedInfos=new Map;return a}n(k,b);k.prototype.destroy=function(){this.relatedInfos.clear()};k.prototype.addRelatedFeatureAttributes=function(a){var b=this;this.relatedInfos.forEach(function(c){return b._addRelatedFeatureAttribute(a,c)})};k.prototype.getRelatedFieldInfo=function(a){if(-1===a.indexOf("relationships/"))return null;
a=a.split("/").slice(1);return{layerId:a[0],fieldName:a[1]}};k.prototype.getRelatedInfo=function(a){return this.relatedInfos.get(a.toString())};k.prototype.isRelatedField=function(a){void 0===a&&(a="");return a?-1!==a.indexOf("relationships/"):!1};k.prototype.queryRelatedInfos=function(a,b){var d=this;this.relatedInfos.clear();var e=p.getSourceLayer(a);if(!e)return c.resolve();var l=b.filter(function(a){return a&&d.isRelatedField(a.fieldName)});if(!l||!l.length)return c.resolve();this._createRelatedInfos(b,
e);return this._queryLayerInfos(e).then(function(b){d._updateRelatedInfoLayerInfos(b);return d._queryRelatedFeatureMap(a).then(function(a){Object.keys(a).forEach(function(b){d._setRelatedFeatures(a[b],b.toString())});return a})})};k.prototype._addRelatedFeatureAttribute=function(a,b){var c=this;a&&b&&(b.relatedFeatures&&b.relatedFeatures&&b.relatedFeatures.forEach(function(d){return c._addAttributesFromFeature(a,d,b)}),b.relatedStatsFeatures&&b.relatedStatsFeatures&&b.relatedStatsFeatures.forEach(function(d){return c._addAttributesFromFeature(a,
d,b)}))};k.prototype._updateRelatedInfoLayerInfo=function(a,b){if(a=a.value)this.getRelatedInfo(b).layerInfo=a.data};k.prototype._updateRelatedInfoLayerInfos=function(a){var b=this;Object.keys(a).forEach(function(c){return b._updateRelatedInfoLayerInfo(a[c],c.toString())})};k.prototype._addAttributesFromFeature=function(a,b,c){var d=this;a&&b&&c&&Object.keys(b.attributes).forEach(function(e){var l=d._relatedFieldInfoToString({layerId:c.relation.id.toString(),fieldName:e});a[l]=b.attributes[e]})};
k.prototype._relatedFieldInfoToString=function(a){return a?"relationships/"+a.layerId+"/"+a.fieldName:""};k.prototype._createRelatedInfoForFieldInfo=function(a,b){var c=this.getRelatedFieldInfo(a.fieldName);if(c){var d=c.layerId,c=c.fieldName;d&&(b=this.getRelatedInfo(d)||this._createRelatedInfo(d,b))&&(b.relatedFields.push(c),a.statisticType&&(a=new t({statisticType:a.statisticType,onStatisticField:c,outStatisticFieldName:c}),b.outStatistics.push(a)))}};k.prototype._createRelatedInfos=function(a,
b){var c=this;a.forEach(function(a){return c._createRelatedInfoForFieldInfo(a,b)})};k.prototype._queryRelatedFeatureMap=function(a){var b=this,d={};this.relatedInfos.forEach(function(c,e){c.layerInfo&&(d[e]=b._queryRelatedLayerFeatures(a,c))});return c.eachAlways(d)};k.prototype._queryLayerInfos=function(a){var b=this,d={};this.relatedInfos.forEach(function(e,k){e=e.relation;if(!e)return k=new f("relation-required","A relation is required on a layer to retrieve related records."),l.error(k),c.reject(k);
e=e.relatedTableId;if(!e)return k=new f("A related table ID is required on a layer to retrieve related records."),l.error(k),c.reject(k);e=a.url+"/"+e;var p=u.get(e),t=p?p:b._queryLayerInfo(e);p||u.set(e,t);d[k]=t});return c.eachAlways(d)};k.prototype._queryLayerInfo=function(a){return h(a,{query:{f:"json"}})};k.prototype._queryRelatedLayerFeatures=function(b,d){var e=p.getSourceLayer(b).layerId.toString(),l=d.layerInfo,k=d.queryTask,f=d.relation;if(e=this._getDestinationRelation(l,e)){var f=f.keyField,
t=e.keyField,e="string"===this._getDestinationFieldType(l,e)?t+"\x3d'"+b.attributes[f]+"'":t+"\x3d"+b.attributes[f];b=k.execute(new a({where:e,outFields:d.relatedFields}));d=d.outStatistics&&0<d.outStatistics.length&&l.supportsStatistics?k.execute(new a({where:e,outFields:d.relatedFields,outStatistics:d.outStatistics})):null;return c.eachAlways({features:b,statsFeatures:d?d:c.resolve()})}return c.resolve()};k.prototype._setRelatedFeatures=function(a,b){if(b=this.getRelatedInfo(b)){var c=a.value;c&&
(a=c.features,c=c.statsFeatures,a=a&&a.value,b.relatedFeatures=a?a.features:[],a=c&&c.value,b.relatedStatsFeatures=a?a.features:[])}};k.prototype._getRelation=function(a,b){if("feature"!==b.type)return null;var c=null;b.relationships.some(function(b){if(b.id===parseInt(a,10))return c=b,!0});return c};k.prototype._createRelatedInfo=function(a,b){var c=this._getRelation(a,b);if(c){b=b.url+"/"+c.relatedTableId;var d=new r({url:b}),c={url:b,queryTask:d,relation:c,relatedFields:[],outStatistics:[]};this.relatedInfos.set(a,
c);return c}};k.prototype._getDestinationRelation=function(a,b){var c;a&&a.relationships&&a.relationships.some(function(a){if(""+a.relatedTableId===b)return c=a,!0});return c};k.prototype._getDestinationFieldType=function(a,b){var c=void 0;a.fields.some(function(a){if(a.name===b.keyField)return c=-1!==["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"].indexOf(a.type)?"number":"string",!0});return c};d([e.aliasOf("relatedInfos.size")],k.prototype,"relatedInfoCount",
void 0);d([e.property()],k.prototype,"relatedInfos",void 0);return k=d([e.subclass("esri.widgets.Popup.support.RelatedFeatures")],k)}(e.declared(m))})},"esri/widgets/Feature/support/attachmentUtils":function(){define(["require","exports"],function(q,g){Object.defineProperty(g,"__esModule",{value:!0});var n=q.toUrl("../../../themes/base/images/files/");g.isSupportedImage=function(d){d=d.toLowerCase();return"image/bmp"===d||"image/emf"===d||"image/exif"===d||"image/gif"===d||"image/x-icon"===d||"image/jpeg"===
d||"image/png"===d||"image/tiff"===d||"image/x-wmf"===d};g.getIconPath=function(d){return d?"text/plain"===d?n+"text-32.svg":"application/pdf"===d?n+"pdf-32.svg":"text/csv"===d?n+"csv-32.svg":"application/gpx+xml"===d?n+"gpx-32.svg":"application/x-dwf"===d?n+"cad-32.svg":"application/postscript"===d||"application/json"===d||"text/xml"===d||"model/vrml"===d?n+"code-32.svg":"application/x-zip-compressed"===d||"application/x-7z-compressed"===d||"application/x-gzip"===d||"application/x-tar"===d||"application/x-gtar"===
d||"application/x-bzip2"===d||"application/gzip"===d||"application/x-compress"===d||"application/x-apple-diskimage"===d||"application/x-rar-compressed"===d||"application/zip"===d?n+"zip-32.svg":-1!==d.indexOf("image/")?n+"image-32.svg":-1!==d.indexOf("audio/")?n+"sound-32.svg":-1!==d.indexOf("video/")?n+"video-32.svg":-1!==d.indexOf("msexcel")||-1!==d.indexOf("ms-excel")||-1!==d.indexOf("spreadsheetml")?n+"excel-32.svg":-1!==d.indexOf("msword")||-1!==d.indexOf("ms-word")||-1!==d.indexOf("wordprocessingml")?
n+"word-32.svg":-1!==d.indexOf("powerpoint")||-1!==d.indexOf("presentationml")?n+"report-32.svg":n+"generic-32.svg":n+"generic-32.svg"}})},"esri/widgets/support/uriUtils":function(){define(["require","exports","dojo/i18n!./nls/uriUtils","../../core/lang"],function(q,g,n,d){function h(d){var b=null;m.some(function(c){c.pattern.test(d)&&(b=c);return!!b});return b}Object.defineProperty(g,"__esModule",{value:!0});var m=[{id:"http",pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:n.view},
{id:"tel",pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{id:"mailto",pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{id:"arcgis-appstudio-player",pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:n.openInApp,appName:"App Studio Player"},{id:"arcgis-collector",pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:n.openInApp,appName:"Collector"},{id:"arcgis-explorer",pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:n.openInApp,appName:"Explorer"},{id:"arcgis-navigator",
pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:n.openInApp,appName:"Navigator"},{id:"arcgis-survey123",pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:n.openInApp,appName:"Survey123"},{id:"arcgis-trek2there",pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:n.openInApp,appName:"Trek2There"},{id:"arcgis-workforce",pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:n.openInApp,appName:n.workforce},{id:"iform",pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:n.openInApp,
appName:"iForm"},{id:"flow",pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:n.openInApp,appName:"FlowFinity"},{id:"lfmobile",pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:n.openInApp,appName:"Laserfische"},{id:"mspbi",pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:n.openInApp,appName:"Microsoft Power Bi"}];g.autoLink=function(f){if("string"!==typeof f||!f)return f;var b=h(f);if(!b)return f;var c=f.match(b.pattern),c=d.substitute({appName:b.appName,hierPart:c&&c[2]},b.label);return f.replace(b.pattern,
"\x3ca "+(b.target?'target\x3d"'+b.target+'"':"")+'" href\x3d"$1"\x3e'+c+"\x3c/a\x3e")}})},"esri/widgets/Spinner":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/promiseUtils ../core/watchUtils ../core/accessorSupport/decorators ./Widget ./support/AnchorElementViewModel ./support/widget".split(" "),function(q,g,n,d,h,m,f,b,c,e){return function(b){function a(a){a=b.call(this)||this;a._animationDelay=500;a._animationPromise=null;a.location=
null;a.view=null;a.visible=!1;a.viewModel=new c;return a}n(a,b);a.prototype.postInitialize=function(){var a=this;this.own([m.watch(this,"visible",function(b){return a._visibleChange(b)})])};a.prototype.destroy=function(){this._cancelAnimationPromise()};a.prototype.show=function(a){var b=this,c=a.location;a=a.promise;c&&(this.viewModel.location=c);this.visible=!0;c=function(){return b.hide()};a&&a.catch(function(){}).then(c)};a.prototype.hide=function(){this.visible=!1};a.prototype.render=function(){var a,
b=this.visible,c=!!this.viewModel.screenLocation,b=(a={},a["esri-spinner--start"]=b&&c,a["esri-spinner--finish"]=!b&&c,a);a=this._getPositionStyles();return e.tsx("div",{class:this.classes("esri-spinner",b),styles:a})};a.prototype._cancelAnimationPromise=function(){var a=this._animationPromise;a&&a.cancel();this._animationPromise=null};a.prototype._visibleChange=function(a){var b=this;a?this.viewModel.screenLocationEnabled=!0:(this._cancelAnimationPromise(),this._animationPromise=h.after(this._animationDelay).then(function(){b.viewModel.screenLocationEnabled=
!1;b._animationPromise=null}))};a.prototype._getPositionStyles=function(){var a=this.viewModel,b=a.screenLocation,a=a.view;if(!a||!b)return{};a=a.padding;return{left:b.x-a.left+"px",top:b.y-a.top+"px"}};d([f.aliasOf("viewModel.location")],a.prototype,"location",void 0);d([f.aliasOf("viewModel.view")],a.prototype,"view",void 0);d([f.property(),e.renderable()],a.prototype,"visible",void 0);d([f.property({type:c}),e.renderable(["viewModel.screenLocation","viewModel.screenLocationEnabled"])],a.prototype,
"viewModel",void 0);return a=d([f.subclass("esri.widgets.Spinner")],a)}(f.declared(b))})},"esri/widgets/support/AnchorElementViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Evented ../../core/Handles ../../core/watchUtils ../../core/watchUtils ../../core/accessorSupport/decorators".split(" "),function(q,g,n,d,h,m,f,b,c,e){return function(r){function a(a){var b=r.call(this)||this;b._anchorHandles=
new f;b.location=null;b.screenLocation=null;b.screenLocationEnabled=!1;b.view=null;b._anchorHandles.add([c.watch(b,["screenLocationEnabled","location","view.size","view.stationary"],function(){return b._updateScreenPointAndHandle()}),c.watch(b,["view","view.ready"],function(){return b._wireUpView()})]);return b}n(a,r);a.prototype.destroy=function(){this.view=null;this._anchorHandles&&this._anchorHandles.destroy();this._viewpointHandle=this._anchorHandles=null};a.prototype._wireUpView=function(){var a=
this;this._anchorHandles.remove("view");this._viewpointHandle=null;if(this.get("view.ready")){this._setScreenLocation();var c=this.view,c=b.pausable(c,"3d"===c.type?"camera":"viewpoint",function(){return a._viewpointChange()});this._anchorHandles.add(c,"view");this._viewpointHandle=c;this._toggleWatchingViewpoint()}};a.prototype._viewpointChange=function(){this._setScreenLocation();this.emit("view-change")};a.prototype._updateScreenPointAndHandle=function(){this._setScreenLocation();this._toggleWatchingViewpoint()};
a.prototype._toggleWatchingViewpoint=function(){var a=this._viewpointHandle,b=this.screenLocationEnabled;a&&(this.location&&b?a.resume():a.pause())};a.prototype._setScreenLocation=function(){var a=this.location,b=this.view,c=this.screenLocationEnabled,d=this.get("view.ready"),a=c&&a&&d?b.toScreen(a):null;this._set("screenLocation",a)};d([e.property()],a.prototype,"location",void 0);d([e.property({readOnly:!0})],a.prototype,"screenLocation",void 0);d([e.property()],a.prototype,"screenLocationEnabled",
void 0);d([e.property()],a.prototype,"view",void 0);return a=d([e.subclass("esri.widgets.support.AnchorElementViewModel")],a)}(e.declared(h,m))})},"esri/widgets/Popup/PopupViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/assignHelper ../../core/Collection ../../core/Error ../../core/Handles ../../core/Logger ../../core/promiseUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../../geometry/Point ../../geometry/support/webMercatorUtils ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionToggle ../../views/support/layerViewUtils ./actions ../support/AnchorElementViewModel ../support/GoTo".split(" "),
function(q,g,n,d,h,m,f,b,c,e,r,a,t,p,u,l,k,w,v,C,A){var x=m.ofType({key:"type",defaultKeyValue:"button",base:u,typeMap:{button:l,toggle:k}}),z=new x([v.zoomToFeature.clone()]),y=c.getLogger("esri.widgets.Popup.PopupViewModel");return function(c){function l(a){a=c.call(this)||this;a._handles=new b;a._pendingPromises=new Set;a._zoomToLocation=null;a._fetchingFeatures=null;a.actions=z;a.autoCloseEnabled=!1;a.autoOpenEnabled=!0;a.content=null;a.highlightEnabled=!0;a.title=null;a.updateLocationEnabled=
!1;a.view=null;a.visible=!1;a.zoomFactor=4;return a}n(l,c);l.prototype.initialize=function(){var a=this;this._handles.add([r.init(this,"autoOpenEnabled",this._autoOpenEnabledChange),this.on("view-change",this._autoClose),r.watch(this,["highlightEnabled","selectedFeature","visible","view"],this._highlightFeature),r.watch(this,"view.animation.state",function(b){a._zoomToLocation||(v.zoomToFeature.disabled="waiting-for-target"===b)}),this.on("trigger-action",function(b){return v.triggerAction({event:b,
view:a.view})})])};l.prototype.destroy=function(){this._cancelFetchingFeatures();this._handles.destroy();this._handles=null;this._pendingPromises.clear();this.view=null};Object.defineProperty(l.prototype,"allActions",{get:function(){var a=this._get("allActions")||new x;a.removeAll();var b=this.selectedFeature&&("function"===typeof this.selectedFeature.getEffectivePopupTemplate&&this.selectedFeature.getEffectivePopupTemplate()||this.selectedFeature.popupTemplate),c=b&&b.actions;(b=b&&b.overwriteActions?
c:this.actions.concat(c))&&b.filter(Boolean).forEach(function(b){return a.add(b)});return a},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"featureCount",{get:function(){return this.features.length},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"features",{get:function(){return this._get("features")||[]},set:function(a){a=a||[];this._set("features",a);var b=this.pendingPromisesCount,c=this.selectedFeatureIndex,d=this.promiseCount&&a.length;d&&b&&-1===c?this.selectedFeatureIndex=
0:d&&-1!==c||(this.selectedFeatureIndex=a.length?0:-1)},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"location",{get:function(){return this._get("location")||null},set:function(a){var b=this.get("location"),c=this.get("view.spatialReference.isWebMercator");a&&a.get("spatialReference.isWGS84")&&c&&(a=p.geographicToWebMercator(a));this._set("location",a);a!==b&&this._centerAtLocation()},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"pendingPromisesCount",{get:function(){return this._pendingPromises.size},
enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"waitingForResult",{get:function(){return 0<this.pendingPromisesCount&&0===this.featureCount},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"promiseCount",{get:function(){return this.promises.length},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"promises",{get:function(){return this._get("promises")||[]},set:function(a){var b=this,c=this._get("promises");c&&c.forEach(function(a){a&&"function"===
typeof a.cancel&&a.cancel()});this._pendingPromises.clear();this.features=[];Array.isArray(a)&&a.length?(this._set("promises",a),a=a.slice(0),a.forEach(function(a){b._pendingPromises.add(a);a.then(function(c){b._updatePendingPromises(a);b._updateFeatures(c)},function(){return b._updatePendingPromises(a)})})):this._set("promises",[]);this.notifyChange("pendingPromisesCount")},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"selectedFeature",{get:function(){var a=this.location,b=this.selectedFeatureIndex;
if(-1===b)return null;b=this.features[b];if(!b)return null;!this.updateLocationEnabled&&a||!b.geometry||(this.location=this._getPointFromGeometry(b.geometry));return b},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,"selectedFeatureIndex",{get:function(){var a=this._get("selectedFeatureIndex");return"number"===typeof a?a:-1},set:function(a){var b=this.featureCount;a=isNaN(a)||-1>a||!b?-1:(a+b)%b;this._set("selectedFeatureIndex",a)},enumerable:!0,configurable:!0});Object.defineProperty(l.prototype,
"state",{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!0,configurable:!0});l.prototype.centerAtLocation=function(){var a=this.location,b=this.view;return a&&b?this.callGoTo({target:{target:a,scale:b.scale}}):(a=new f("center-at-location:invalid-location-or-view","Cannot center at a location without a location and view.",{location:a,view:b}),y.error(a),e.reject(a))};l.prototype.clear=function(){this.set({promises:[],features:[],content:null,title:null,location:null})};
l.prototype.open=function(a){this.set(h({visible:!1},{updateLocationEnabled:!1,promises:[]},a));this._setVisibleWhenContentExists()};l.prototype.triggerAction=function(a){(a=this.allActions.getItemAt(a))&&this.emit("trigger-action",{action:a})};l.prototype.next=function(){this.selectedFeatureIndex+=1;return this};l.prototype.previous=function(){--this.selectedFeatureIndex;return this};l.prototype.zoomToLocation=function(){var a=this,b=this.location,c=this.selectedFeature,d=this.view,l=this.zoomFactor;
if(!b||!d)return b=new f("zoom-to:invalid-location-or-view","Cannot zoom to location without a location and view.",{location:b,view:d}),y.error(b),e.reject(b);var k="3d"===d.type,d=d.scale/l,l=this.get("selectedFeature.geometry"),k=(k?c:l&&c)||b,p=l||b,t=p&&"point"===p.type&&this._isScreenSize(c),b={target:k,scale:t?d:void 0};v.zoomToFeature.active=!0;v.zoomToFeature.disabled=!0;return this._zoomToLocation=b=this.callGoTo({target:b}).then(function(){t&&(a.location=p);v.zoomToFeature.active=!1;v.zoomToFeature.disabled=
!1;a._zoomToLocation=null}).catch(function(){v.zoomToFeature.active=!1;v.zoomToFeature.disabled=!1;a._zoomToLocation=null})};l.prototype._fetchFeatures=function(a){var b=this.view;return b&&a?b.fetchPopupFeatures(a):(a=new f("fetch-features:invalid-screenPoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:a,view:b}),y.error(a),e.reject(a))};l.prototype._autoOpenEnabledChange=function(){var a=this,b=this._handles,c=this.autoOpenEnabled;b.remove("auto-fetch-features");
c&&(c=r.on(this,"view","click",function(b){"mouse"===b.pointerType&&0!==b.button||a._fetchFeaturesAndOpen(b)}),b.add(c,"auto-fetch-features"))};l.prototype._cancelFetchingFeatures=function(){var a=this._fetchingFeatures;a&&a.cancel();this._fetchingFeatures=null};l.prototype._fetchFeaturesAndOpen=function(a){var b=this,c=a.screenPoint,d=a.mapPoint,l=this.view;this._cancelFetchingFeatures();this._fetchingFeatures=this._fetchFeatures(c).then(function(a){var c=a.promises;b._fetchingFeatures=null;l.popup.open({location:d,
promises:c});return a})};l.prototype._updatePendingPromises=function(a){a&&this._pendingPromises.has(a)&&(this._pendingPromises.delete(a),this.notifyChange("pendingPromisesCount"))};l.prototype._setVisibleWhenContentExists=function(){var a=this,b=this._handles,c=this.promiseCount;b.remove("pendingVisible");c?(c=r.init(this,"pendingPromisesCount",function(c){a.featureCount&&(a.set("visible",!0),b.remove("pendingVisible"));c||b.remove("pendingVisible")}),b.add(c,"pendingVisible")):this.set("visible",
!0)};l.prototype._autoClose=function(){this.autoCloseEnabled&&(this.visible=!1)};l.prototype._isScreenSize=function(a){var b=this.view;if("3d"!==b.type||!a||"esri.Graphic"!==a.declaredClass)return!0;if((b=b.getViewForGraphic(a))&&b.whenGraphicBounds){var c=!1;b.whenGraphicBounds(a,{useViewElevation:!0}).then(function(a){c=!a||!a.boundingBox||a.boundingBox[0]===a.boundingBox[3]&&a.boundingBox[1]===a.boundingBox[4]&&a.boundingBox[2]===a.boundingBox[5]});return c}return!0};l.prototype._getPointFromGeometry=
function(a){return a?"point"===a.type?a:"extent"===a.type?a.center:"polygon"===a.type?a.centroid:"multipoint"===a.type||"polyline"===a.type?a.extent.center:null:null};l.prototype._isLocationOffScreen=function(a){return a?(a=this.view.toScreen(a))?!(0<=a.x&&a.x<=this.view.width&&0<=a.y&&a.y<=this.view.height):!1:!1};l.prototype._centerAtLocation=function(){var a=this.location;this.updateLocationEnabled&&a&&this._isLocationOffScreen(a)&&this.centerAtLocation()};l.prototype._highlightFeature=function(){var a=
this;this._handles.remove("highlight");var b=this.selectedFeature,c=this.highlightEnabled,d=this.view,l=this.visible;if(b&&d&&c&&l){var e=b.layer;e&&d.when().then(function(){d.whenLayerView(e).then(function(c){if(c&&w.hasHighlight(c)){var d=e.objectIdField,l=b.attributes;c=c.highlight(l&&l[d]||b);a._handles.add(c,"highlight")}})})}};l.prototype._updateFeatures=function(a){var b=this.features;a&&a.length&&(b.length?(a=a.filter(function(a){return-1===b.indexOf(a)}),this.features=b.concat(a)):this.features=
a)};d([a.property({type:x})],l.prototype,"actions",void 0);d([a.property({dependsOn:["actions.length","selectedFeature.sourceLayer.popupTemplate.actions.length","selectedFeature.sourceLayer.popupTemplate.overwriteActions","selectedFeature.popupTemplate.actions.length","selectedFeature.popupTemplate.overwriteActions"],readOnly:!0})],l.prototype,"allActions",null);d([a.property()],l.prototype,"autoCloseEnabled",void 0);d([a.property()],l.prototype,"autoOpenEnabled",void 0);d([a.property()],l.prototype,
"content",void 0);d([a.property({readOnly:!0,dependsOn:["features"]})],l.prototype,"featureCount",null);d([a.property()],l.prototype,"features",null);d([a.property()],l.prototype,"highlightEnabled",void 0);d([a.property({type:t})],l.prototype,"location",null);d([a.property({readOnly:!0,dependsOn:["promises"]})],l.prototype,"pendingPromisesCount",null);d([a.property({readOnly:!0,dependsOn:["featureCount","pendingPromisesCount"]})],l.prototype,"waitingForResult",null);d([a.property({readOnly:!0,dependsOn:["promises"]})],
l.prototype,"promiseCount",null);d([a.property()],l.prototype,"promises",null);d([a.property({value:null,readOnly:!0,dependsOn:["features","selectedFeatureIndex","updateLocationEnabled"]})],l.prototype,"selectedFeature",null);d([a.property({value:-1})],l.prototype,"selectedFeatureIndex",null);d([a.property({readOnly:!0,dependsOn:["view.ready"]})],l.prototype,"state",null);d([a.property()],l.prototype,"title",void 0);d([a.property()],l.prototype,"updateLocationEnabled",void 0);d([a.property()],l.prototype,
"view",void 0);d([a.property()],l.prototype,"visible",void 0);d([a.property()],l.prototype,"zoomFactor",void 0);d([a.property()],l.prototype,"centerAtLocation",null);d([a.property()],l.prototype,"clear",null);d([a.property()],l.prototype,"triggerAction",null);d([a.property()],l.prototype,"next",null);d([a.property()],l.prototype,"previous",null);d([a.property()],l.prototype,"zoomToLocation",null);return l=d([a.subclass("esri.widgets.Popup.PopupViewModel")],l)}(a.declared(C,A))})},"esri/views/support/layerViewUtils":function(){define(["require",
"exports"],function(q,g){Object.defineProperty(g,"__esModule",{value:!0});g.hasHighlight=function(n){return n&&"function"===typeof n.highlight}})},"esri/widgets/Popup/actions":function(){define("require exports dojo/i18n!../../nls/common dojo/i18n!./nls/Popup ../../core/Error ../../core/promiseUtils ../../support/actions/ActionButton".split(" "),function(q,g,n,d,h,m,f){Object.defineProperty(g,"__esModule",{value:!0});g.zoomToFeature=new f({id:"zoom-to-feature",title:d.zoom,className:"esri-icon-zoom-in-magnifying-glass"});
g.removeSelectedFeature=new f({id:"remove-selected-feature",title:n.remove,className:"esri-icon-trash"});g.all=[g.zoomToFeature,g.removeSelectedFeature];g.triggerAction=function(b){var c=b.view;b=b.event.action;var d=c&&c.popup;if(!b)return m.reject(new h("trigger-action:missing-arguments","Event has no action"));if(!d)return m.reject(new h("trigger-action:missing-arguments","view.popup is missing"));var f=b.disabled,a=b.id;if(!a)return m.reject(new h("trigger-action:invalid-action","action.id is missing"));
if(f)return m.reject(new h("trigger-action:invalid-action","Action is disabled"));if(a===g.zoomToFeature.id)return d.viewModel.zoomToLocation();if(a===g.removeSelectedFeature.id){d.close();b=d.selectedFeature;if(!b)return m.reject(new h("trigger-action:"+g.removeSelectedFeature.id,"selectedFeature is required",{selectedFeature:b}));(d=b.sourceLayer)?d.remove(b):c.graphics.remove(b);return m.resolve()}return m.reject(new h("trigger-action:unknown-action","Unable to identify action to perform",{action:b,
popup:d}))}})},"esri/widgets/support/GoTo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),function(q,g,n,d,h,m){return function(f){function b(){var b=null!==f&&f.apply(this,arguments)||this;b.goToOverride=null;b.view=null;return b}n(b,f);b.prototype.callGoTo=function(b){var c=this.view;return this.goToOverride?this.goToOverride(c,b):c.goTo(b.target,b.options)};d([m.property()],
b.prototype,"goToOverride",void 0);d([m.property()],b.prototype,"view",void 0);return b=d([m.subclass("esri.widgets.support.GoTo")],b)}(m.declared(h))})},"esri/views/MapViewBase":function(){define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../geometry ../Viewpoint ../core/Error ../core/Handles ../core/Logger ../core/promiseUtils ../core/accessorSupport/decorators ../geometry/support/webMercatorUtils ../layers/support/TileInfo ./PopupView ./View ./ViewAnimation ./2d/AnimationManager ./2d/FrameTask ./2d/MapViewConstraints ./2d/PaddedViewState ./2d/tiling ./2d/viewpointUtils".split(" "),
function(q,g,n,d,h,m,f,b,c,e,r,a,t,p,u,l,k,w,v,C,A,x,z){var y=e.getLogger("esri.views.MapView");return function(l){function e(a){var b=l.call(this,a)||this;b._frameTask=new v.default(b);b._mapViewBaseHandles=new c;b._setup=!1;b.featuresTilingScheme=null;b.fullOpacity=1;b.interacting=!1;b.initialExtent=null;b.labelManager=null;b.resizeAlign="center";b.type="2d";b.constraints=new C;b.padding={top:0,right:0,bottom:0,left:0};var d=function(){this._set("updating",!this.layerViewManager||this.layerViewManager.factory.working||
this.allLayerViews.some(function(a){return!0===a.updating})||this.labelManager&&!0===this.labelManager.updating)}.bind(b),e=b._mapViewBaseHandles;e.add([b.watch("viewpoint",function(a){return b._flipStationary()},!0),b.on("resize",function(a){return b._resizeHandler(a)}),b.watch("animationManager.animation",function(a){b.animation=a}),b.watch("labelManager.updating",d),b.allLayerViews.on("change",function(){d();e.remove("layerViewsUpdating");e.add(b.allLayerViews.map(function(a){return a.watch("updating",
d)}).toArray(),"layerViewsUpdating")})]);d();b.watch("ready",function(a){a?(b._startup(),b._frameTask&&b._frameTask.start()):(b._frameTask&&b._frameTask.stop(),b._tearDown())},!0);return b}d(e,l);e.prototype.destroy=function(){this.destroyed||(this._set("ready",!1),this._mapViewBaseHandles.removeAll(),this.layerViewManager.clear(),this._frameTask.destroy(),this._tearDown(),this._gotoTask=this._mapViewBaseHandles=this._frameTask=null)};Object.defineProperty(e.prototype,"animation",{set:function(a){var b=
this,c=this._get("animation");a!==c&&(c&&c.stop(),!a||a.isFulfilled()?this._set("animation",null):(this._set("animation",a),c=function(){a===b._get("animation")&&(b._set("animation",null),b._frameTask.requestFrame())},a.when(c,c)))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"center",{get:function(){if(!this._setup)return this._get("center");var a=this.content.center;return new m.Point({x:a[0],y:a[1],spatialReference:this.content.spatialReference})},set:function(a){if(null!=
a)if(this._normalizeInput(a))if(this._setup){var b=this.viewpoint;z.centerAt(b,b,a);this.viewpoint=b}else this._set("center",a),this.notifyChange("initialExtentRequired");else y.error("#center","incompatible spatialReference "+JSON.stringify(a.spatialReference)+" with view's spatialReference "+JSON.stringify(this.spatialReference))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"constraints",{set:function(a){var b=this,c=this._get("constraints");c&&(this._mapViewBaseHandles.remove("constraints"),
c.destroy());this._set("constraints",a);a&&(a.view=this,this._setup&&(this.state.viewpoint=a.fit(this.content.viewpoint)),this._mapViewBaseHandles.add(a.on("update",function(){b._setup&&b.state&&(b.state.viewpoint=a.fit(b.content.viewpoint))}),"constraints"))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"extent",{get:function(){return this._setup?this.content.extent.clone():this._get("extent")},set:function(a){if(null!=a){var b=this._normalizeInput(a);b?b.width&&b.height?this._setup?
(a=this.viewpoint,z.setExtent(a,a,b,this.size,{constraints:this.constraints}),this.viewpoint=a):(this._set("extent",b),this._set("center",null),this._set("viewpoint",null),this._set("scale",0),this._set("zoom",-1),this.notifyChange("initialExtentRequired")):y.error("#extent","invalid extent size"):y.error("#center","incompatible spatialReference "+JSON.stringify(a.spatialReference)+" with view's spatialReference "+JSON.stringify(this.spatialReference))}},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,
"initialExtentRequired",{get:function(){var a=this.extent,b=this.center,c=this.scale,d=this.viewpoint,e=this.zoom;return this.get("map.initialViewProperties.viewpoint")||a||b&&(0!==c||-1!==e)||d?!1:!0},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"padding",{get:function(){return this._setup?this.state.padding:this._get("padding")},set:function(a){this._setup?(this.state.padding=a,this._set("padding",this.state.padding)):this._set("padding",a)},enumerable:!0,configurable:!0});
Object.defineProperty(e.prototype,"resolution",{get:function(){return this.state?this.state.resolution:0},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"rotation",{get:function(){return this._setup?this.content.rotation:this._get("rotation")},set:function(a){if(!isNaN(a))if(this._setup){var b=this.viewpoint;z.rotateTo(b,b,a);this.viewpoint=b}else this._set("rotation",a)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"scale",{get:function(){return this._setup?
this.content.scale:this._get("scale")},set:function(a){if(a&&!isNaN(a))if(this._setup){var b=this.viewpoint;z.scaleTo(b,b,a);this.viewpoint=b}else{this._set("scale",a);this._set("zoom",-1);if(a=this._get("extent"))this._set("extent",null),this._set("center",a.center);this.notifyChange("initialExtentRequired")}},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"stationary",{get:function(){return!this.animation&&!this.interacting&&!this._get("resizing")&&!this._stationaryTimer},enumerable:!0,
configurable:!0});Object.defineProperty(e.prototype,"viewpoint",{get:function(){if(!this._setup)return this._get("viewpoint");var a=this.content;return a&&a.viewpoint.clone()},set:function(a){if(null!=a){var b=this._normalizeInput(a);b?this._setup?(a=z.create(),z.copy(a,b),this.constraints.constrain(a,this.content.viewpoint),this.state.viewpoint=a,this._frameTask.requestFrame(),this._set("viewpoint",a)):(this._set("viewpoint",b),this._set("extent",null),this._set("center",null),this._set("zoom",-1),
this._set("scale",0),this.notifyChange("initialExtentRequired")):!a.scale||isNaN(a.scale)?y.error("#viewpoint","invalid scale value of "+a.scale):a.targetGeometry?y.error("#viewpoint","incompatible spatialReference "+JSON.stringify(a.targetGeometry.spatialReference)+" with view's spatialReference "+JSON.stringify(this.spatialReference)):y.error("#viewpoint","geometry not defined")}},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"zoom",{get:function(){return this._setup?this.constraints.scaleToZoom(this.scale):
this._get("zoom")},set:function(a){if(null!=a){if(!this._setup){this.notifyChange("initialExtentRequired");this._set("zoom",a);this._set("scale",0);var b=this._get("extent");b&&(this._set("extent",null),this._set("center",b.center))}this.constraints.effectiveLODs&&(b=this.viewpoint,z.scaleTo(b,b,this.constraints.zoomToScale(a)),this.viewpoint=b,this._set("zoom",this.constraints.scaleToZoom(this.scale)))}},enumerable:!0,configurable:!0});e.prototype.goTo=function(a,b){this.animation&&(this.animation=
null);if(this._setup)return b=n({animate:!0},b),a=z.createAsync(a,this),this._gotoTask={},b.animate?this._gotoAnimated(a,b):this._gotoImmediate(a,b);y.error("#goTo()","MapView cannot be used before it is ready")};e.prototype.hitTest=function(a){return r.reject("Should be implemented by subclasses")};e.prototype.popupHitTest=function(a){var b=this;return this.hitTest(a).then(function(c){return n({},c,{mapPoint:b.toMap(a)})})};e.prototype.toMap=function(a,b,c){if(!this._setup)return null;a&&null!=a.x&&
(c=b,b=a.y,a=a.x);var d=[0,0];this.state.toMap(d,[a,b]);c=c||new m.Point;c.x=d[0];c.y=d[1];c.spatialReference=this.spatialReference;return c};e.prototype.isTileInfoRequired=function(){return!0};e.prototype.toScreen=function(a,b,c,d){if(!this._setup)return null;a&&"object"===typeof a?(d=b||new m.ScreenPoint,a=this._normalizeInput(a),b=a.y,a=a.x):d="number"===typeof c||null==c?d||new m.ScreenPoint:c||new m.ScreenPoint;a=[a,b];this.state.toScreen(a,a);d.x=a[0];d.y=a[1];return d};e.prototype.pixelSizeAt=
function(a,b){if(!this._setup)return NaN;a&&null!=a.x&&(b=a.y,a=a.x);return this.content.pixelSizeAt([a,b])};e.prototype.requestLayerViewUpdate=function(a){this._setup&&this._frameTask.requestLayerViewUpdate(a)};e.prototype.requestUpdate=function(a){this._setup&&this._frameTask.requestUpdate(a)};e.prototype.getDefaultSpatialReference=function(){return this.get("map.initialViewProperties.spatialReference")||this.get("defaultsFromMap.spatialReference")||null};e.prototype.isSpatialReferenceSupported=
function(a,b){return b||this._get("ready")?!0:null!==this._getDefaultViewpoint()};e.prototype._createOrReplaceAnimation=function(a){if(!this.animation||this.animation.done)this.animation=new k;this.animation.update(a);return this.animation};e.prototype._cancellableGoTo=function(a,b,c){var d=this,e=c.then(function(){a===d._gotoTask&&(d.animation=null)}).catch(function(c){a===d._gotoTask&&(d.animation=null,b.done||b.stop());throw c;}),l=r.create(function(a){return a(e)},function(){a!==d._gotoTask||
b.done||b.stop()});b.when().catch(function(){a===d._gotoTask&&l.cancel()});return l};e.prototype._gotoImmediate=function(a,c){var d=this,e=this._gotoTask,l=this._createOrReplaceAnimation(a);a=a.then(function(a){if(e!==d._gotoTask)throw new b("view:goto-interrupted","Goto was interrupted");d.viewpoint=l.target=a;l.finish()});return this._cancellableGoTo(e,l,a)};e.prototype._gotoAnimated=function(a,c){var d=this,e=this._gotoTask,l=this._createOrReplaceAnimation(a);a=a.then(function(a){if(e!==d._gotoTask)throw new b("view:goto-interrupted",
"Goto was interrupted");l.update(a);d.animationManager.animate(l,d.viewpoint,c);return l.when().then(function(){})});return this._cancellableGoTo(e,l,a)};e.prototype._resizeHandler=function(a){var b=this.state;if(b){var c=this.content.viewpoint,d=this.content.size.concat();b.size=[a.width,a.height];z.resize(c,c,d,this.content.size,this.resizeAlign);c=this.constraints.constrain(c,null);this.state.viewpoint=c}};e.prototype._startup=function(){if(!this._setup){var a=this._getDefaultViewpoint();this.constraints.view=
this;this.constraints.fit(a);this._set("animationManager",new w({view:this}));this._set("state",new A({padding:this._get("padding"),size:this.size,viewpoint:a}));this._set("content",this.state.content);this._set("featuresTilingScheme",new x.TileInfoView(p.create({spatialReference:this.spatialReference,size:512})));this._setup=!0}};e.prototype._tearDown=function(){if(this._setup){this._setup=!1;this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null,this.notifyChange("stationary"));
var a=this._get("content"),b=a.center,c=a.spatialReference,b=new m.Point({x:b[0],y:b[1],spatialReference:c});this._set("viewpoint",null);this._set("extent",null);this._set("center",b);this._set("zoom",-1);this._set("rotation",a.rotation);this._set("scale",a.scale);this._set("spatialReference",c);this.constraints.view=null;this.animationManager.destroy();this._set("animationManager",null);this._set("state",null);this._set("content",null);this.animation=null}};e.prototype._flipStationary=function(){var a=
this;this._stationaryTimer&&clearTimeout(this._stationaryTimer);this._stationaryTimer=setTimeout(function(){a._stationaryTimer=null;a.notifyChange("stationary")},160);this.notifyChange("stationary")};e.prototype._normalizeInput=function(a,b){void 0===b&&(b=this.spatialReference);var c=a&&a.targetGeometry||a;return b?c?b.equals(c.spatialReference)?a:t.canProject(c,b)?a&&"esri.Viewpoint"===a.declaredClass?(a.targetGeometry=t.project(c,b),a):t.project(c,b):null:null:a};e.prototype._getDefaultViewpoint=
function(){var a=this.constraints,b=this._get("zoom"),c=this._get("scale"),d=this._normalizeInput(this._get("center")),e=this._normalizeInput(this._get("extent")),l=this._get("rotation"),k=this._normalizeInput(this._get("viewpoint"));a.effectiveLODs?-1!==b&&(c=a.zoomToScale(b)):b=-1;var p=null,t=null,b=0,a=k&&k.rotation,r=k&&k.targetGeometry;r&&("extent"===r.type?p=r:"point"===r.type&&(t=r,b=k.scale));k=this._normalizeInput(this.get("map.initialViewProperties.viewpoint.targetGeometry.extent"));r=
this._normalizeInput(this.initialExtent);e=e||p||k||r;d=d||t||e&&e.center;c=c||b||e&&z.extentToScale(e,this.size);return d&&c?new f({targetGeometry:d,scale:c,rotation:l||a||0}):null};h([a.property()],e.prototype,"animation",null);h([a.property({readOnly:!0})],e.prototype,"animationManager",void 0);h([a.property({value:null,type:m.Point,dependsOn:["content.viewpoint"]})],e.prototype,"center",null);h([a.property({type:C})],e.prototype,"constraints",null);h([a.property({readOnly:!0})],e.prototype,"content",
void 0);h([a.property({value:null,type:m.Extent,dependsOn:["content.viewpoint"]})],e.prototype,"extent",null);h([a.property({readOnly:!0})],e.prototype,"featuresTilingScheme",void 0);h([a.property()],e.prototype,"fullOpacity",void 0);h([a.property({readOnly:!0})],e.prototype,"interacting",void 0);h([a.property({type:m.Extent})],e.prototype,"initialExtent",void 0);h([a.property({dependsOn:["map.initialViewProperties?.viewpoint"]})],e.prototype,"initialExtentRequired",null);h([a.property()],e.prototype,
"labelManager",void 0);h([a.property({value:{top:0,right:0,bottom:0,left:0},cast:function(a){return n({top:0,right:0,bottom:0,left:0},a)}})],e.prototype,"padding",null);h([a.property()],e.prototype,"resizeAlign",void 0);h([a.property({readOnly:!0,dependsOn:["content.viewpoint"]})],e.prototype,"resolution",null);h([a.property({value:0,type:Number,dependsOn:["content.viewpoint"]})],e.prototype,"rotation",null);h([a.property({value:0,type:Number,dependsOn:["content.viewpoint"]})],e.prototype,"scale",
null);h([a.property({type:m.SpatialReference,dependsOn:["map.initialViewProperties?.spatialReference","defaultsFromMap.isSpatialReferenceDone"]})],e.prototype,"spatialReference",void 0);h([a.property({readOnly:!0})],e.prototype,"state",void 0);h([a.property()],e.prototype,"stationary",null);h([a.property({readOnly:!0})],e.prototype,"type",void 0);h([a.property({value:null,type:f,dependsOn:["content.viewpoint"]})],e.prototype,"viewpoint",null);h([a.property({value:-1,dependsOn:["scale"]})],e.prototype,
"zoom",null);return e=h([a.subclass("esri.views.MapViewBase")],e)}(a.declared(l,u))})},"esri/views/PopupView":function(){define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/awaiterHelper ../core/tsSupport/generatorHelper ../core/Accessor ../core/arrayUtils ../core/promiseUtils ../core/accessorSupport/decorators".split(" "),function(q,g,n,d,h,m,f,b,c,e,r){return function(a){function b(){return null!==a&&a.apply(this,
arguments)||this}d(b,a);b.prototype.fetchPopupFeatures=function(a){return this._fetchPopupFeaturesAsync(a)};b.prototype._fetchPopupFeaturesAsync=function(a){return m(this,void 0,void 0,function(){var b,d,k,p,r,t;return f(this,function(l){switch(l.label){case 0:return[4,this.when()];case 1:return l.sent(),[4,this._prepareFetchPopupFeatures(a)];case 2:return b=l.sent(),d=b.mapPoint,k=this._queryLayerPopupFeatures(b),p=e.resolve(b.clientOnlyGraphics),r=[p].concat(k),t=e.eachAlwaysValues(r).then(c.concatAll),
[2,{promise:t,location:d,promises:r}]}})})};b.prototype._queryLayerPopupFeatures=function(a){var b=a.mapPoint;return a.layerViewsAndGraphics.map(function(a){return a.layerView.fetchPopupFeatures(b,a.graphics)})};b.prototype._isValidPopupGraphic=function(a){return a&&!!a.getEffectivePopupTemplate()};b.prototype._prepareFetchPopupFeatures=function(a){return m(this,void 0,void 0,function(){var b,c,d,e,p,r,t;return f(this,function(l){switch(l.label){case 0:return[4,this._popupHitTestGraphics(a)];case 1:return b=
l.sent(),c=b.clientGraphics,d=b.mapPoint,e=this._getFetchPopupLayerViews(),p=this._graphicsPerFetchPopupLayerView(c,e),r=p.layerViewsAndGraphics,t=p.clientOnlyGraphics,[2,{clientOnlyGraphics:t,layerViewsAndGraphics:r,mapPoint:d}]}})})};b.prototype._popupHitTestGraphics=function(a){return m(this,void 0,void 0,function(){var b,c,d,e,p=this;return f(this,function(l){switch(l.label){case 0:return[4,this.popupHitTest(a)];case 1:return b=l.sent(),c=b.results,d=b.mapPoint,e=c.map(function(a){return a.graphic}).filter(function(a){return p._isValidPopupGraphic(a)}),
[2,{clientGraphics:e,mapPoint:d}]}})})};b.prototype._getFetchPopupLayerViews=function(){var a=this,b=[];this.allLayerViews.forEach(function(c){a._isValidPopupLayerView(c)&&b.push(c)});this._isValidPopupLayerView(this.graphicsView)&&b.push(this.graphicsView);return b};b.prototype._isValidPopupLayerView=function(a){return a&&(!("layer"in a)||!a.suspended)&&"function"===typeof a.fetchPopupFeatures};b.prototype._graphicsPerFetchPopupLayerView=function(a,b){var c=[],d=new Map;b=b.map(function(a){var b=
[];"layer"in a?d.set(a.layer,b):d.set(a.graphics,b);return{layerView:a,graphics:b}});for(var e=0;e<a.length;e++){var f=a[e],p=d.get(f.layer)||null;p?p.push(f):c.push(f)}return{layerViewsAndGraphics:b,clientOnlyGraphics:c}};return b=h([r.subclass("esri.views.PopupView")],b)}(r.declared(b))})},"esri/views/2d/AnimationManager":function(){define("../../core/Accessor ../../core/scheduling ../../core/now ../ViewAnimation ./unitBezier ./viewpointUtils".split(" "),function(q,g,n,d,h,m){var f=function(b,c,
d,f){var a=b.targetGeometry,e=c.targetGeometry;f?"string"===typeof f&&(f=h.parse(f)||h.ease):f=h.ease;this.easing=f;this.duration=d;this.sCenterX=a.x;this.sCenterY=a.y;this.sScale=b.scale;this.sRotation=b.rotation;this.tCenterX=e.x;this.tCenterY=e.y;this.tScale=c.scale;this.tRotation=c.rotation;this.dCenterX=this.tCenterX-this.sCenterX;this.dCenterY=this.tCenterY-this.sCenterY;this.dScale=this.tScale-this.sScale;this.dRotation=this.tRotation-this.sRotation;180<this.dRotation?this.dRotation-=360:-180>
this.dRotation&&(this.dRotation+=360)};f.prototype.applyRatio=function(b,c){var d=this.easing(c),f,a;1<=c?(c=this.tCenterX,f=this.tCenterY,a=this.tRotation,d=this.tScale):(c=this.sCenterX+d*this.dCenterX,f=this.sCenterY+d*this.dCenterY,a=this.sRotation+d*this.dRotation,d=this.sScale+d*this.dScale);b.targetGeometry.x=c;b.targetGeometry.y=f;b.scale=d;b.rotation=a};return q.createSubclass({constructor:function(){this._updateTask=g.addFrameTask({postRender:this._postRender.bind(this)});this._updateTask.pause()},
getDefaults:function(){return{viewpoint:m.create()}},properties:{animation:null,duration:{value:200},transition:{value:null},easing:{value:h.ease},view:null,viewpoint:null},animate:function(b,c,d){this.stop();m.copy(this.viewpoint,c);this.transition=new f(this.viewpoint,b.target,d&&d.duration||this.duration,d&&d.easing||this.easing);c=function(){this.animation===b&&this._updateTask&&("finished"===b.state&&(this.transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),
this._updateTask.pause(),this.updateFunction=this.animation=null)}.bind(this);b.when(c,c);this._startTime=n();this._updateTask.resume();return this.animation=b},animateContinous:function(b,c){this.stop();this.updateFunction=c;this.viewpoint=b;var e=new d({target:b.clone()});b=function(){this.animation===e&&this._updateTask&&(this._updateTask.pause(),this.updateFunction=this.animation=null)}.bind(this);e.when(b,b);this._startTime=n();this._updateTask.resume();return this.animation=e},stop:function(){this.animation&&
(this.animation.stop(),this.updateFunction=this.animation=null)},_postRender:function(b){var c=this.animation;c&&c.state!==d.STOPPED?(this.updateFunction?this.updateFunction(this.viewpoint,b.deltaTime):(b=(n()-this._startTime)/this.transition.duration,c=1<=b,this.transition.applyRatio(this.viewpoint,b),c&&this.animation.finish()),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())):this._updateTask.pause()}})})},"esri/views/2d/unitBezier":function(){define([],function(){var q=function(n,
d,h,m){function f(a,d){var l,k,f,p;d=null==d?1E-6:d;f=a;for(k=0;8>k;k++){p=((e*f+c)*f+b)*f-a;if(Math.abs(p)<d)return f;l=(3*e*f+2*c)*f+b;if(1E-6>Math.abs(l))break;f-=p/l}l=0;k=1;f=a;if(f<l)return l;if(f>k)return k;for(;l<k;){p=((e*f+c)*f+b)*f;if(Math.abs(p-a)<d)break;a>p?l=f:k=f;f=.5*(k-l)+l}return f}var b=3*n,c=3*(h-n)-b,e=1-b-c,r=3*d,a=3*(m-d)-r,t=1-r-a;return function(b,c){b=f(b,c);return((t*b+a)*b+r)*b}},g=/^cubic-bezier\((.*)\)/;q.parse=function(n){var d=q[n]||null;!d&&(n=g.exec(n))&&(n=n[1].split(",").map(function(d){return parseFloat(d.trim())}),
4!==n.length||n.some(function(d){return isNaN(d)})||(d=q.apply(q,n)));return d};q.ease=q(.25,.1,.25,1);q.linear=q(0,0,1,1);q.easeIn=q["ease-in"]=q(.42,0,1,1);q.easeOut=q["ease-out"]=q(0,0,.58,1);q.easeInOut=q["ease-in-out"]=q(.42,0,.58,1);return q})},"esri/views/2d/viewpointUtils":function(){define("require exports ../../Viewpoint ../../core/Error ../../core/promiseUtils ../../core/wgs84Constants ../../core/libs/gl-matrix-2/gl-matrix ../../geometry/Extent ../../geometry/Geometry ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/scaleUtils ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ../../geometry/support/webMercatorUtils".split(" "),
function(q,g,n,d,h,m,f,b,c,e,r,a,t,p,u){function l(a,b,c,d){return d&&c&&!d.equals(c)&&p.canProject(d,c)&&d.isWebMercator?(d.isWebMercator?(c=b[1],89.99999<c?c=89.99999:-89.99999>c&&(c=-89.99999),c=Math.sin(f.common.toRadian(c)),a=f.vec2.set(a,f.common.toRadian(b[0])*H,.5*H*Math.log((1+c)/(1-c)))):(c=f.common.toDegree(b[0]/H),a=f.vec2.set(a,c-360*Math.floor((c+180)/360),f.common.toDegree(.5*Math.PI-2*Math.atan(Math.exp(-1*b[1]/H))))),a):f.vec2.copy(a,b)}function k(a){return a.wkid?a:a.spatialReference||
r.WGS84}function w(a,b){return b.type?f.vec2.set(a,b.x,b.y):f.vec2.copy(a,b)}function v(a,b){return Math.max(a.width/b[0],a.height/b[1])*N(a.spatialReference)}function C(a,d,l){var k;if(!a)return null;if(Array.isArray(a)&&2===a.length&&"number"===typeof a[0]&&"number"===typeof a[1])return new e(a);if(a.reduce)return a.reduce(function(a,b){return C(b,d,a)},l);a instanceof c?k=a:a.geometry&&(k=a.geometry);if(!k)return null;a="point"===k.type?new b({xmin:k.x,ymin:k.y,xmax:k.x,ymax:k.y,spatialReference:k.spatialReference}):
k.extent;if(!a)return null;k=p.canProject(a,d);if(!a.spatialReference.equals(d)&&k)a=p.project(a,d);else if(!k)return null;return l=l?l.union(a):a.clone()}function A(a,c){if(!a)return new n({targetGeometry:new e,scale:0,rotation:0});var d=c.spatialReference,r=c.size,t=c.viewpoint,h=c.constraints,m=null;"esri.Viewpoint"===a.declaredClass?m=a:a.viewpoint?m=a.viewpoint:a.target&&"esri.Viewpoint"===a.target.declaredClass&&(m=a.target);var g=null;if(m&&m.targetGeometry)g=m.targetGeometry;else if(a instanceof
b)g=a;else if(a||a&&(a.hasOwnProperty("center")||a.hasOwnProperty("extent")||a.hasOwnProperty("target")))g=C(a.center,d)||C(a.extent,d)||C(a.target,d)||C(a,d);!g&&t&&t.targetGeometry?g=t.targetGeometry:!g&&c.extent&&(g=c.extent);var A=k(g);d||(d=k(c.spatialReference||c.extent||g));if(!u.canProject(g,d)&&A&&!A.equals(d))return null;var q=w(f.vec2f64.create(),g.center?g.center:g),A=new e(l(q,q,A,d),d),q=null,q=m&&m.targetGeometry&&"point"===m.targetGeometry.type?m.scale:a.hasOwnProperty("scale")&&a.scale?
a.scale:a.hasOwnProperty("zoom")&&-1!==a.zoom&&h&&h.effectiveLODs?h.zoomToScale(a.zoom):Array.isArray(g)||"point"===g.type||"extent"===g.type&&0===g.width&&0===g.height?c.extent&&p.canProject(c.extent,d)?v(p.project(c.extent,d),r):c.extent?v(c.extent,r):t.scale:p.canProject(g.extent,d)?v(p.project(g.extent,d),r):v(g.extent,r);c=0;m?c=m.rotation:a.hasOwnProperty("rotation")?c=a.rotation:t&&(c=t.rotation);a=new n({targetGeometry:A,scale:q,rotation:c});h&&(a=h.fit(a),h.rotationEnabled||(a.rotation=c));
return a}function x(a,b){var c=a.targetGeometry,d=b.targetGeometry;c.x=d.x;c.y=d.y;c.spatialReference=d.spatialReference;a.scale=b.scale;a.rotation=b.rotation;return a}function z(a,b,c){return c?f.vec2.set(a,.5*(b[0]-c.right+c.left),.5*(b[1]-c.bottom+c.top)):f.vec2.scale(a,b,.5)}function y(a,b,c,d){g.getTransform(a,b,c,d);return f.mat2d.invert(a,a)}function B(a,b,c){var d=L(b);b=Math.abs(Math.cos(d));d=Math.abs(Math.sin(d));return f.vec2.set(a,Math.round(c[1]*d+c[0]*b),Math.round(c[1]*b+c[0]*d))}
function D(b){var c=b.scale;b=b.targetGeometry.spatialReference;b=t.isValid(b)?1/(39.37*a.getMetersPerUnitForSR(b)*96):1;return c*b}function L(a){return f.common.toRadian(a.rotation)||0}function N(b){return t.isValid(b)?39.37*a.getMetersPerUnitForSR(b)*96:1}function F(a){return a.isWrappable?(a=t.getInfo(a),a.valid[1]-a.valid[0]):0}Object.defineProperty(g,"__esModule",{value:!0});var H=m.wgs84Radius,I=180/Math.PI;g.extentToScale=v;g.create=A;g.copy=x;g.getAnchor=z;g.getExtent=function(){var a=f.vec2f64.create();
return function(b,c,d){var e=c.targetGeometry;w(a,e);c=.5*D(c);b.xmin=a[0]-c*d[0];b.ymin=a[1]-c*d[1];b.xmax=a[0]+c*d[0];b.ymax=a[1]+c*d[1];b.spatialReference=e.spatialReference;return b}}();g.setExtent=function(a,b,c,d,e){g.centerAt(a,b,c.center);a.scale=v(c,d);e&&e.constraints&&e.constraints.constrain(a);return a};g.getOuterExtent=function(){var a=f.vec2f64.create(),b=f.vec2f64.create();return function(c,d,e){w(a,d.targetGeometry);B(b,d,e);e=.5*D(d);c.set({xmin:a[0]-e*b[0],ymin:a[1]-e*b[1],xmax:a[0]+
e*b[0],ymax:a[1]+e*b[1],spatialReference:d.targetGeometry.spatialReference});return c}}();g.getOuterSize=B;g.getPaddingScreenTranslation=function(){var a=f.vec2f64.create();return function(b,c,d){return f.vec2.sub(b,f.vec2.scale(b,c,.5),z(a,c,d))}}();var G=function(){var a=f.mat2df64.create(),b=f.vec2f64.create();return function(c,d,e,l){var k=D(d);d=L(d);f.vec2.set(b,k,k);f.mat2d.fromScaling(a,b);f.mat2d.rotate(a,a,d);f.mat2d.translate(a,a,g.getPaddingScreenTranslation(b,e,l));f.mat2d.translate(a,
a,[0,l.top-l.bottom]);return f.vec2.set(c,a[4],a[5])}}();g.getResolution=D;g.getResolutionToScaleFactor=N;g.getMatrix=function(){var a=f.vec2f64.create(),b=f.vec2f64.create(),c=f.vec2f64.create();return function(d,e,l,k,p,t){f.vec2.negate(a,e);f.vec2.scale(b,l,.5*t);f.vec2.set(c,1/k*t,-1/k*t);f.mat2d.identity(d);f.mat2d.translate(d,d,b);p&&f.mat2d.rotate(d,d,p);f.mat2d.scale(d,d,c);f.mat2d.translate(d,d,a);return d}}();g.getTransform=function(){var a=f.vec2f64.create();return function(b,c,d,e){var l=
D(c),k=L(c);w(a,c.targetGeometry);return g.getMatrix(b,a,d,l,k,e)}}();g.getTransformNoRotation=function(){var a=f.vec2f64.create();return function(b,c,d,e){var l=D(c);w(a,c.targetGeometry);return g.getMatrix(b,a,d,l,0,e)}}();g.getWorldWidth=F;g.getWorldScreenWidth=function(a,b){return Math.round(F(a)/b)};g.createAsync=function(a,b){if(a=A(a,b))return h.resolve(a);a=new d("viewpointUtils-createAsync:different-spatialReference","Target spatialReference cannot be projected and is different from out spatialReference");
return h.reject(a)};g.angleBetween=function(){var a=f.vec2f64.create(),b=f.vec2f64.create(),c=[0,0,0];return function(d,e,l){f.vec2.subtract(a,d,e);f.vec2.normalize(a,a);f.vec2.subtract(b,d,l);f.vec2.normalize(b,b);f.vec2.cross(c,a,b);d=Math.acos(f.vec2.dot(a,b)/(f.vec2.length(a)*f.vec2.length(b)))*I;0>c[2]&&(d=-d);isNaN(d)&&(d=0);return d}}();g.addPadding=function(){var a=f.vec2f64.create();return function(b,c,d,e){var l=b.targetGeometry;x(b,c);G(a,c,d,e);l.x+=a[0];l.y+=a[1];return b}}();g.removePadding=
function(){var a=f.vec2f64.create();return function(b,c,d,e){var l=b.targetGeometry;x(b,c);G(a,c,d,e);l.x-=a[0];l.y-=a[1];return b}}();g.centerAt=function(){var a=f.vec2f64.create();return function(b,c,d){x(b,c);c=b.targetGeometry;var e=k(d),f=k(c);w(a,d);l(a,a,e,f);c.x=a[0];c.y=a[1];return b}}();g.pixelSizeAt=function(a,b,c){return D(b)};g.resize=function(){var a=f.vec2f64.create();return function(b,c,d,e,l){l||(l="center");f.vec2.sub(a,d,e);f.vec2.scale(a,a,.5);d=a[0];e=a[1];switch(l){case "center":f.vec2.set(a,
0,0);break;case "left":f.vec2.set(a,-d,0);break;case "top":f.vec2.set(a,0,e);break;case "right":f.vec2.set(a,d,0);break;case "bottom":f.vec2.set(a,0,-e);break;case "top-left":f.vec2.set(a,-d,e);break;case "bottom-left":f.vec2.set(a,-d,-e);break;case "top-right":f.vec2.set(a,d,e);break;case "bottom-right":f.vec2.set(a,d,-e)}g.translateBy(b,c,a);return b}}();g.rotateBy=function(a,b,c){x(a,b);a.rotation+=c;return a};g.rotateTo=function(a,b,c){x(a,b);a.rotation=c;return a};g.scaleBy=function(){var a=
f.vec2f64.create();return function(b,c,d,e,l){x(b,c);isNaN(d)||0===d||(g.toMap(a,e,c,l),b.scale=c.scale*d,g.toScreen(a,a,b,l),g.translateBy(b,b,f.vec2.set(a,a[0]-e[0],e[1]-a[1])));return b}}();g.scaleTo=function(a,b,c){x(a,b);a.scale=c;return a};g.scaleAndRotateBy=function(){var a=f.vec2f64.create();return function(b,c,d,e,l,k){x(b,c);isNaN(d)||0===d||(g.toMap(a,l,c,k),b.scale=c.scale*d,b.rotation+=e,g.toScreen(a,a,b,k),g.translateBy(b,b,f.vec2.set(a,a[0]-l[0],l[1]-a[1])));return b}}();g.padAndScaleAndRotateBy=
function(){var a=f.vec2f64.create(),b=f.vec2f64.create();return function(c,d,e,l,k,p,t){g.getPaddingScreenTranslation(b,p,t);f.vec2.add(a,k,b);return l?g.scaleAndRotateBy(c,d,e,l,a,p):g.scaleBy(c,d,e,a,p)}}();g.toMap=function(){var a=f.mat2df64.create();return function(b,c,d,e){return f.vec2.transformMat2d(b,c,y(a,d,e,1))}}();g.toScreen=function(){var a=f.mat2df64.create();return function(b,c,d,e){return f.vec2.transformMat2d(b,c,g.getTransform(a,d,e,1))}}();g.translateBy=function(){var a=f.vec2f64.create(),
b=f.mat2df64.create();return function(c,d,e){x(c,d);var l=D(d),k=c.targetGeometry;f.mat2d.fromRotation(b,L(d));f.mat2d.scale(b,b,f.vec2f64.fromValues(l,l));f.vec2.transformMat2d(a,e,b);k.x+=a[0];k.y+=a[1];return c}}()})},"esri/views/2d/FrameTask":function(){define(["require","exports","../../core/scheduling"],function(q,g,n){Object.defineProperty(g,"__esModule",{value:!0});q=function(){function d(d){var h=this;this.view=d;this._frameTaskHandle=null;this.updateEnabled=this.stationary=!0;this.prepare=
function(){h._updateParameters.state=h.view.state;h._updateParameters.stationary=h.view.stationary;h._updateParameters.pixelRatio=window.devicePixelRatio};this.update=function(){if(h.updateEnabled){for(var d=h.view,b=d.labelManager,c=h.graphicsView,e=d.allLayerViews.toArray().filter(function(a){return a.isFulfilled()&&null==a.layerViews}),r=e.length,a=d.state,t=0;t<e.length;t++)if(d=e[t],d.attached){var p=d.lastUpdateId;if(null==p||!h.stationary&&!d.moving)d.moving=!0,d.moveStart();p!==a.id&&d.viewChange();
h.stationary&&d.moving&&(d.moving=!1,d.moveEnd());d.lastUpdateId=a.id}b&&b.lastUpdateId!==a.id&&(b.viewChange(),b.lastUpdateId=a.id);c&&c.lastUpdateId!==a.id&&(c.viewChange(),c.lastUpdateId=a.id);b=h._layerViewsTrash;for(c=0;c<b.length;c++)d=b[c],h._detachLayerView(d);for(c=b.length=0;c<r;c++)d=e[c],d.isFulfilled()&&!d.attached&&h._attachLayerView(d);e=h._updateParameters;r=h._layerViewsToUpdate;d=r.slice();c=r.length=0;for(a=d;c<a.length;c++)d=a[c],!("attached"in d)||"attached"in d&&d.attached?d.processUpdate(e):
r.push(d);r=h._updatablesToUpdate;d=r.slice();for(r=r.length=0;r<d.length;r++)d[r].processUpdate(e);0===h._layerViewsToUpdate.length&&0===h._updatablesToUpdate.length&&0===b.length&&h._frameTaskHandle.pause()}}}d.prototype.destroy=function(){this.stop()};d.prototype.start=function(){var d=this;this._updateParameters={state:this.view.state,pixelRatio:window.devicePixelRatio,stationary:!0};this._layerViewsTrash=[];this._layerViewsToUpdate=[];this._updatablesToUpdate=[];this._allLayerViewsChangeHandle=
this.view.allLayerViews.on("change",function(h){Array.prototype.push.apply(d._layerViewsTrash,h.removed);d.requestFrame()});this._stationaryHandle=this.view.watch("stationary",function(h){d.stationary=h;d.requestFrame()});this._frameTaskHandle=n.addFrameTask(this)};d.prototype.stop=function(){var d=this;this._frameTaskHandle&&(this.view.allLayerViews.forEach(function(h){return d._detachLayerView(h)}),this._stationaryHandle.remove(),this._allLayerViewsChangeHandle.remove(),this._frameTaskHandle.remove(),
this._updateParameters=this._stationaryHandle=this._allLayerViewsChangeHandle=this._frameTaskHandle=this._layerViewsTrash=this._layerViewsToUpdate=null,this.stationary=!0)};d.prototype.requestLayerViewUpdate=function(d){this._layerViewsToUpdate.push(d);this.requestFrame()};d.prototype.requestUpdate=function(d){this._updatablesToUpdate.push(d);this.requestFrame()};d.prototype.requestFrame=function(){this._frameTaskHandle&&this._frameTaskHandle.resume()};d.prototype._attachLayerView=function(d){d.attached||
(d.attached=!0,d.attach(),this._updateParameters.stationary?d.moving=!1:(d.moving=!0,d.moveStart()))};d.prototype._detachLayerView=function(d){d.attached&&(d.detach(),d.attached=!1,d.moving=!1)};return d}();g.default=q})},"esri/views/2d/MapViewConstraints":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Evented ../../core/accessorSupport/decorators ../../layers/support/LOD ./constraints/RotationConstraint ./constraints/ZoomConstraint".split(" "),
function(q,g,n,d,h,m,f,b,c,e){return function(r){function a(){var a=null!==r&&r.apply(this,arguments)||this;a.enabled=!0;a.lods=null;a.minScale=0;a.maxScale=0;a.minZoom=-1;a.maxZoom=-1;a.rotationEnabled=!0;a.snapToZoom=!0;return a}n(a,r);a.prototype.initialize=function(){this.watch("_zoom, _rotation",this.emit.bind(this,"update"),!0)};a.prototype.destroy=function(){this.view=null;this._set("_zoom",null);this._set("_rotation",null)};Object.defineProperty(a.prototype,"_rotation",{get:function(){return new c({rotationEnabled:this.rotationEnabled})},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"_defaultLODs",{get:function(){var a=this.get("view.defaultsFromMap.tileInfo"),b=this.get("view.spatialReference");return a&&b&&a.spatialReference.equals(b)?a.lods:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"_zoom",{get:function(){return new e({lods:this.lods||this._defaultLODs,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale,snapToZoom:this.snapToZoom})},enumerable:!0,
configurable:!0});a.prototype.canZoomInTo=function(a){var b=this.effectiveMaxScale;return 0===b||a>=b};a.prototype.canZoomOutTo=function(a){var b=this.effectiveMinScale;return 0===b||a<=b};a.prototype.constrain=function(a,b){if(!this.enabled)return a;this._zoom.constrain(a,b);this._rotation.constrain(a,b);return a};a.prototype.fit=function(a){if(!this.enabled||!this.snapToZoom)return a;this._zoom.fit(a);return a};a.prototype.zoomToScale=function(a){return this._zoom.zoomToScale(a)};a.prototype.scaleToZoom=
function(a){return this._zoom.scaleToZoom(a)};a.prototype.snapScale=function(a){return this._zoom.snapToClosestScale(a)};a.prototype.snapToNextScale=function(a){return this._zoom.snapToNextScale(a)};a.prototype.snapToPreviousScale=function(a){return this._zoom.snapToPreviousScale(a)};d([f.property({readOnly:!0,aliasOf:"_zoom.effectiveLODs"})],a.prototype,"effectiveLODs",void 0);d([f.property({readOnly:!0,aliasOf:"_zoom.effectiveMinScale"})],a.prototype,"effectiveMinScale",void 0);d([f.property({readOnly:!0,
aliasOf:"_zoom.effectiveMaxScale"})],a.prototype,"effectiveMaxScale",void 0);d([f.property({readOnly:!0,aliasOf:"_zoom.effectiveMinZoom"})],a.prototype,"effectiveMinZoom",void 0);d([f.property({readOnly:!0,aliasOf:"_zoom.effectiveMaxZoom"})],a.prototype,"effectiveMaxZoom",void 0);d([f.property()],a.prototype,"enabled",void 0);d([f.property({type:[b]})],a.prototype,"lods",void 0);d([f.property()],a.prototype,"minScale",void 0);d([f.property()],a.prototype,"maxScale",void 0);d([f.property()],a.prototype,
"minZoom",void 0);d([f.property()],a.prototype,"maxZoom",void 0);d([f.property()],a.prototype,"rotationEnabled",void 0);d([f.property()],a.prototype,"snapToZoom",void 0);d([f.property()],a.prototype,"view",void 0);d([f.property({type:c,dependsOn:["rotationEnabled"]})],a.prototype,"_rotation",null);d([f.property({dependsOn:["view.spatialReference","view.defaultsFromMap.tileInfo"]})],a.prototype,"_defaultLODs",null);d([f.property({readOnly:!0,type:e,dependsOn:"lods minZoom maxZoom minScale maxScale snapToZoom _defaultLODs".split(" ")})],
a.prototype,"_zoom",null);return a=d([f.subclass("esri.views.2d.MapViewConstraints")],a)}(f.declared(h,m))})},"esri/views/2d/constraints/RotationConstraint":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/accessorSupport/decorators".split(" "),function(q,g,n,d,h,m){return function(f){function b(){var b=null!==f&&f.apply(this,arguments)||this;b.enabled=!0;b.rotationEnabled=!0;return b}n(b,f);
c=b;b.prototype.constrain=function(b,c){if(!this.enabled||!c)return b;this.rotationEnabled||(b.rotation=c.rotation);return b};b.prototype.clone=function(){return new c({enabled:this.enabled,rotationEnabled:this.rotationEnabled})};var c;d([m.property()],b.prototype,"enabled",void 0);d([m.property()],b.prototype,"rotationEnabled",void 0);return b=c=d([m.subclass("esri.views.2d.constraints.RotationConstraint")],b)}(m.declared(h))})},"esri/views/2d/constraints/ZoomConstraint":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/accessorSupport/decorators ../../../layers/support/LOD".split(" "),
function(q,g,n,d,h,m,f){return function(b){function c(){var c=null!==b&&b.apply(this,arguments)||this;c._lodByScale={};c._scales=[];c.effectiveLODs=null;c.effectiveMinZoom=-1;c.effectiveMaxZoom=-1;c.effectiveMinScale=0;c.effectiveMaxScale=0;c.enabled=!0;c.lods=null;c.minZoom=-1;c.maxZoom=-1;c.minScale=0;c.maxScale=0;c.snapToZoom=!0;return c}n(c,b);e=c;c.prototype.initialize=function(){var b=this,a,c,d=this.lods;c=this.minScale;a=this.maxScale;var e=this.minZoom,l=this.maxZoom,k=-1,f=-1,h=!1,m=!1;
0!==c&&0!==a&&c<a&&(a=[a,c],c=a[0],a=a[1]);if(d&&d.length){d=d.map(function(a){return a.clone()});d.sort(function(a,b){return b.scale-a.scale});d.forEach(function(a,b){return a.level=b});for(var n,g=0,q=d;g<q.length;g++){var y=q[g];!h&&0<c&&c>=y.scale&&(k=y.level,h=!0);!m&&0<a&&a>=y.scale&&(f=n?n.level:-1,m=!0);n=y}-1===e&&(e=0===c?0:k);-1===l&&(l=0===a?d.length-1:f);e=Math.max(e,0);e=Math.min(e,d.length-1);l=Math.max(l,0);l=Math.min(l,d.length-1);e>l&&(c=[l,e],e=c[0],l=c[1]);c=d[e].scale;a=d[l].scale;
d.splice(0,e);d.splice(l-e+1,d.length);d.forEach(function(a,c){b._lodByScale[a.scale]=a;b._scales[c]=a.scale});this._set("effectiveLODs",d);this._set("effectiveMinZoom",e);this._set("effectiveMaxZoom",l)}this._set("effectiveMinScale",c);this._set("effectiveMaxScale",a)};c.prototype.constrain=function(b,a){if(!this.enabled||a&&b.scale===a.scale)return b;var c=this.effectiveMinScale,d=this.effectiveMaxScale,e=b.targetGeometry,l=a&&a.targetGeometry,k=0!==c&&b.scale>c;if(0!==d&&b.scale<d||k)c=k?c:d,l&&
(a=(c-a.scale)/(b.scale-a.scale),e.x=l.x+(e.x-l.x)*a,e.y=l.y+(e.y-l.y)*a),b.scale=c;this.snapToZoom&&this.effectiveLODs&&(b.scale=this._getClosestScale(b.scale));return b};c.prototype.fit=function(b){if(!this.effectiveLODs)return this.constrain(b,null);var a=this.scaleToZoom(b.scale);b.scale=this.zoomToScale(.99<Math.abs(a-Math.floor(a))?Math.round(a):Math.floor(a));return b};c.prototype.zoomToScale=function(b){if(!this.effectiveLODs)return 0;b-=this.effectiveMinZoom;b=Math.max(0,b);var a=this._scales;
if(0>=b)return a[0];if(b>=a.length)return a[a.length-1];var c=Math.round(b);return a[c]+(c-b)*(a[Math.round(b-.5)]-a[c])};c.prototype.scaleToZoom=function(b){if(!this.effectiveLODs)return-1;var a=this._scales,c=0,d=a.length-1,e,l;for(c;c<d;c++){e=a[c];l=a[c+1];if(e<=b)return c+this.effectiveMinZoom;if(l===b)return c+1+this.effectiveMinZoom;if(e>b&&l<b)return c+1-(b-l)/(e-l)+this.effectiveMinZoom}return c};c.prototype.snapToClosestScale=function(b){if(!this.effectiveLODs)return b;b=this.scaleToZoom(b);
return this.zoomToScale(Math.round(b))};c.prototype.snapToNextScale=function(b,a){void 0===a&&(a=.5);if(!this.effectiveLODs)return b*a;b=Math.round(this.scaleToZoom(b));return this.zoomToScale(b+1)};c.prototype.snapToPreviousScale=function(b,a){void 0===a&&(a=2);if(!this.effectiveLODs)return b*a;b=Math.round(this.scaleToZoom(b));return this.zoomToScale(b-1)};c.prototype.clone=function(){return new e({enabled:this.enabled,lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,
maxScale:this.maxScale})};c.prototype._getClosestScale=function(b){if(this._lodByScale[b])return this._lodByScale[b].scale;b=this._scales.reduce(function(a,c,d,e){return Math.abs(c-b)<=Math.abs(a-b)?c:a},this._scales[0]);return this._lodByScale[b].scale};var e;d([m.property({readOnly:!0})],c.prototype,"effectiveLODs",void 0);d([m.property({readOnly:!0})],c.prototype,"effectiveMinZoom",void 0);d([m.property({readOnly:!0})],c.prototype,"effectiveMaxZoom",void 0);d([m.property({readOnly:!0})],c.prototype,
"effectiveMinScale",void 0);d([m.property({readOnly:!0})],c.prototype,"effectiveMaxScale",void 0);d([m.property()],c.prototype,"enabled",void 0);d([m.property({type:[f]})],c.prototype,"lods",void 0);d([m.property()],c.prototype,"minZoom",void 0);d([m.property()],c.prototype,"maxZoom",void 0);d([m.property()],c.prototype,"minScale",void 0);d([m.property()],c.prototype,"maxScale",void 0);d([m.property()],c.prototype,"snapToZoom",void 0);return c=e=d([m.subclass("esri.views.2d.constraints.ZoomConstraint")],
c)}(m.declared(h))})},"esri/views/2d/PaddedViewState":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ./../../core/libs/gl-matrix-2/gl-matrix ./viewpointUtils ./ViewState".split(" "),function(q,g,n,d,h,m,f,b,c){var e=function(b){function a(){var a=null!==b&&b.apply(this,arguments)||this;a.left=0;a.top=0;a.right=0;a.bottom=0;return a}n(a,b);d([m.property()],a.prototype,"left",
void 0);d([m.property()],a.prototype,"top",void 0);d([m.property()],a.prototype,"right",void 0);d([m.property()],a.prototype,"bottom",void 0);return a=d([m.subclass("esri.views.2d.PaddedViewState.Padding")],a)}(m.declared(h));return function(h){function a(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];var d=h.apply(this,a)||this;d.content=new c;d._updateContent=function(){var a=f.vec2f64.create();return function(){var b=d._get("size"),c=d._get("padding");if(b&&c){var e=d.content;f.vec2.set(a,
c.left+c.right,c.top+c.bottom);f.vec2.subtract(a,b,a);f.vec2.copy(e.size,a);if(b=e.viewpoint)d.viewpoint=b}}}();d.watch(["size","padding"],d._updateContent,!0);d.padding=new e;d.size=[0,0];return d}n(a,h);Object.defineProperty(a.prototype,"padding",{set:function(a){this._set("padding",a||new e)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"viewpoint",{set:function(a){if(a){var c=a.clone();this.content.viewpoint=a;b.addPadding(c,a,this._get("size"),this._get("padding"));a=this._viewpoint2D;
var d=c.targetGeometry;a.center[0]=d.x;a.center[1]=d.y;a.rotation=c.rotation;a.scale=c.scale;a.spatialReference=d.spatialReference;this._update()}},enumerable:!0,configurable:!0});d([m.property()],a.prototype,"content",void 0);d([m.property({type:e})],a.prototype,"padding",null);d([m.property()],a.prototype,"viewpoint",null);return a=d([m.subclass("esri.views.2d.PaddedViewState")],a)}(m.declared(c))})},"esri/views/2d/ViewState":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../geometry ../../Viewpoint ../../core/JSONSupport ../../core/accessorSupport/decorators ./../../core/libs/gl-matrix-2/gl-matrix ../../core/libs/gl-matrix-2/types/vec2 ./viewpointUtils".split(" "),
function(q,g,n,d,h,m,f,b,c,e,r){var a=[0,0];return function(f){function p(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];a=f.apply(this,a)||this;a._viewpoint2D={center:c.vec2f64.create(),rotation:0,scale:0,spatialReference:null};a.center=[0,0];a.extent=new h.Extent;a.id=0;a.inverseTransform=c.mat2df64.create();a.resolution=0;a.rotation=0;a.scale=0;a.transform=c.mat2df64.create();a.transformNoRotation=c.mat2df64.create();a.displayMat3=c.mat3f32.create();a.displayViewMat3=c.mat3f32.create();
a.viewMat3=c.mat3f32.create();a.viewMat2d=c.mat2df32.create();a.worldScreenWidth=0;a.size=[0,0];return a}n(p,f);t=p;Object.defineProperty(p.prototype,"pixelRatio",{set:function(a){this._set("pixelRatio",a);this._update()},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"size",{set:function(a){this._set("size",a);this._update()},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"viewpoint",{set:function(a){if(a){var b=this._viewpoint2D,c=a.targetGeometry;b.center[0]=
c.x;b.center[1]=c.y;b.rotation=a.rotation;b.scale=a.scale;b.spatialReference=c.spatialReference}this._update()},enumerable:!0,configurable:!0});p.prototype.copy=function(a){var b=this.size,d=this.viewpoint;d&&b?(this.viewpoint=r.copy(d,a.viewpoint),this._set("size",c.vec2.copy(b,a.size))):(this.viewpoint=a.viewpoint.clone(),this._set("size",[a.size[0],a.size[1]]));this._set("pixelRatio",a.pixelRatio);return this};p.prototype.clone=function(){return new t({size:this.size,viewpoint:this.viewpoint.clone(),
pixelRatio:this.pixelRatio})};p.prototype.toMap=function(b,d,f){if(e.isVec2(d))return c.vec2.transformMat2d(b,d,this.inverseTransform);a[0]=d;a[1]=f;return c.vec2.transformMat2d(b,a,this.inverseTransform)};p.prototype.toScreen=function(b,d,f){if(e.isVec2(d))return c.vec2.transformMat2d(b,d,this.transform);a[0]=d;a[1]=f;return c.vec2.transformMat2d(b,a,this.transform)};p.prototype.toScreenNoRotation=function(b,d,f){if(e.isVec2(d))return c.vec2.transformMat2d(b,d,this.transformNoRotation);a[0]=d;a[1]=
f;return c.vec2.transformMat2d(b,a,this.transformNoRotation)};p.prototype.pixelSizeAt=function(a){return r.pixelSizeAt(a,this.viewpoint,this.size)};p.prototype.getScreenTransform=function(a,b){var c=this._viewpoint2D.center,d=this._get("pixelRatio")||1,e=this._get("size");r.getMatrix(a,c,e,b,0,d);return a};p.prototype._update=function(){var a=this._viewpoint2D,b=a.center,d=a.spatialReference,e=a.scale,f=a.rotation,a=this._get("pixelRatio")||1,p=this._get("size");this._set("id",this.id+1);var t=new m({targetGeometry:new h.Point(b[0],
b[1],d),scale:e,rotation:f});this._set("viewpoint",t);if(p&&d&&e)return this.resolution=r.getResolution(t),this.rotation=f,this.scale=e,this.spatialReference=d,c.vec2.copy(this.center,b),c.mat3.set(this.displayMat3,2/p[0],0,0,0,-2/p[1],0,-1,1,1),e=c.mat3.identity(this.viewMat3),b=c.vec2f32.fromValues(p[0]/2,p[1]/2),d=c.vec2f32.fromValues(-p[0]/2,-p[1]/2),f=c.common.toRadian(f),c.mat3.translate(e,e,b),c.mat3.rotate(e,e,f),c.mat3.translate(e,e,d),c.mat3.multiply(this.displayViewMat3,this.displayMat3,
e),e=c.mat2d.identity(this.viewMat2d),c.mat2d.translate(e,e,b),c.mat2d.rotate(e,e,f),c.mat2d.translate(e,e,d),r.getExtent(this.extent,t,p),r.getTransform(this.transform,t,p,a),c.mat2d.invert(this.inverseTransform,this.transform),r.getTransformNoRotation(this.transformNoRotation,t,p,a),this.worldScreenWidth=r.getWorldScreenWidth(this.spatialReference,this.resolution),this};var t;d([b.property({readOnly:!0})],p.prototype,"id",void 0);d([b.property({value:1,json:{write:!0}})],p.prototype,"pixelRatio",
null);d([b.property({json:{write:!0}})],p.prototype,"size",null);d([b.property({type:m,json:{write:!0}})],p.prototype,"viewpoint",null);return p=t=d([b.subclass("esri.views.2d.ViewState")],p)}(b.declared(f))})},"esri/core/libs/gl-matrix-2/types/vec2":function(){define(["require","exports"],function(q,g){function n(d){return d instanceof Float32Array&&2<=d.length}function d(d){return Array.isArray(d)&&2<=d.length}Object.defineProperty(g,"__esModule",{value:!0});g.isVec2f32=n;g.isVec2f64=d;g.isVec2=
function(h){return n(h)||d(h)}})},"esri/views/2d/tiling":function(){define("require exports ./tiling/TileInfoView ./tiling/TileKey ./tiling/TileQueue ./tiling/TileStrategy".split(" "),function(q,g,n,d,h,m){Object.defineProperty(g,"__esModule",{value:!0});g.TileInfoView=n;g.TileKey=d;g.TileQueue=h;g.TileStrategy=m})},"esri/views/2d/tiling/TileInfoView":function(){define("require exports ../../../geometry/support/spatialReferenceUtils ./LODInfo ./TileCoverage ./TileKey ./TileSpan".split(" "),function(q,
g,n,d,h,m,f){var b=new m("0/0/0/0"),c=function(){function b(a,b,c,d,e,k,f,h){this.x=a;this.ymin=b;this.ymax=c;this.invM=d;this.leftAdjust=e;this.rightAdjust=k;this.leftBound=f;this.rightBound=h}b.create=function(a,c){var d;a[1]>c[1]&&(d=[c,a],a=d[0],c=d[1]);d=a[0];a=a[1];var e=c[0];c=c[1];var l=e-d,k=c-a,k=0!==k?l/k:0,f=(Math.ceil(a)-a)*k,h=(Math.floor(a)-a)*k;return new b(d,Math.floor(a),Math.ceil(c),k,0>l?f:h,0>l?h:f,0>l?e:d,0>l?d:e)};b.prototype.incrRow=function(){this.x+=this.invM};b.prototype.getLeftCol=
function(){return Math.max(this.x+this.leftAdjust,this.leftBound)};b.prototype.getRightCol=function(){return Math.min(this.x+this.rightAdjust,this.rightBound)};return b}(),e=[[0,0],[0,0],[0,0],[0,0]];return function(){function r(a,b){var c=this;this.tileInfo=a;this.fullExtent=b;this.scales=[];this._lodInfos=null;this._infoByScale={};this._infoByLevel={};var e=a.lods.slice();e.sort(function(a,b){return b.scale-a.scale});var l=this._lodInfos=e.map(function(c){return d.create(a,c,b)});e.forEach(function(a,
b){c._infoByLevel[a.level]=l[b];c._infoByScale[a.scale]=l[b];c.scales[b]=a.scale},this);this._wrap=a.isWrappable}Object.defineProperty(r.prototype,"spatialReference",{get:function(){return this.tileInfo.spatialReference},enumerable:!0,configurable:!0});r.prototype.getLODInfoAt=function(a){return this._infoByLevel["number"===typeof a?a:a.level]};r.prototype.getTileBounds=function(a,c,d){void 0===d&&(d=!1);b.set(c);return(c=this._infoByLevel[b.level])?c.getTileBounds(a,b,d):a};r.prototype.getTileCoords=
function(a,c,d){void 0===d&&(d=!1);b.set(c);return(c=this._infoByLevel[b.level])?c.getTileCoords(a,b,d):a};r.prototype.getTileCoverage=function(a,b,d){void 0===b&&(b=192);void 0===d&&(d="closest");d="closest"===d?this.getClosestInfoForScale(a.scale):this.getSmallestInfoForScale(a.scale);var p=h.pool.acquire(d),l=this._wrap,k;k=Infinity;var r=-Infinity,m,t,n=p.spans;e[0][0]=e[0][1]=e[1][1]=e[3][0]=-b;e[1][0]=e[2][0]=a.size[0]+b;e[2][1]=e[3][1]=a.size[1]+b;for(b=0;b<e.length;b++){var g=e[b];a.toMap(g,
g);g[0]=d.getColumnForX(g[0]);g[1]=d.getRowForY(g[1])}a=[];g=3;for(b=0;4>b;b++){if(e[b][1]!==e[g][1]){var q=c.create(e[b],e[g]);k=Math.min(q.ymin,k);r=Math.max(q.ymax,r);void 0===a[q.ymin]&&(a[q.ymin]=[]);a[q.ymin].push(q)}g=b}if(null==k||null==r||100<r-k)return null;for(g=[];k<r;){null!=a[k]&&(g=g.concat(a[k]));m=Infinity;t=-Infinity;for(b=g.length-1;0<=b;b--)q=g[b],m=Math.min(m,q.getLeftCol()),t=Math.max(t,q.getRightCol());m=Math.floor(m);t=Math.floor(t);if(k>=d.first[1]&&k<=d.last[1])if(l)if(d.size[0]<
d.worldSize[0])for(q=Math.floor(t/d.worldSize[0]),b=Math.floor(m/d.worldSize[0]);b<=q;b++)n.push(new f(k,Math.max(d.getFirstColumnForWorld(b),m),Math.min(d.getLastColumnForWorld(b),t)));else n.push(new f(k,m,t));else m>d.last[0]||t<d.first[0]||(m=Math.max(m,d.first[0]),t=Math.min(t,d.last[0]),n.push(new f(k,m,t)));k+=1;for(b=g.length-1;0<=b;b--)q=g[b],q.ymax>=k?q.incrRow():g.splice(b,1)}return p};r.prototype.getTileParentId=function(a){b.set(a);a=this._lodInfos.indexOf(this._infoByLevel[b.level])-
1;if(0>a)return null;this._getTileIdAtLOD(b,this._lodInfos[a],b);return b.id};r.prototype.getTileResolution=function(a){return(a=this._infoByLevel["object"===typeof a?a.level:a])?a.resolution:-1};r.prototype.getTileScale=function(a){return(a=this._infoByLevel[a.level])?a.scale:-1};r.prototype.intersects=function(a,c){b.set(c);c=this._infoByLevel[b.level];var d=a.lodInfo;if(d.resolution>c.resolution){this._getTileIdAtLOD(b,d,b);for(var e=d.denormalizeCol(b.col,b.world),l=0,k=a.spans;l<k.length;l++){var f=
k[l];if(f.row===b.row&&f.colFrom<=e&&f.colTo>=e)return!0}}if(d.resolution<c.resolution){k=a.spans.reduce(function(a,b){a[0]=Math.min(a[0],b.row);a[1]=Math.max(a[1],b.row);a[2]=Math.min(a[2],b.colFrom);a[3]=Math.max(a[3],b.colTo);return a},[Infinity,-Infinity,Infinity,-Infinity]);a=k[0];var e=k[1],l=k[2],k=k[3],h=c.denormalizeCol(b.col,b.world),f=d.getColumnForX(c.getXForColumn(h)),m=d.getRowForY(c.getYForRow(b.row)),h=d.getColumnForX(c.getXForColumn(h+1))-1;c=d.getRowForY(c.getYForRow(b.row+1))-1;
return!(f>k||h<l||m>e||c<a)}var r=d.denormalizeCol(b.col,b.world);return a.spans.some(function(a){return a.row===b.row&&a.colFrom<=r&&a.colTo>=r})};r.prototype.normalizeBounds=function(a,b,c){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];this._wrap&&(b=n.getInfo(this.tileInfo.spatialReference),c=-c*(b.valid[1]-b.valid[0]),a[0]+=c,a[2]+=c);return a};r.prototype.getSmallestInfoForScale=function(a){var b=this.scales;if(this._infoByScale[a])return this._infoByScale[a];if(a>b[0])return this._infoByScale[b[0]];
for(var c=1;c<b.length-1;c++)if(a>b[c])return this._infoByScale[b[c-1]];return this._infoByScale[b[b.length-1]]};r.prototype.getClosestInfoForScale=function(a){var b=this.scales;this._infoByScale[a]||(a=b.reduce(function(b,c,d,e){return Math.abs(c-a)<Math.abs(b-a)?c:b},b[0]));return this._infoByScale[a]};r.prototype.scaleToLevel=function(a){var b=this.scales;if(this._infoByScale[a])return this._infoByScale[a].level;for(var c=b.length-1;0<=c;c--)if(a<b[c])return c===b.length-1?this._infoByScale[b[b.length-
1]].level:this._infoByScale[b[c]].level+(b[c]-a)/(b[c]-b[c+1]);return this._infoByScale[b[0]].level};r.prototype.scaleToZoom=function(a){return this.tileInfo.scaleToZoom(a)};r.prototype._getTileIdAtLOD=function(a,b,c){var d=this._infoByLevel[c.level];a.set(c);if(b.resolution<d.resolution)return null;if(b.resolution===d.resolution)return a;a.level=b.level;a.col=Math.floor(c.col*d.resolution/b.resolution+.01);a.row=Math.floor(c.row*d.resolution/b.resolution+.01);return a};return r}()})},"esri/views/2d/tiling/LODInfo":function(){define(["require",
"exports","../../../geometry/support/spatialReferenceUtils","./TileKey"],function(q,g,n,d){function h(d,b,c){d[0]=b;d[1]=c;return d}var m=new d("0/0/0/0");return function(){function d(b,c,d,f,a,h,p,m,l,k,n,g){this.level=b;this.resolution=c;this.scale=d;this.origin=f;this.first=a;this.last=h;this.size=p;this.norm=m;this.worldStart=l;this.worldEnd=k;this.worldSize=n;this.wrap=g}d.create=function(b,c,e){var f=n.getInfo(b.spatialReference),a=[b.origin.x,b.origin.y],m=[b.size[0]*c.resolution,b.size[1]*
c.resolution],p=[-Infinity,-Infinity],u=[Infinity,Infinity],l=[Infinity,Infinity];e&&(h(p,Math.max(0,Math.floor((e.xmin-a[0])/m[0])),Math.max(0,Math.floor((a[1]-e.ymax)/m[1]))),h(u,Math.max(0,Math.floor((e.xmax-a[0])/m[0])),Math.max(0,Math.floor((a[1]-e.ymin)/m[1]))),h(l,u[0]-p[0]+1,u[1]-p[1]+1));var k;b.isWrappable?(b=[Math.ceil(Math.round(2*f.origin[1]/c.resolution)/b.size[0]),l[1]],f=[Math.floor((f.origin[0]-a[0])/m[0]),p[1]],e=[b[0]+f[0]-1,u[1]],k=!0):(f=p,e=u,b=l,k=!1);return new d(c.level,c.resolution,
c.scale,a,p,u,l,m,f,e,b,k)};d.prototype.normalizeCol=function(b){if(!this.wrap)return b;var c=this.worldSize[0];return 0>b?c-1-Math.abs((b+1)%c):b%c};d.prototype.denormalizeCol=function(b,c){return this.wrap?this.worldSize[0]*c+b:b};d.prototype.getWorldForColumn=function(b){return this.wrap?Math.floor(b/this.worldSize[0]):0};d.prototype.getFirstColumnForWorld=function(b){return b*this.worldSize[0]+this.first[0]};d.prototype.getLastColumnForWorld=function(b){return b*this.worldSize[0]+this.first[0]+
this.size[0]-1};d.prototype.getColumnForX=function(b){return(b-this.origin[0])/this.norm[0]};d.prototype.getXForColumn=function(b){return this.origin[0]+b*this.norm[0]};d.prototype.getRowForY=function(b){return(this.origin[1]-b)/this.norm[1]};d.prototype.getYForRow=function(b){return this.origin[1]-b*this.norm[1]};d.prototype.getTileBounds=function(b,c,d){void 0===d&&(d=!1);m.set(c);var e=d?m.col:this.denormalizeCol(m.col,m.world),a=m.row;c=this.getXForColumn(e);d=this.getYForRow(a+1);e=this.getXForColumn(e+
1);a=this.getYForRow(a);b[0]=c;b[1]=d;b[2]=e;b[3]=a;return b};d.prototype.getTileCoords=function(b,c,d){void 0===d&&(d=!1);m.set(c);c=d?m.col:this.denormalizeCol(m.col,m.world);Array.isArray(b)?h(b,this.getXForColumn(c),this.getYForRow(m.row)):(b.x=this.getXForColumn(c),b.y=this.getYForRow(m.row));return b};return d}()})},"esri/views/2d/tiling/TileKey":function(){define(["require","exports","../../../core/ObjectPool"],function(q,g,n){return function(){function d(d,m,f,b){this.set(d,m,f,b)}d.from=
function(h,m,f,b){return d.pool.acquire(h,m,f,b)};d.getId=function(d,m,f,b){return"object"===typeof d?d.level+"/"+d.row+"/"+d.col+"/"+d.world:d+"/"+m+"/"+f+"/"+b};Object.defineProperty(d.prototype,"key",{get:function(){return this},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"id",{get:function(){return this.toString()},enumerable:!0,configurable:!0});d.prototype.equals=function(d){return this.level===d.level&&this.row===d.row&&this.col===d.col&&this.world===d.world};d.prototype.release=
function(){this.world=this.col=this.row=this.level=0};d.prototype.set=function(d,m,f,b){null==d?this.world=this.col=this.row=this.level=0:"object"===typeof d?(this.level=d.level||0,this.row=d.row||0,this.col=d.col||0,this.world=d.world||0):"string"===typeof d?(d=d.split("/"),m=d[1],f=d[2],b=d[3],this.level=parseFloat(d[0]),this.row=parseFloat(m),this.col=parseFloat(f),this.world=parseFloat(b)):(this.level=+d,this.row=+m,this.col=+f,this.world=+b||0);return this};d.prototype.toString=function(){return this.level+
"/"+this.row+"/"+this.col+"/"+this.world};d.prototype.getChildKeys=function(){var h=this.level+1,m=this.row<<1,f=this.col<<1,b=this.world;return[d.pool.acquire(h,m,f,b),d.pool.acquire(h,m,f+1,b),d.pool.acquire(h,m+1,f,b),d.pool.acquire(h,m+1,f+1,b)]};d.prototype.compareRowMajor=function(d){return this.row<d.row?-1:this.row>d.row?1:this.col<d.col?-1:this.col>d.col?1:0};d.sort=function(h){return h.map(function(m){return d.from(m)}).sort(function(d,f){return d.compareRowMajor(f)}).map(function(d){return d.id})};
d.pool=new n(d,!0,null,25,50);return d}()})},"esri/views/2d/tiling/TileCoverage":function(){define(["require","exports","../../../core/ArrayPool","../../../core/ObjectPool","./TileSpan"],function(q,g,n,d,h){return function(){function m(d){this.lodInfo=d;this.spans=n.acquire()}m.prototype.release=function(){for(var d=0,b=this.spans;d<b.length;d++)h.pool.release(b[d]);n.release(this.spans)};m.prototype.forEach=function(d,b){var c=this.spans,e=this.lodInfo,f=e.level;if(0!==c.length)for(var a=0;a<c.length;a++)for(var m=
c[a],p=m.row,h=m.colTo,m=m.colFrom;m<=h;m++)d.call(b,f,p,e.normalizeCol(m),e.getWorldForColumn(m))};m.pool=new d(m,!0);return m}()})},"esri/views/2d/tiling/TileSpan":function(){define(["require","exports","../../../core/ObjectPool"],function(q,g,n){return function(){function d(d,m,f){this.row=d;this.colFrom=m;this.colTo=f}d.pool=new n(d,!0);return d}()})},"esri/views/2d/tiling/TileQueue":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/QueueProcessor ../../../core/accessorSupport/decorators ../../../core/libs/gl-matrix-2/gl-matrix".split(" "),
function(q,g,n,d,h,m,f,b){function c(a,b){a.length=0;b.forEach(function(b){return a.push(b)});return a}var e=new Set,r=[],a=new Map,t=[0,0];return function(p){function h(a){a=p.call(this,a)||this;a._keysToRequests=new Map;a.concurrency=6;a.process=null;a.strategy="scale-first";a.tileInfoView=null;a.tileServers=null;return a}n(h,p);h.prototype.initialize=function(){var a=this,b="scale-first"===this.strategy?this._peekByScaleFirst.bind(this):this._peekByCenterFirst.bind(this),c=this.tileServers,d=this.concurrency,
e=this.process;this._queues=c&&0<c.length?c.map(function(c){return new m({concurrency:d,process:function(b){b=a._keysToRequests.get(b);return e(b,c)},peeker:b})}):[new m({concurrency:d,process:function(b){b=a._keysToRequests.get(b);return e(b)},peeker:b})]};h.prototype.destroy=function(){this.clear()};Object.defineProperty(h.prototype,"length",{get:function(){return this._queues.reduce(function(a,b){return a+b.length},0)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"onGoingCount",
{get:function(){return this._keysToRequests.size},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"updating",{get:function(){return 0<this.length||0<this.onGoingCount},enumerable:!0,configurable:!0});h.prototype.clear=function(){for(var a=0,b=this._queues;a<b.length;a++)b[a].clear();this._keysToRequests.clear();this.notifyChange("updating")};h.prototype.find=function(a,b){var c=this;b=0;for(var d=this._queues;b<d.length;b++){var e=d[b].find(function(b){return a(c._keysToRequests.get(b).key)});
if(e)return e}};h.prototype.getPromise=function(a){a="string"===typeof a?a:a.id;for(var b=0,c=this._queues;b<c.length;b++){var d=c[b].get(a);if(d)return d}};h.prototype.getRequest=function(a){return this._keysToRequests.get("string"===typeof a?a:a.id)};h.prototype.has=function(a){return"string"===typeof a?this._keysToRequests.has(a):this._keysToRequests.has(a.id)};h.prototype.isOngoing=function(a){var b="string"===typeof a?a:a.id;return this.has(b)&&this._queues.some(function(a){return a.isOngoing(b)})};
h.prototype.pause=function(){for(var a=0,b=this._queues;a<b.length;a++)b[a].pause()};h.prototype.push=function(a){var b=this,c=a.key.id;if(this.has(c))return this.getPromise(c);var d=this._queues[a.key.row%this._queues.length].push(c),e=function(){b._keysToRequests.delete(c);b.notifyChange("updating")};this._keysToRequests.set(c,a);d.then(e,e);this.notifyChange("updating");return d};h.prototype.reset=function(){for(var a=0,b=this._queues;a<b.length;a++)b[a].reset();this.notifyChange("updating")};
h.prototype.resume=function(){for(var a=0,b=this._queues;a<b.length;a++)b[a].resume()};h.prototype._peekByScaleFirst=function(b){if(!this.state)return b[0];for(var d=this.tileInfoView,l=Number.NEGATIVE_INFINITY,f=Number.POSITIVE_INFINITY,h=0;h<b.length;h++){var m=this._keysToRequests.get(b[h]),p=this.tileInfoView.getTileScale(m.key);a.has(p)||(a.set(p,[]),l=Math.max(p,l),f=Math.min(p,f));a.get(p).push(m.key);e.add(p)}var t=this.state.scale;a.has(t)||(c(r,e),r.sort(),t=r.reduce(function(a,b,c,d){return Math.abs(b-
t)<Math.abs(a-t)?b:a},r[0]));t=Math.min(t,l);t=Math.max(t,f);b=a.get(t);var u=d.getClosestInfoForScale(t),n=u.getColumnForX(this.state.center[0]),g=u.getRowForY(this.state.center[1]);b.sort(function(a,b){var c=u.denormalizeCol(a.col,a.world),d=u.denormalizeCol(b.col,b.world);return Math.sqrt((n-c)*(n-c)+(g-a.row)*(g-a.row))-Math.sqrt((n-d)*(n-d)+(g-b.row)*(g-b.row))});e.clear();a.clear();return b[0].id};h.prototype._peekByCenterFirst=function(a){if(!this.state)return a[0];for(var c=this.tileInfoView,
d=this.state.center,e=Number.POSITIVE_INFINITY,l=null,f=0;f<a.length;f++){var h=this._keysToRequests.get(a[f]);c.getTileCoords(t,h.key);var m=b.vec2.distance(t,d);m<e&&(e=m,l=h.key)}return l.id};d([f.property({constructOnly:!0})],h.prototype,"concurrency",void 0);d([f.property({constructOnly:!0})],h.prototype,"process",void 0);d([f.property()],h.prototype,"state",void 0);d([f.property({constructOnly:!0})],h.prototype,"strategy",void 0);d([f.property({constructOnly:!0})],h.prototype,"tileInfoView",
void 0);d([f.property({constructOnly:!0})],h.prototype,"tileServers",void 0);d([f.property({readOnly:!0})],h.prototype,"updating",null);return h=d([f.subclass()],h)}(f.declared(h))})},"esri/core/QueueProcessor":function(){define("require exports ./compilerUtils ./promiseUtils ./Queue ./scheduling".split(" "),function(q,g,n,d,h,m){return function(){function f(b){this._apiPromises=new Map;this._processingItems=new Map;this._isPaused=!1;this._scheduledNextHandle=null;this._pendingProcessing=0;this.concurrency=
1;this.ordered=!1;b.concurrency&&(this.concurrency=b.concurrency);b.ordered&&(this.ordered=!0,this._itemsToProcess=[]);this._queue=new h({peeker:b.peeker});this.process=b.process}Object.defineProperty(f.prototype,"length",{get:function(){return this._processingItems.size+this._queue.length+this._pendingProcessing},enumerable:!0,configurable:!0});f.prototype.clear=function(){this._queue.clear();var b=[];this._processingItems.forEach(function(c){return b.push(c.resultPromise)});this._processingItems.clear();
b.forEach(function(b){return b.cancel()});b.length=0;this._apiPromises.forEach(function(c){return b.push(c)});this._apiPromises.clear();b.forEach(function(b){return b.cancel()});this._cancelNext()};f.prototype.find=function(b,c){var d=this,f=void 0;this._apiPromises.forEach(function(a,e){b.call(c,e)&&(f=d._apiPromises.get(e).promise)});return f};f.prototype.get=function(b){return(b=this._apiPromises.get(b))&&b.promise||void 0};f.prototype.isOngoing=function(b){return this._processingItems.has(b)};
f.prototype.has=function(b){return this._apiPromises.has(b)};f.prototype.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())};f.prototype.push=function(b){var c=this;if(this._apiPromises.has(b))return this._apiPromises.get(b).promise;var e=d.createDeferred(function(d){var a=c._processingItems.get(b);a?a.resultPromise.cancel(d):(c._remove(b),c._scheduleNext())});this._add(b,e);this._scheduleNext();return e.promise};f.prototype.reset=function(){var b=[];this._processingItems.forEach(function(c){return b.push(c)});
this._processingItems.clear();for(var c=0;c<b.length;c++){var d=b[c];d.resultPromise.isFulfilled()?this._processReset(d):(d.isReset=!0,d.resultPromise.cancel())}};f.prototype.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())};f.prototype._scheduleNext=function(){var b=this;this._isPaused||this._scheduledNextHandle||(this._scheduledNextHandle=m.schedule(function(){b._scheduledNextHandle=null;b._next()}))};f.prototype._next=function(){for(;0<this._queue.length&&this._processingItems.size<
this.concurrency;)this._process(this._queue.pop())};f.prototype._processResult=function(b,c){this._remove(b.item);this._scheduleNext();b.dfd.resolve(c)};f.prototype._processError=function(b,c){b.isReset?this._processReset(b):(this._remove(b.item),this._scheduleNext(),b.dfd.reject(c))};f.prototype._processReset=function(b){this._remove(b.item);this._add(b.item,b.dfd);this._scheduleNext()};f.prototype._processOrdered=function(b,c){var d=this;if(b.isReset)this._processReset(b);else{b.result=c;var f=
!1;this._processingItems.forEach(function(a){f||(a.result?d._itemsToProcess.push(a):f=!0)});b=0;for(c=this._itemsToProcess;b<c.length;b++){var a=c[b];!1===a.result.ok?this._processError(a,a.result.error):this._processResult(a,a.result.value)}this._itemsToProcess.length=0}};f.prototype._process=function(b){var c=this;if(!n.isNone(b)){var d=this._apiPromises.get(b);this._pendingProcessing++;var f=this.process(b);this._pendingProcessing--;if(f&&"function"===typeof f.then){var a={item:b,resultPromise:f,
result:null,dfd:d,isReset:!1};this._processingItems.set(b,a);this.ordered?f.then(function(b){return c._processOrdered(a,{ok:!0,value:b})},function(b){return c._processOrdered(a,{ok:!1,error:b})}):f.then(function(b){return c._processResult(a,b)},function(b){return c._processError(a,b)})}else d.resolve(f),this._remove(b)}};f.prototype._add=function(b,c){this._apiPromises.set(b,c);this._queue.push(b)};f.prototype._remove=function(b){this._queue.remove(b);this._apiPromises.delete(b);this._processingItems.delete(b)};
f.prototype._cancelNext=function(){this._scheduledNextHandle&&(this._scheduledNextHandle.remove(),this._scheduledNextHandle=null)};return f}()})},"esri/core/Queue":function(){define(["require","exports"],function(q,g){return function(){function n(d){this._items=[];this._itemSet=new Set;this._peeker=function(d){return d[0]};this._length=0;d&&d.peeker&&(this._peeker=d.peeker)}Object.defineProperty(n.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0});n.prototype.clear=
function(){this._itemSet.clear();this._length=this._items.length=0};n.prototype.peek=function(){if(0!==this._length)return this._peeker(this._items)};n.prototype.push=function(d){this.contains(d)||this._add(d)};n.prototype.contains=function(d){return 0<this._length&&this._itemSet.has(d)};n.prototype.pop=function(){if(0!==this._length){var d=this.peek();this._remove(d);return d}};n.prototype.remove=function(d){this.contains(d)&&this._remove(d)};n.prototype._add=function(d){this._items.push(d);this._itemSet.add(d);
this._length++};n.prototype._remove=function(d){this._itemSet.delete(d);this._items.splice(this._items.indexOf(d),1);this._length--};return n}()})},"esri/views/2d/tiling/TileStrategy":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./TileKey"],function(q,g,n,d){var h=new d(0,0,0,0),m=new Map,f=[],b=[];return function(){function c(b){this._previousResolution=Number.POSITIVE_INFINITY;this.cachePolicy="keep";this.coveragePolicy="closest";this.tileIndex=new Map;this.tiles=
[];this.buffer=192;this.acquireTile=b.acquireTile;this.releaseTile=b.releaseTile;this.tileInfoView=b.tileInfoView;b.cachePolicy&&(this.cachePolicy=b.cachePolicy);b.coveragePolicy&&(this.coveragePolicy=b.coveragePolicy);null!=b.buffer&&(this.buffer=b.buffer)}c.prototype.destroy=function(){this.tileIndex.clear()};c.prototype.update=function(c){var d=this,a=this.tileIndex,e=this.tileInfoView.getTileCoverage(c.state,this.buffer,this.coveragePolicy);if(e){var p=e.spans,u=e.lodInfo,l=u.level,k=c.state.resolution,
n=!c.stationary&&k>this._previousResolution;this._previousResolution=k;a.forEach(function(a){return a.visible=!0});this.tiles.length=0;m.clear();var g=0,q=0;if(0<p.length)for(var A=0;A<p.length;A++){c=p[A];for(var x=c.row,z=c.colTo,y=c.colFrom;y<=z;y++)g++,c=h.set(l,x,u.normalizeCol(y),u.getWorldForColumn(y)).id,a.has(c)?(k=a.get(c),k.isReady?(m.set(c,k),q++):n||this._addParentTile(c,m)):(k=this.acquireTile(h),this.tileIndex.set(c,k),n||this._addParentTile(c,m))}var B=q===g;b.length=0;f.length=0;
a.forEach(function(a,c){h.set(c);if(!m.has(c)){var k=d.tileInfoView.intersects(e,h);!k||!n&&B?"purge"===d.cachePolicy?h.level===l&&k||f.push(c):(h.level>l||!k)&&f.push(c):a.isReady?b.push(c):h.level>l&&f.push(c)}});for(p=0;p<b.length;p++)c=b[p],(k=a.get(c))&&k.isReady&&m.set(c,k);for(p=0;p<f.length;p++)c=f[p],k=a.get(c),this.releaseTile(k),a["delete"](c);m.forEach(function(a){return d.tiles.push(a)});a.forEach(function(a){m.has(a.key.id)||(a.visible=!1)});b.length=0;f.length=0;m.clear();return B}};
c.prototype.clear=function(){var b=this,c=this.tileIndex;c.forEach(function(a){b.releaseTile(a)});c.clear()};c.prototype._addParentTile=function(b,c){for(var a=null;;){b=this.tileInfoView.getTileParentId(b);if(!b)break;if(this.tileIndex.has(b)&&(a=this.tileIndex.get(b))&&a.isReady){c.has(a.key.id)||c.set(a.key.id,a);break}}};return c}()})},"esri/views/2d/input/MapViewInputManager":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/Handles ../../../core/watchUtils ../../../core/accessorSupport/decorators ./handlers/DoubleClickZoom ./handlers/DragPan ./handlers/DragRotate ./handlers/GamepadNavigation ./handlers/KeyPan ./handlers/KeyRotate ./handlers/KeyZoom ./handlers/MouseWheelZoom ./handlers/PinchAction ../../input/BrowserEventSource ../../input/InputManager ../../input/ViewEvents ../../input/handlers/PreventContextMenu".split(" "),
function(q,g,n,d,h,m,f,b,c,e,r,a,t,p,u,l,k,w,v,C,A){var x={left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},z={zoomIn:["\x3d","+"],zoomOut:["-","_"]},y={clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"};return function(h){function g(){var a=null!==h&&h.apply(this,arguments)||this;a._handles=new m;return a}n(g,h);g.prototype.initialize=function(){var a=this;this.viewEvents=new C.ViewEvents(this.view);
this._handles.add([f.whenNot(this.view,"ready",function(){return a._disconnect()}),f.when(this.view,"ready",function(){return a._connect()})])};g.prototype.destroy=function(){this._handles&&(this._handles.removeAll(),this._handles=null);this._disconnect();this.viewEvents.destroy();this.viewEvents=null};g.prototype._disconnect=function(){this._inputManager&&(this.viewEvents.disconnect(),this._inputManager.destroy(),this._inputManager=null,this._source.destroy(),this._source=null)};g.prototype._connect=
function(){var b=new w.BrowserEventSource(this.view.surface,this.view.input),d=new v.InputManager(b);d.installHandlers("prevent-context-menu",[new A.PreventContextMenu]);d.installHandlers("navigation",[new k.PinchRotateAndZoom(this.view),new a.GamepadNavigation(this.view),new l.MouseWheelZoom(this.view),new c.DoubleClickZoom(this.view),new e.DragPan(this.view,"primary"),new t.KeyPan(this.view,x),new u.KeyZoom(this.view,z),new p.KeyRotate(this.view,y),new r.DragRotate(this.view,"secondary"),new c.DoubleClickZoom(this.view,
["Ctrl"])]);this.viewEvents.connect(d);this._source=b;this._inputManager=d};d([b.property()],g.prototype,"view",void 0);return g=d([b.subclass("esri.views.2d.input.MapViewInputManager")],g)}(b.declared(h))})},"esri/views/2d/input/handlers/DoubleClickZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler","../../../input/handlers/support"],function(q,g,n,d,h){Object.defineProperty(g,"__esModule",{value:!0});q=function(d){function f(b,c){var e=
d.call(this,!0)||this;e.view=b;e.registerIncoming("double-click",c,function(b){return e._handleDoubleClick(b,c)});return e}n(f,d);f.prototype._handleDoubleClick=function(b,c){h.eventMatchesPointerAction(b.data,"primary")&&(b.stopPropagation(),c?this.view.mapViewNavigation.zoomOut([b.data.x,b.data.y]):this.view.mapViewNavigation.zoomIn([b.data.x,b.data.y]))};return f}(d.InputHandler);g.DoubleClickZoom=q})},"esri/views/input/InputHandler":function(){define(["require","exports","../../core/Logger","./EventMatch"],
function(q,g,n,d){Object.defineProperty(g,"__esModule",{value:!0});var h=n.getLogger("esri.views.input.InputHandler");q=function(){function b(b){this._manager=null;this._incoming={};this._outgoing={};this._outgoingEventTypes=this._incomingEventTypes=this._incomingEventMatches=null;this._hasSideEffects=b}Object.defineProperty(b.prototype,"incomingEventMatches",{get:function(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(var b in this._incoming)for(var d=0,f=this._incoming[b];d<
f.length;d++)this._incomingEventMatches.push(f[d].match)}return this._incomingEventMatches},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"incomingEventTypes",{get:function(){this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(function(b){return b.eventType}));return this._incomingEventTypes},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"outgoingEventTypes",{get:function(){this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing));
return this._outgoingEventTypes},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"hasSideEffects",{get:function(){return this._hasSideEffects},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"hasPendingInputs",{get:function(){return!1},enumerable:!0,configurable:!0});b.prototype.onInstall=function(b){var c=this;this._manager?h.error("This InputHandler has already been registered with an InputManager"):(b.setEventCallback(function(b){return c._handleEvent(b)}),b.setUninstallCallback(function(){return c._onUninstall()}),
this._manager=b)};b.prototype.onUninstall=function(){};b.prototype.registerIncoming=function(b,e,f){var a=this;"function"===typeof e?(f=e,e=[]):e=e||[];b="string"===typeof b?new d.EventMatch(b,e):b;var c=function(){a._incomingEventTypes=null;a._incomingEventMatches=null};e=function(b){var d=a._incoming[b.match.eventType];d&&(b=d.indexOf(b),d.splice(b,1),c(),a._manager&&a._manager.updateDependencies())};f=new m(b,f,{onPause:e,onRemove:e,onResume:function(b){var d=a._incoming[b.match.eventType];d&&
-1===d.indexOf(b)&&(d.push(b),c(),a._manager&&a._manager.updateDependencies())}});e=this._incoming[b.eventType];e||(e=[],this._incoming[b.eventType]=e);e.push(f);c();this._manager&&this._manager.updateDependencies();return f};b.prototype.registerOutgoing=function(b){var c=this;if(this._outgoing[b])throw Error("There is already a callback registered for this outgoing InputEvent: "+b);var d=new f(b,{onEmit:function(a,b,d,e){c._manager.emit(a.eventType,b,d,e)},onRemove:function(a){delete c._outgoing[a.eventType];
c._manager.updateDependencies()}});this._outgoing[b]=d;this._outgoingEventTypes=null;this._manager&&this._manager.updateDependencies();return d};b.prototype.startCapturingPointer=function(b){this._manager.setPointerCapture(b,!0)};b.prototype.stopCapturingPointer=function(b){this._manager.setPointerCapture(b,!1)};b.prototype.refreshHasPendingInputs=function(){this._manager.refreshHasPendingInputs()};b.prototype._onUninstall=function(){this._manager?(this.onUninstall(),this._manager=null):h.error("This InputHandler is not registered with an InputManager")};
b.prototype._handleEvent=function(b){var c=this._incoming[b.type];if(c)for(var d=0;d<c.length;d++){var a=c[d];if(a.match.matches(b)&&(a.callback(b),b.shouldStopPropagation()))break}};return b}();g.InputHandler=q;var m=function(){function b(b,d,f){this.match=b;this._callback=d;this._handler=f}b.prototype.pause=function(){this._handler.onPause(this)};b.prototype.resume=function(){this._handler.onResume(this)};b.prototype.remove=function(){this._handler.onRemove(this)};Object.defineProperty(b.prototype,
"callback",{get:function(){return this._callback},enumerable:!0,configurable:!0});return b}(),f=function(){function b(b,d){this.eventType=b;this._removed=!1;this._handler=d}b.prototype.emit=function(b,d,f){if(!this._removed)this._handler.onEmit(this,b,d,f)};b.prototype.remove=function(){this._removed=!0;this._handler.onRemove(this)};return b}()})},"esri/views/input/EventMatch":function(){define(["require","exports"],function(q,g){Object.defineProperty(g,"__esModule",{value:!0});q=function(){function n(d,
h){void 0===h&&(h=[]);this.eventType=d;this.keyModifiers=h}n.prototype.matches=function(d){if(d.type!==this.eventType)return!1;if(0===this.keyModifiers.length)return!0;d=d.modifiers;for(var h=0,m=this.keyModifiers;h<m.length;h++)if(!d.has(m[h]))return!1;return!0};return n}();g.EventMatch=q})},"esri/views/input/handlers/support":function(){define(["require","exports"],function(q,g){Object.defineProperty(g,"__esModule",{value:!0});g.eventMatchesPointerAction=function(n,d){switch(d){case "primary":return"touch"===
n.pointerType||0===n.button;case "secondary":return"touch"!==n.pointerType&&2===n.button;case "tertiary":return"touch"!==n.pointerType&&1===n.button}};g.eventMatchesMousePointerAction=function(n,d){if("touch"===n.pointerType)return!1;switch(d){case "primary":return 0===n.button;case "secondary":return 2===n.button;case "tertiary":return 1===n.button}}})},"esri/views/2d/input/handlers/DragPan":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../input/DragEventSeparator ../../../input/InputHandler ../../../input/handlers/support".split(" "),
function(q,g,n,d,h,m){Object.defineProperty(g,"__esModule",{value:!0});q=function(f){function b(b,e,h){var a=f.call(this,!0)||this;a.view=b;a.pointerAction=e;a.registerIncoming("drag",h,function(b){return a._handleDrag(b)});a.registerIncoming("pointer-down",function(b){return a.stopMomentumNavigation()});var c=a.view.mapViewNavigation;a.dragEventSeparator=new d.DragEventSeparator({start:function(b,d){c.pan.begin(a.view,d.data);d.stopPropagation()},update:function(b,d){c.pan.update(a.view,d.data);
d.stopPropagation()},end:function(b,d){c.pan.end(a.view,d.data);d.stopPropagation()},condition:function(b,c){return 1===b&&m.eventMatchesPointerAction(c.data,a.pointerAction)}});return a}n(b,f);b.prototype._handleDrag=function(b){var c=this.view.mapViewNavigation;c.pinch.zoomMomentum||c.pinch.rotateMomentum?this.stopMomentumNavigation():this.dragEventSeparator.handle(b)};b.prototype.stopMomentumNavigation=function(){this.view.mapViewNavigation.pan.stopMomentumNavigation()};return b}(h.InputHandler);
g.DragPan=q})},"esri/views/input/DragEventSeparator":function(){define(["require","exports"],function(q,g){Object.defineProperty(g,"__esModule",{value:!0});q=function(){function n(d){this.callbacks=d;this.currentCount=0;this.callbacks.condition||(this.callbacks.condition=function(){return!0})}n.prototype.handle=function(d){var h=d.data,m=h.pointers.size;switch(h.action){case "start":this.currentCount=m;this.emitStart(d);break;case "added":this.emitEnd(this.previousEvent);this.currentCount=m;this.emitStart(d);
break;case "update":this.emitUpdate(d);break;case "removed":this.startEvent&&this.emitEnd(this.previousEvent);this.currentCount=m;this.emitStart(d);break;case "end":this.emitEnd(d),this.currentCount=0}this.previousEvent=d};n.prototype.emitStart=function(d){this.startEvent=d;this.callbacks.condition(this.currentCount,d)&&this.callbacks.start(this.currentCount,d,this.startEvent)};n.prototype.emitUpdate=function(d){this.callbacks.condition(this.currentCount,d)&&this.callbacks.update(this.currentCount,
d,this.startEvent)};n.prototype.emitEnd=function(d){this.callbacks.condition(this.currentCount,d)&&this.callbacks.end(this.currentCount,d,this.startEvent);this.startEvent=null};return n}();g.DragEventSeparator=q})},"esri/views/2d/input/handlers/DragRotate":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../input/DragEventSeparator ../../../input/InputHandler ../../../input/handlers/support".split(" "),function(q,g,n,d,h,m){Object.defineProperty(g,"__esModule",{value:!0});
q=function(f){function b(b,e,h){var a=f.call(this,!0)||this;a.view=b;a.pointerAction=e;var c=a.view.mapViewNavigation;a.dragEventSeparator=new d.DragEventSeparator({start:function(b,d){c.rotate.begin(a.view,d.data);d.stopPropagation()},update:function(b,d){c.rotate.update(a.view,d.data);d.stopPropagation()},end:function(b,d){c.rotate.end(a.view,d.data);d.stopPropagation()},condition:function(b,c){return 1===b&&m.eventMatchesPointerAction(c.data,a.pointerAction)}});a.registerIncoming("drag",h,function(b){return a.dragEventSeparator.handle(b)});
return a}n(b,f);return b}(h.InputHandler);g.DragRotate=q})},"esri/views/2d/input/handlers/GamepadNavigation":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/Handles ../../../../core/scheduling ../../../../core/watchUtils ../../viewpointUtils ../../../input/InputHandler ../../../navigation/gamepadUtils".split(" "),function(q,g,n,d,h,m,f,b,c){Object.defineProperty(g,"__esModule",{value:!0});q=function(b){function p(a){var c=b.call(this,!0)||this;c.view=a;
c.frameTask=null;c.watchHandles=new d;c.currentDevice=null;c.transformation={translation:[0,0,0],heading:0,tilt:0};c.handle=c.registerIncoming("gamepad",function(a){return c.handleEvent(a)});c.handle.pause();return c}n(p,b);p.prototype.onInstall=function(a){var c=this;b.prototype.onInstall.call(this,a);this.watchHandles.add([m.init(this.view.navigation.gamepad,"enabled",function(a){a?(c.handle.resume(),c.frameTask||(c.frameTask=h.addFrameTask({update:function(a){return c.frameUpdate(a.deltaTime)}}))):
(c.handle.pause(),c.frameTask&&(c.frameTask.remove(),c.frameTask=null))})])};p.prototype.onUninstall=function(){this.watchHandles.removeAll();this.frameTask&&(this.frameTask.remove(),this.frameTask=null);b.prototype.onUninstall.call(this)};p.prototype.handleEvent=function(a){var b=this.view.navigation.gamepad.device;b&&a.data.device!==b||this.currentDevice&&this.currentDevice!==a.data.device||("end"===a.data.action?(this.currentDevice=null,c.resetTransformation(this.transformation)):(this.currentDevice=
a.data.device,c.extractTransformation(a.data,this.view.navigation.gamepad,this.transformation)))};p.prototype.frameUpdate=function(b){var d=this.transformation;if(!c.isZeroTransformation(d)){var k=this.view.viewpoint.clone(),h=r*this.view.navigation.gamepad.velocityFactor*b;f.translateBy(k,k,[d.translation[0]*h,-d.translation[1]*h]);h=this.view.size;f.scaleAndRotateBy(k,k,1+d.translation[2]*a*b,this.view.constraints.rotationEnabled?-d.heading*e*b:0,[h[0]/2,h[1]],h);b=this.view.constraints.constrain(k,
this.view.viewpoint);this.view.viewpoint=b}};return p}(b.InputHandler);g.GamepadNavigation=q;var e=.06,r=.7,a=6E-4})},"esri/views/navigation/gamepadUtils":function(){define(["require","exports","../../core/libs/gl-matrix-2/gl-matrix"],function(q,g,n){function d(d){var h=d*d;0>d&&(h*=-1);return h}Object.defineProperty(g,"__esModule",{value:!0});g.quadraticAccentuation=d;g.resetTransformation=function(d){d.translation[0]=0;d.translation[1]=0;d.translation[2]=0;d.heading=0;d.tilt=0;return d};g.extractTransformation=
function(h,m,f){var b=h.state;h=h.device;m="forward-down"===m.tiltDirection?1:-1;"standard"===h.deviceType?(f.translation[0]=d(b.axes[0]),f.translation[1]=d(b.axes[1]),f.translation[2]=d(b.buttons[7])-d(b.buttons[6]),f.heading=d(b.axes[2]),f.tilt=d(b.axes[3])):"spacemouse"===h.deviceType&&(f.translation[0]=1.2*d(b.axes[0]),f.translation[1]=1.2*d(b.axes[1]),f.translation[2]=2*-d(b.axes[2]),f.heading=1.2*d(b.axes[5]),f.tilt=1.2*d(b.axes[3]));f.tilt*=m;n.vec3.scale(f.translation,f.translation,1);return f};
g.isZeroTransformation=function(d){return 0===d.translation[0]&&0===d.translation[1]&&0===d.translation[2]&&0===d.heading&&0===d.tilt}})},"esri/views/2d/input/handlers/KeyPan":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(q,g,n,d){Object.defineProperty(g,"__esModule",{value:!0});q=function(d){function h(f,b,c){var e,h=d.call(this,!0)||this;h.view=f;h.keys=b;h._keyMap=(e={},e[b.left]="left",e[b.right]="right",e[b.up]="up",
e[b.down]="down",e);h.registerIncoming("key-down",c,function(a){return h._handleKeyDown(a)});h.registerIncoming("key-up",c,function(a){return h._handleKeyUp(a)});return h}n(h,d);h.prototype._handleKeyDown=function(d){d.data.repeat||this._handleKey(d,!0)};h.prototype._handleKeyUp=function(d){this._handleKey(d,!1)};h.prototype._handleKey=function(d,b){var c=this._keyMap[d.data.key];if(null!=c){if(b)switch(c){case "left":this.view.mapViewNavigation.continousPanLeft();break;case "right":this.view.mapViewNavigation.continousPanRight();
break;case "up":this.view.mapViewNavigation.continousPanUp();break;case "down":this.view.mapViewNavigation.continousPanDown()}else this.view.mapViewNavigation.stop();d.stopPropagation()}};return h}(d.InputHandler);g.KeyPan=q})},"esri/views/2d/input/handlers/KeyRotate":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(q,g,n,d){Object.defineProperty(g,"__esModule",{value:!0});q=function(d){function h(f,b,c){var e,h=d.call(this,
!0)||this;h.view=f;h.keys=b;h._keyToDirection=(e={},e[b.clockwiseOption1]="clockwise",e[b.clockwiseOption2]="clockwise",e[b.counterClockwiseOption1]="counterClockwise",e[b.counterClockwiseOption2]="counterClockwise",e[b.resetOption1]="reset",e[b.resetOption2]="reset",e);h.registerIncoming("key-down",c,function(a){return h._handleKeyDown(a)});h.registerIncoming("key-up",c,function(a){return h._handleKeyUp(a)});return h}n(h,d);h.prototype._handleKeyDown=function(d){d.data.repeat||this._handleKey(d,
!0)};h.prototype._handleKeyUp=function(d){this._handleKey(d,!1)};h.prototype._handleKey=function(d,b){var c=d.modifiers;0<c.size&&!c.has("Shift")||!this.view.constraints.rotationEnabled||!(c=this._keyToDirection[d.data.key])||(b?"clockwise"===c?this.view.mapViewNavigation.continousRotateClockwise():"counterClockwise"===c?this.view.mapViewNavigation.continousRotateCounterclockwise():this.view.mapViewNavigation.resetRotation():this.view.mapViewNavigation.stop(),d.stopPropagation())};return h}(d.InputHandler);
g.KeyRotate=q})},"esri/views/2d/input/handlers/KeyZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(q,g,n,d){Object.defineProperty(g,"__esModule",{value:!0});var h;(function(d){d[d.IN=0]="IN";d[d.OUT=1]="OUT"})(h||(h={}));q=function(d){function f(b,c,e){var f=d.call(this,!0)||this;f.view=b;f.keys=c;f._keysToZoomAction={};f.registerIncoming("key-down",e,function(a){return f._handleKeyDown(a)});c.zoomIn.forEach(function(a){return f._keysToZoomAction[a]=
h.IN});c.zoomOut.forEach(function(a){return f._keysToZoomAction[a]=h.OUT});return f}n(f,d);f.prototype._handleKeyDown=function(b){this._handleKey(b)};f.prototype._handleKey=function(b){var c=b.modifiers;0<c.size&&!c.has("Shift")||(c=this._keysToZoomAction[b.data.key],c===h.IN?(this.view.mapViewNavigation.zoomIn(),b.stopPropagation()):c===h.OUT&&(this.view.mapViewNavigation.zoomOut(),b.stopPropagation()))};return f}(d.InputHandler);g.KeyZoom=q})},"esri/views/2d/input/handlers/MouseWheelZoom":function(){define(["require",
"exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(q,g,n,d){Object.defineProperty(g,"__esModule",{value:!0});q=function(d){function h(f,b){var c=d.call(this,!0)||this;c.view=f;c._canZoom=!0;c.registerIncoming("mouse-wheel",b,function(b){return c._handleMouseWheel(b)});return c}n(h,d);h.prototype._handleMouseWheel=function(d){var b=this;if(this._canZoom){var c=this.view.mapViewNavigation,e=d.data;if(e=c.zoom(1/Math.pow(.6,1/60*e.deltaY),[e.x,e.y]))this._canZoom=
!1,e.catch(function(b){}).then(function(){b._canZoom=!0;c.end()});d.stopPropagation()}};return h}(d.InputHandler);g.MouseWheelZoom=q})},"esri/views/2d/input/handlers/PinchAction":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/DragEventSeparator","../../../input/InputHandler"],function(q,g,n,d,h){Object.defineProperty(g,"__esModule",{value:!0});q=function(h){function f(b){var c=h.call(this,!0)||this;c.view=b;c.registerIncoming("drag",function(b){return c._handleDrag(b)});
c.registerIncoming("pointer-down",function(b){return c.stopMomentumNavigation()});var e=c.view.mapViewNavigation;c.dragEventSeparator=new d.DragEventSeparator({start:function(b,a){e.pinch.begin(c.view,a.data);a.stopPropagation()},update:function(b,a){e.pinch.update(c.view,a.data);a.stopPropagation()},end:function(b,a){e.pinch.end(c.view,a.data);a.stopPropagation()},condition:function(b){return 2<=b}});return c}n(f,h);f.prototype._handleDrag=function(b){this.dragEventSeparator.handle(b)};f.prototype.stopMomentumNavigation=
function(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()};return f}(h.InputHandler);g.PinchRotateAndZoom=q})},"esri/views/input/BrowserEventSource":function(){define("require exports ../../core/has ../../core/libs/pep/pep ./keys ./gamepad/GamepadSource".split(" "),function(q,g,n,d,h,m){Object.defineProperty(g,"__esModule",{value:!0});var f=n("trident"),b=n("edge"),c=n("chrome"),e=n("ff"),r=n("safari");q=function(){function n(a,b){var c=this;this.input=b;this._active={};this._activePointerCaptures=
new Set;this._keyDownState=new Set;this._eventId=1;this._element=a;d.applyLocal(a);a.getAttribute("tabindex")||a.setAttribute("tabindex","0");this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost};
this._initialCssTouchAction=a.style.touchAction;a.style.touchAction="none";this._element.addEventListener("keydown",this._preventAltKeyDefault);this._gamepadSource=new m.GamepadSource(a,this.input);this._gamepadSource.onEvent=function(a){return c._callback("gamepad",a)}}n.prototype.destroy=function(){var a=this;this.activeEvents=this._callback=null;this._activePointerCaptures.forEach(function(b){a._element.releasePointerCapture(b)});this._gamepadSource&&(this._gamepadSource.destroy(),this._gamepadSource=
null);this._activePointerCaptures=null;this._element.style.touchAction=this._initialCssTouchAction;this._element.removeEventListener("keydown",this._preventAltKeyDefault)};Object.defineProperty(n.prototype,"onEventReceived",{set:function(a){this._callback=a},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"activeEvents",{set:function(b){var c=this,d;for(d in this._active)b&&b.has(d)||(this._element.removeEventListener(a[d],this._active[d]),delete this._active[d]);b&&b.forEach(function(b){if(!c._active[b]&&
a[b]){var d=(c._eventHandlers[b]||c._handleDefault).bind(c,b);c._element.addEventListener(a[b],d);c._active[b]=d}});this._gamepadSource.pollingEnabled=b&&b.has("gamepad")},enumerable:!0,configurable:!0});n.prototype.setPointerCapture=function(a,b){b?(this._element.setPointerCapture(a.pointerId),this._activePointerCaptures.add(a.pointerId)):("pointerup"!==a.type&&this._element.releasePointerCapture(a.pointerId),this._activePointerCaptures.delete(a.pointerId))};n.prototype._updateNormalizedPointerLikeEvent=
function(a,b){var c=this._element.getBoundingClientRect();b.x=a.clientX-Math.round(c.left);b.y=a.clientY-Math.round(c.top);return b};n.prototype._handleKey=function(a,b){var c=h.eventKey(b);c&&"key-up"===a&&this._keyDownState.delete(c);b={native:b,key:c,repeat:c&&this._keyDownState.has(c)};c&&"key-down"===a&&this._keyDownState.add(b.key);this._callback(a,b)};n.prototype._handlePointer=function(a,b){b=this._updateNormalizedPointerLikeEvent(b,{native:b,x:0,y:0,pointerType:b.pointerType,button:b.button,
buttons:b.buttons,eventId:this._eventId++});this._callback(a,b)};n.prototype._handlePointerPreventDefault=function(a,b){var c=this._updateNormalizedPointerLikeEvent(b,{native:b,x:0,y:0,pointerType:b.pointerType,button:b.button,buttons:b.buttons,eventId:this._eventId++});b.preventDefault();this._callback(a,c)};n.prototype._handleMouseWheel=function(a,d){d.preventDefault();var l=d.deltaY;switch(d.deltaMode){case 0:if(f||b)l=l/document.documentElement.clientHeight*600;break;case 1:l*=30;break;case 2:l*=
900}f||b?l*=.7:c||r?l*=.6:e&&(l*=1.375);var k=Math.abs(l);100<k&&(l=l/k*200/(1+Math.exp(-.02*(k-100))));d=this._updateNormalizedPointerLikeEvent(d,{native:d,x:0,y:0,deltaY:l});this._callback(a,d)};n.prototype._handlePointerCaptureLost=function(a,b){this._activePointerCaptures.delete(b.pointerId);this._handleDefault(a,b)};n.prototype._handleDefault=function(a,b){var c={native:b};b.preventDefault();this._callback(a,c)};n.prototype._preventAltKeyDefault=function(a){"Alt"===a.key&&a.preventDefault()};
return n}();g.BrowserEventSource=q;var a={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"}})},"esri/core/libs/pep/pep":function(){define(function(){function q(a,b){b=b||Object.create(null);
var c=document.createEvent("Event");c.initEvent(a,b.bubbles||!1,b.cancelable||!1);a=2;for(var d;a<e.length;a++)d=e[a],c[d]=b[d]||r[a];c.buttons=b.buttons||0;a=0;a=b.pressure?b.pressure:c.buttons?.5:0;c.x=c.clientX;c.y=c.clientY;c.pointerId=b.pointerId||0;c.width=b.width||0;c.height=b.height||0;c.pressure=a;c.tiltX=b.tiltX||0;c.tiltY=b.tiltY||0;c.pointerType=b.pointerType||"";c.hwTimestamp=b.hwTimestamp||0;c.isPrimary=b.isPrimary||!1;return c}function g(){this.array=[];this.size=0}function n(a,b,c,
d){this.addCallback=a.bind(d);this.removeCallback=b.bind(d);this.changedCallback=c.bind(d);z&&(this.observer=new z(this.mutationWatcher.bind(this)))}function d(a){return"body /shadow-deep/ "+h(a)}function h(a){return'[touch-action\x3d"'+a+'"]'}function m(a){return"{ -ms-touch-action: "+a+"; touch-action: "+a+"; touch-action-delay: none; }"}function f(){if(L){B.forEach(function(a){String(a)===a?(D+=h(a)+m(a)+"\n",N&&(D+=d(a)+m(a)+"\n")):(D+=a.selectors.map(h)+m(a.rule)+"\n",N&&(D+=a.selectors.map(d)+
m(a.rule)+"\n"))});var a=document.createElement("style");a.textContent=D;document.head.appendChild(a)}}function b(a){if(!k.pointermap.has(a))throw a=Error("InvalidPointerId"),a.name="InvalidPointerId",a;}function c(a){if(!a.ownerDocument.contains(a))throw a=Error("InvalidStateError"),a.name="InvalidStateError",a;}var e="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget pageX pageY".split(" "),r=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,
0,null,0,0],a=window.Map&&window.Map.prototype.forEach?Map:g;g.prototype={set:function(a,b){if(void 0===b)return this.delete(a);this.has(a)||this.size++;this.array[a]=b},has:function(a){return void 0!==this.array[a]},delete:function(a){this.has(a)&&(delete this.array[a],this.size--)},get:function(a){return this.array[a]},clear:function(){this.size=this.array.length=0},forEach:function(a,b){return this.array.forEach(function(c,d){a.call(b,c,d,this)},this)}};var t="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget buttons pointerId width height pressure tiltX tiltY pointerType hwTimestamp isPrimary type target currentTarget which pageX pageY timeStamp".split(" "),
p=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],u={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},l="undefined"!==typeof SVGElementInstance,k={pointermap:new a,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(a,b){var c=b.events;c&&(c.forEach(function(a){b[a]&&(this.eventMap[a]=b[a].bind(b))},this),this.eventSources[a]=b,this.eventSourceList.push(b))},register:function(a){for(var b=
this.eventSourceList.length,c=0,d;c<b&&(d=this.eventSourceList[c]);c++)d.register.call(d,a)},unregister:function(a){for(var b=this.eventSourceList.length,c=0,d;c<b&&(d=this.eventSourceList[c]);c++)d.unregister.call(d,a)},contains:function(a,b){try{return a.contains(b)}catch(P){return!1}},down:function(a){a.bubbles=!0;this.fireEvent("pointerdown",a)},move:function(a){a.bubbles=!0;this.fireEvent("pointermove",a)},up:function(a){a.bubbles=!0;this.fireEvent("pointerup",a)},enter:function(a){a.bubbles=
!1;this.fireEvent("pointerenter",a)},leave:function(a){a.bubbles=!1;this.fireEvent("pointerleave",a)},over:function(a){a.bubbles=!0;this.fireEvent("pointerover",a)},out:function(a){a.bubbles=!0;this.fireEvent("pointerout",a)},cancel:function(a){a.bubbles=!0;this.fireEvent("pointercancel",a)},leaveOut:function(a){this.out(a);this.propagate(a,this.leave,!1)},enterOver:function(a){this.over(a);this.propagate(a,this.enter,!0)},eventHandler:function(a){if(!a._handledByPE){var b=a.type;(b=this.eventMap&&
this.eventMap[b])&&b(a);a._handledByPE=!0}},listen:function(a,b){b.forEach(function(b){this.addEvent(a,b)},this)},unlisten:function(a,b){b.forEach(function(b){this.removeEvent(a,b)},this)},addEvent:function(a,b){a.addEventListener(b,this.boundHandler)},removeEvent:function(a,b){a.removeEventListener(b,this.boundHandler)},makeEvent:function(a,b){this.captureInfo[b.pointerId]&&(b.relatedTarget=null);a=new q(a,b);b.preventDefault&&(a.preventDefault=b.preventDefault);a._target=a._target||b.target;return a},
fireEvent:function(a,b){a=this.makeEvent(a,b);return this.dispatchEvent(a)},cloneEvent:function(a){for(var b=Object.create(null),c,d=0;d<t.length;d++)c=t[d],b[c]=a[c]||p[d],l&&("target"===c||"relatedTarget"===c)&&b[c]instanceof SVGElementInstance&&(b[c]=b[c].correspondingUseElement);a.preventDefault&&(b.preventDefault=function(){a.preventDefault()});return b},getTarget:function(a){var b=this.captureInfo[a.pointerId];if(!b)return a._target;if(a._target===b||!(a.type in u))return b},propagate:function(a,
b,c){for(var d=a.target,e=[];!d.contains(a.relatedTarget)&&d!==document;)e.push(d),d=d.parentNode;c&&e.reverse();e.forEach(function(c){a.target=c;b.call(this,a)},this)},setCapture:function(a,b){this.captureInfo[a]&&this.releaseCapture(a);this.captureInfo[a]=b;var c=new q("gotpointercapture");c.pointerId=a;this.implicitRelease=this.releaseCapture.bind(this,a);document.addEventListener("pointerup",this.implicitRelease);document.addEventListener("pointercancel",this.implicitRelease);c._target=b;this.asyncDispatchEvent(c)},
releaseCapture:function(a){var b=this.captureInfo[a];if(b){var c=new q("lostpointercapture");c.pointerId=a;this.captureInfo[a]=void 0;document.removeEventListener("pointerup",this.implicitRelease);document.removeEventListener("pointercancel",this.implicitRelease);c._target=b;this.asyncDispatchEvent(c)}},dispatchEvent:function(a){var b=this.getTarget(a);if(b)return b.dispatchEvent(a)},asyncDispatchEvent:function(a){requestAnimationFrame(this.dispatchEvent.bind(this,a))}};k.boundHandler=k.eventHandler.bind(k);
var w={shadow:function(a){if(a)return a.shadowRoot||a.webkitShadowRoot},canTarget:function(a){return a&&!!a.elementFromPoint},targetingShadow:function(a){a=this.shadow(a);if(this.canTarget(a))return a},olderShadow:function(a){var b=a.olderShadowRoot;!b&&(a=a.querySelector("shadow"))&&(b=a.olderShadowRoot);return b},allShadows:function(a){var b=[];for(a=this.shadow(a);a;)b.push(a),a=this.olderShadow(a);return b},searchRoot:function(a,b,c){if(a){var d=a.elementFromPoint(b,c),e;for(e=this.targetingShadow(d);e;){if(a=
e.elementFromPoint(b,c))return d=this.targetingShadow(a),this.searchRoot(d,b,c)||a;e=this.olderShadow(e)}return d}},owner:function(a){for(;a.parentNode;)a=a.parentNode;a.nodeType!==Node.DOCUMENT_NODE&&a.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(a=document);return a},findTarget:function(a){var b=a.clientX,c=a.clientY;a=this.owner(a.target);a.elementFromPoint(b,c)||(a=document);return this.searchRoot(a,b,c)}},v=Array.prototype.forEach.call.bind(Array.prototype.forEach),C=Array.prototype.map.call.bind(Array.prototype.map),
A=Array.prototype.slice.call.bind(Array.prototype.slice),x=Array.prototype.filter.call.bind(Array.prototype.filter),z=window.MutationObserver||window.WebKitMutationObserver,y={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};n.prototype={watchSubtree:function(a){this.observer&&w.canTarget(a)&&this.observer.observe(a,y)},enableOnSubtree:function(a){this.watchSubtree(a);a===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(a)},
installNewSubtree:function(a){v(this.findElements(a),this.addElement,this)},findElements:function(a){return a.querySelectorAll?a.querySelectorAll("[touch-action]"):[]},removeElement:function(a){this.removeCallback(a)},addElement:function(a){this.addCallback(a)},elementChanged:function(a,b){this.changedCallback(a,b)},concatLists:function(a,b){return a.concat(A(b))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},
isElement:function(a){return a.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(a){var b=C(a,this.findElements,this);b.push(x(a,this.isElement));return b.reduce(this.concatLists,[])},mutationWatcher:function(a){a.forEach(this.mutationHandler,this)},mutationHandler:function(a){"childList"===a.type?(this.flattenMutationTree(a.addedNodes).forEach(this.addElement,this),this.flattenMutationTree(a.removedNodes).forEach(this.removeElement,this)):"attributes"===a.type&&this.elementChanged(a.target,
a.oldValue)}};var B=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],D="",L=window.PointerEvent||window.MSPointerEvent,N=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,F=k.pointermap,H=[1,4,2,8,16],I=!1;try{I=1===(new MouseEvent("test",{buttons:1})).buttons}catch(Y){}var G={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(a){k.listen(a,this.events)},unregister:function(a){k.unlisten(a,
this.events)},lastTouches:[],isEventSimulatedFromTouch:function(a){var b=this.lastTouches,c=a.clientX;a=a.clientY;for(var d=0,e=b.length,f;d<e&&(f=b[d]);d++){var l=Math.abs(a-f.y);if(25>=Math.abs(c-f.x)&&25>=l)return!0}},prepareEvent:function(a){var b=k.cloneEvent(a),c=b.preventDefault;b.preventDefault=function(){a.preventDefault();c()};b.pointerId=this.POINTER_ID;b.isPrimary=!0;b.pointerType=this.POINTER_TYPE;return b},prepareButtonsForMove:function(a,b){var c=F.get(this.POINTER_ID);a.buttons=0!==
b.which&&c?c.buttons:0;b.buttons=a.buttons},mousedown:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=F.get(this.POINTER_ID),c=this.prepareEvent(a);I||(c.buttons=H[c.button],b&&(c.buttons|=b.buttons),a.buttons=c.buttons);F.set(this.POINTER_ID,a);b&&0!==b.buttons?k.move(c):k.down(c)}},mousemove:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);I||this.prepareButtonsForMove(b,a);b.button=-1;F.set(this.POINTER_ID,a);k.move(b)}},mouseup:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=
F.get(this.POINTER_ID),c=this.prepareEvent(a);if(!I){var d=H[c.button];c.buttons=b?b.buttons&~d:0;a.buttons=c.buttons}F.set(this.POINTER_ID,a);c.buttons&=~H[c.button];0===c.buttons?k.up(c):k.move(c)}},mouseover:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);I||this.prepareButtonsForMove(b,a);b.button=-1;F.set(this.POINTER_ID,a);k.enterOver(b)}},mouseout:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);I||this.prepareButtonsForMove(b,a);b.button=
-1;k.leaveOut(b)}},cancel:function(a){a=this.prepareEvent(a);k.cancel(a);this.deactivateMouse()},deactivateMouse:function(){F.delete(this.POINTER_ID)}},ea=k.captureInfo,fa=w.findTarget.bind(w),Z=w.allShadows.bind(w),O=k.pointermap,ba,S={events:["touchstart","touchmove","touchend","touchcancel"],register:function(a){ba.enableOnSubtree(a)},unregister:function(a){},elementAdded:function(a){var b=a.getAttribute("touch-action"),c=this.touchActionToScrollType(b);c&&(a._scrollType=c,k.listen(a,this.events),
Z(a).forEach(function(a){a._scrollType=c;k.listen(a,this.events)},this))},elementRemoved:function(a){a._scrollType=void 0;k.unlisten(a,this.events);Z(a).forEach(function(a){a._scrollType=void 0;k.unlisten(a,this.events)},this)},elementChanged:function(a,b){var c=a.getAttribute("touch-action"),d=this.touchActionToScrollType(c);b=this.touchActionToScrollType(b);d&&b?(a._scrollType=d,Z(a).forEach(function(a){a._scrollType=d},this)):b?this.elementRemoved(a):d&&this.elementAdded(a)},scrollTypes:{EMITTER:"none",
XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(a){var b=this.scrollTypes;if("none"===a)return"none";if(a===b.XSCROLLER)return"X";if(a===b.YSCROLLER)return"Y";if(b.SCROLLER.exec(a))return"XY"},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(a){return this.firstTouch===a.identifier},setPrimaryTouch:function(a){if(0===O.size||1===O.size&&O.has(1))this.firstTouch=a.identifier,this.firstXY={X:a.clientX,Y:a.clientY},this.scrolling=
!1,this.cancelResetClickCount()},removePrimaryPointer:function(a){a.isPrimary&&(this.firstXY=this.firstTouch=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var a=function(){this.clickCount=0;this.resetId=null}.bind(this);this.resetId=setTimeout(a,200)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(a){var b=0;if("touchstart"===a||"touchmove"===a)b=1;return b},touchToPointer:function(a){var b=this.currentTouchEvent,
c=k.cloneEvent(a),d=c.pointerId=a.identifier+2;c.target=ea[d]||fa(c);c.bubbles=!0;c.cancelable=!0;c.detail=this.clickCount;c.button=0;c.buttons=this.typeToButtons(b.type);c.width=a.radiusX||a.webkitRadiusX||0;c.height=a.radiusY||a.webkitRadiusY||0;c.pressure=a.force||a.webkitForce||.5;c.isPrimary=this.isPrimaryTouch(a);c.pointerType=this.POINTER_TYPE;c.altKey=b.altKey;c.ctrlKey=b.ctrlKey;c.metaKey=b.metaKey;c.shiftKey=b.shiftKey;var e=this;c.preventDefault=function(){e.scrolling=!1;e.firstXY=null;
b.preventDefault()};return c},processTouches:function(a,b){var c=a.changedTouches;this.currentTouchEvent=a;a=0;for(var d;a<c.length;a++)d=c[a],b.call(this,this.touchToPointer(d))},shouldScroll:function(a){if(this.firstXY){var b;b=a.currentTarget._scrollType;if("none"===b)b=!1;else if("XY"===b)b=!0;else{a=a.changedTouches[0];var c="Y"===b?"X":"Y";b=Math.abs(a["client"+b]-this.firstXY[b])>=Math.abs(a["client"+c]-this.firstXY[c])}this.firstXY=null;return b}},findTouch:function(a,b){for(var c=0,d=a.length,
e;c<d&&(e=a[c]);c++)if(e.identifier===b)return!0},vacuumTouches:function(a){var b=a.touches;if(O.size>=b.length){var c=[];O.forEach(function(a,d){1===d||this.findTouch(b,d-2)||c.push(a.out)},this);c.forEach(this.cancelOut,this)}},touchstart:function(a){this.vacuumTouches(a);this.setPrimaryTouch(a.changedTouches[0]);this.dedupSynthMouse(a);this.scrolling||(this.clickCount++,this.processTouches(a,this.overDown))},overDown:function(a){O.set(a.pointerId,{target:a.target,out:a,outTarget:a.target});k.enterOver(a);
k.down(a)},touchmove:function(a){this.scrolling||(this.shouldScroll(a)?(this.scrolling=!0,this.touchcancel(a)):(a.preventDefault(),this.processTouches(a,this.moveOverOut)))},moveOverOut:function(a){var b=O.get(a.pointerId);if(b){var c=b.out,d=b.outTarget;k.move(a);c&&d!==a.target&&(c.relatedTarget=a.target,a.relatedTarget=d,c.target=d,a.target?(k.leaveOut(c),k.enterOver(a)):(a.target=d,a.relatedTarget=null,this.cancelOut(a)));b.out=a;b.outTarget=a.target}},touchend:function(a){this.dedupSynthMouse(a);
this.processTouches(a,this.upOut)},upOut:function(a){this.scrolling||(k.up(a),k.leaveOut(a));this.cleanUpPointer(a)},touchcancel:function(a){this.processTouches(a,this.cancelOut)},cancelOut:function(a){k.cancel(a);k.leaveOut(a);this.cleanUpPointer(a)},cleanUpPointer:function(a){O.delete(a.pointerId);this.removePrimaryPointer(a)},dedupSynthMouse:function(a){var b=G.lastTouches;a=a.changedTouches[0];this.isPrimaryTouch(a)&&(a={x:a.clientX,y:a.clientY},b.push(a),b=function(a,b){b=a.indexOf(b);-1<b&&
a.splice(b,1)}.bind(null,b,a),setTimeout(b,2500))}};ba=new n(S.elementAdded,S.elementRemoved,S.elementChanged,S);var ca=k.pointermap,ga=window.MSPointerEvent&&"number"===typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,da={events:"MSPointerDown MSPointerMove MSPointerUp MSPointerOut MSPointerOver MSPointerCancel MSGotPointerCapture MSLostPointerCapture".split(" "),register:function(a){k.listen(a,this.events)},unregister:function(a){k.unlisten(a,this.events)},POINTER_TYPES:["","unavailable","touch",
"pen","mouse"],prepareEvent:function(a){var b=a;ga&&(b=k.cloneEvent(a),b.pointerType=this.POINTER_TYPES[a.pointerType]);return b},cleanup:function(a){ca.delete(a)},MSPointerDown:function(a){ca.set(a.pointerId,a);a=this.prepareEvent(a);k.down(a)},MSPointerMove:function(a){a=this.prepareEvent(a);k.move(a)},MSPointerUp:function(a){var b=this.prepareEvent(a);k.up(b);this.cleanup(a.pointerId)},MSPointerOut:function(a){a=this.prepareEvent(a);k.leaveOut(a)},MSPointerOver:function(a){a=this.prepareEvent(a);
k.enterOver(a)},MSPointerCancel:function(a){var b=this.prepareEvent(a);k.cancel(b);this.cleanup(a.pointerId)},MSLostPointerCapture:function(a){a=k.makeEvent("lostpointercapture",a);k.dispatchEvent(a)},MSGotPointerCapture:function(a){a=k.makeEvent("gotpointercapture",a);k.dispatchEvent(a)}},W,X;window.navigator.msPointerEnabled?(W=function(a){b(a);c(this);0!==k.pointermap.get(a).buttons&&this.msSetPointerCapture(a)},X=function(a){b(a);this.msReleasePointerCapture(a)}):(W=function(a){b(a);c(this);0!==
k.pointermap.get(a).buttons&&k.setCapture(a,this)},X=function(a){b(a);k.releaseCapture(a,this)});var ha=window.PointerEvent||window.MSPointerEvent;return{dispatcher:k,Installer:n,PointerEvent:q,PointerMap:a,targetFinding:w,applyGlobal:function(){f();window.PointerEvent||(window.PointerEvent=q,window.navigator.msPointerEnabled?(Object.defineProperty(window.navigator,"maxTouchPoints",{value:window.navigator.msMaxTouchPoints,enumerable:!0}),k.registerSource("ms",da)):(k.registerSource("mouse",G),void 0!==
window.ontouchstart&&k.registerSource("touch",S)),k.register(document));window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:W},releasePointerCapture:{value:X}})},applyLocal:function(a){ha||(window.PointerEvent||(window.navigator.msPointerEnabled?k.registerSource("ms",da):(k.registerSource("mouse",G),void 0!==window.ontouchstart&&k.registerSource("touch",S)),k.register(document)),window.Element&&!Element.prototype.setPointerCapture&&
(a.setPointerCapture=W.bind(a),a.releasePointerCapture=X.bind(a)),a.getAttribute("touch-action")||a.setAttribute("touch-action","none"))}}})},"esri/views/input/keys":function(){define(["require","exports","../../core/has"],function(q,g,n){Object.defineProperty(g,"__esModule",{value:!0});g.primaryKey=n("mac")?"Meta":"Ctrl";var d={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};
for(q=48;58>q;q++)d[q]=String.fromCharCode(q);for(q=1;25>q;q++)d[111+q]="F"+q;for(q=65;91>q;q++)d[q]=[String.fromCharCode(q+32),String.fromCharCode(q)];var h={Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Esc:"Escape"};g.eventKey=function(m){if(void 0!==m.key)return h[m.key]||m.key;var f=d[m.keyCode];return Array.isArray(f)?m.shiftKey?f[1]:f[0]:f};g.isSystemModifier=function(d){switch(d){case "Ctrl":case "Alt":case "Shift":case "Meta":case "Primary":return!0}}})},"esri/views/input/gamepad/GamepadSource":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/scheduling ./GamepadInputDevice ./GamepadState".split(" "),
function(q,g,n,d,h,m){Object.defineProperty(g,"__esModule",{value:!0});q=function(){function f(b,c){var d=this;this.element=b;this.input=c;this.handleGamepadConnectedEvent=function(b){d.handleGamepadConnected(b.gamepad)};this.handleGamepadDisconnectedEvent=function(b){b=b.gamepad;var a=d.inputDevices[b.index];a&&(d.emitGamepadEvent(b,m.extractState(a),!1),d.inputDevices[b.index]=void 0,d.latestUpdate[b.index]=void 0,d.input.gamepad.devices.remove(a))};this.frameTask=null;this.latestUpdate=[];this.inputDevices=
[];this.callback=null;if(this.supported="getGamepads"in window.navigator)this.forEachGamepad(function(b){return d.handleGamepadConnected(b)}),window.addEventListener("gamepadconnected",this.handleGamepadConnectedEvent),window.addEventListener("gamepaddisconnected",this.handleGamepadDisconnectedEvent)}f.prototype.destroy=function(){this.pollingEnabled=!1;this.supported&&(window.removeEventListener("gamepadconnected",this.handleGamepadConnectedEvent),window.removeEventListener("gamepaddisconnected",
this.handleGamepadDisconnectedEvent))};Object.defineProperty(f.prototype,"onEvent",{set:function(b){this.callback=b},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"pollingEnabled",{set:function(b){this.supported&&(b?this.startPolling():this.stopPolling())},enumerable:!0,configurable:!0});f.prototype.handleGamepadConnected=function(b){var c=new h(b);"unknown"!==c.deviceType&&(this.inputDevices[b.index]=c,this.input.gamepad.devices.add(c))};f.prototype.startPolling=function(){var b=
this;null==this.frameTask&&(this.frameTask=d.addFrameTask({update:function(){return b.readGamepadState()}}))};f.prototype.stopPolling=function(){null!=this.frameTask&&(this.frameTask.remove(),this.frameTask=null,this.latestUpdate=[])};f.prototype.readGamepadState=function(){var b=this,c=document.hasFocus(),d=this.element.contains(document.activeElement),f="document"===this.input.gamepad.enabledFocusMode&&!c||"view"===this.input.gamepad.enabledFocusMode&&!d;this.forEachGamepad(function(a){var c=b.inputDevices[a.index];
if(c){var d=b.latestUpdate[a.index],c=m.extractState(c),e=f||m.stateIdle(c);d&&(d.timestamp===a.timestamp||!d.active&&e||m.stateEqual(d.state,c))||b.emitGamepadEvent(a,c,!e)}})};f.prototype.forEachGamepad=function(b){for(var c=window.navigator.getGamepads(),d=0;d<c.length;d++){var f=c[d];this.validate(f)&&b(f)}};f.prototype.emitGamepadEvent=function(b,c,d){var e=this.latestUpdate[b.index];if((e=e&&e.active)||d)this.latestUpdate[b.index]={timestamp:b.timestamp,state:c,active:d},this.callback&&this.callback({device:this.inputDevices[b.index],
state:c,action:!e&&d?"start":e&&d?"update":"end"})};f.prototype.validate=function(b){if(!b||!b.connected)return!1;for(var c=0;c<b.axes.length;c++)if(isNaN(b.axes[c]))return!1;return!0};return f}();g.GamepadSource=q})},"esri/views/input/gamepad/GamepadState":function(){define(["require","exports","../../3d/support/mathUtils"],function(q,g,n){Object.defineProperty(g,"__esModule",{value:!0});g.extractState=function(d){var h=d.native;return{buttons:h.buttons.map(function(d){return d.pressed?d.value?d.value:
1:0}),axes:h.axes.map(function(h){var f=d.axisThreshold,b=Math.abs(h);h=b<f?0:n.sign(h)*(b-f)/(1-f);return h})}};g.stateEqual=function(d,h){if(d.axes.length!==h.axes.length||d.buttons.length!==h.buttons.length)return!1;for(var m=0;m<d.axes.length;m++)if(d.axes[m]!==h.axes[m])return!1;for(m=0;m<d.buttons.length;m++)if(d.buttons[m]!==h.buttons[m])return!1;return!0};g.stateIdle=function(d){for(var h=0;h<d.axes.length;h++)if(0!==d.axes[h])return!1;for(h=0;h<d.buttons.length;h++)if(0!==d.buttons[h])return!1;
return!0}})},"esri/views/input/InputManager":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Logger ../../core/now ../../core/accessorSupport/decorators ./keys ./recognizers ./handlers/LatestPointerType".split(" "),function(q,g,n,d,h,m,f,b,c,e,r){Object.defineProperty(g,"__esModule",{value:!0});var a=m.getLogger("esri.views.input.InputManager");q=function(h){function m(a,b){a=h.call(this)||this;a._pointerCaptures=
new Map;a._nameToGroup={};a._handlers=[];a._currentPropagation=null;a._sourceEvents=new Set;a._keyModifiers=new Set;a._activeKeyModifiers=new Set;a.primaryKey=c.primaryKey;a.latestPointerType="mouse";a._installRecognizers();return a}n(m,h);m.prototype.normalizeCtorArgs=function(a,b){this._browserEvents=a;this._browserEvents.onEventReceived=this._onEventReceived.bind(this);this._recognizers=b;this._recognizers||(this._recognizers=e.defaults.map(function(a){return new a}));return{}};m.prototype.destroy=
function(){for(var a=0,b=Object.keys(this._nameToGroup);a<b.length;a++)this.uninstallHandlers(b[a]);this._browserEvents=null};Object.defineProperty(m.prototype,"hasPendingInputs",{get:function(){return this._handlers.some(function(a){return a.handler.hasPendingInputs})},enumerable:!0,configurable:!0});m.prototype.installHandlers=function(b,c){var d=this;if(this._nameToGroup[b])a.error("There is already an InputHandler group registered under the name `"+b+"`");else if(0===c.length)a.error("Can't register a group of zero handlers");
else{var e={name:b,handlers:c.map(function(a,b){return{handler:a,active:!0,removed:!1,priorityIndex:0,eventCallback:null,uninstallCallback:null}})};this._nameToGroup[b]=e;b=function(a){var b=e.handlers[a];f._handlers.push(b);b.handler.onInstall({updateDependencies:function(){d.updateDependencies()},emit:function(a,c,e,f){d._emitInputEvent(b.priorityIndex,a,c,e,f)},setPointerCapture:function(a,c){d._setPointerCapture(e,b,a,c)},setEventCallback:function(a){b.eventCallback=a},setUninstallCallback:function(a){b.uninstallCallback=
a},refreshHasPendingInputs:function(){d.notifyChange("hasPendingInputs")}})};var f=this;for(c=e.handlers.length-1;0<=c;c--)b(c);this.updateDependencies()}};m.prototype.uninstallHandlers=function(b){var c=this._nameToGroup[b];c?(c.handlers.forEach(function(a){a.removed=!0;a.uninstallCallback()}),delete this._nameToGroup[b],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):a.error("There is no InputHandler group registered under the name `"+
b+"`")};m.prototype.hasHandlers=function(a){return void 0!==this._nameToGroup[a]};m.prototype.updateDependencies=function(){var a=new Set,b=new Set;this._handlersPriority=[];for(var d=this._handlers.length-1;0<=d;d--){var e=this._handlers[d];e.priorityIndex=d;this._handlersPriority.push(e)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(d=this._handlersPriority.length-1;0<=d;d--){e=this._handlersPriority[d];e.priorityIndex=d;var f=e.handler.hasSideEffects;if(!f)for(var h=
0,m=e.handler.outgoingEventTypes;h<m.length;h++)if(a.has(m[h])){f=!0;break}if(f)for(h=0,m=e.handler.incomingEventMatches;h<m.length;h++){var p=m[h];a.add(p.eventType);for(var n=0,p=p.keyModifiers;n<p.length;n++){var r=p[n];c.isSystemModifier(r)||b.add(r)}}e.active=f}this._sourceEvents=a;this._keyModifiers=b;0<this._pointerCaptures.size&&this._sourceEvents.add("pointer-capture-lost");0<this._keyModifiers.size&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up"));this._browserEvents&&
(this._browserEvents.activeEvents=this._sourceEvents)};m.prototype._setLatestPointerType=function(a){this._set("latestPointerType",a)};m.prototype._onEventReceived=function(a,b){"pointer-capture-lost"===a&&this._pointerCaptures.delete(b.native.pointerId);this._updateKeyModifiers(a,b);this._emitInputEventFromSource(a,b,b.native?b.native.timestamp:void 0)};m.prototype._updateKeyModifiers=function(a,b){var c=this;if(b){var d=!1,e=function(){if(!d){var a=new Set;c._activeKeyModifiers.forEach(function(b){a.add(b)});
c._activeKeyModifiers=a;d=!0}},f=function(a,b){b&&!c._activeKeyModifiers.has(a)?(e(),c._activeKeyModifiers.add(a)):!b&&c._activeKeyModifiers.has(a)&&(e(),c._activeKeyModifiers.delete(a))};if("key-down"===a||"key-up"===a){var l=b.key;this._keyModifiers.has(l)&&f(l,"key-down"===a)}a=b.native;f("Alt",!(!a||!a.altKey));f("Ctrl",!(!a||!a.ctrlKey));f("Shift",!(!a||!a.shiftKey));f("Meta",!(!a||!a.metaKey));f("Primary",this._activeKeyModifiers.has(this.primaryKey))}};m.prototype._installRecognizers=function(){var a=
this;this._latestPointerTypeHandler=new r.LatestPointerType(function(b){return a._setLatestPointerType(b)});0<this._recognizers.length&&this.installHandlers("default",this._recognizers);this.installHandlers("input-manager-logic",[this._latestPointerTypeHandler])};m.prototype._setPointerCapture=function(a,b,c,d){a=a.name+"-"+b.priorityIndex;b=this._pointerCaptures.get(c.pointerId)||new Set;this._pointerCaptures.set(c.pointerId,b);d?(b.add(a),1===b.size&&this._browserEvents&&this._browserEvents.setPointerCapture(c,
!0)):b.has(a)&&(b.delete(a),0===b.size&&(this._pointerCaptures.delete(c.pointerId),this._browserEvents&&this._browserEvents.setPointerCapture(c,!1)))};m.prototype._garbageCollectRemovedHandlers=function(){this._handlers=this._handlers.filter(function(a){return!a.removed});this.updateDependencies()};m.prototype._emitInputEventFromSource=function(a,b,c){this._emitInputEvent(0,a,b,c)};m.prototype._emitInputEvent=function(a,b,c,d,e){d=void 0!==d?d:this._currentPropagation?this._currentPropagation.timestamp:
f();b=new t(b,c,d,e||this._activeKeyModifiers);this._currentPropagation?this._currentPropagation.addedEvents.push(b):this._doNewPropagation(a,b)};m.prototype._doNewPropagation=function(a,b){for(a=this._currentPropagation={events:[b],addedEvents:[],currentHandler:this._handlersPriority[a],needsHandlerGarbageCollect:!1,timestamp:b.timestamp};a.currentHandler;){if(a.currentHandler.removed)a.needsHandlerGarbageCollect=!0;else{b=a.events;var c=[];a.addedEvents=[];for(var d=0;d<b.length;d++){var e=b[d];
a.currentHandler.active&&a.currentHandler.eventCallback(e);e.shouldStopPropagation()||c.push(e)}a.events=c.concat(a.addedEvents)}a.currentHandler=this._handlersPriority[a.currentHandler.priorityIndex+1]}a.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers();this._currentPropagation=null};m.prototype._compareHandlerPriority=function(a,b){if(a.handler.hasSideEffects!==b.handler.hasSideEffects)return a.handler.hasSideEffects?1:-1;for(var c=0,d=a.handler.incomingEventMatches;c<d.length;c++)for(var e=
d[c],f=function(a){if(e.eventType!==a.eventType)return"continue";var b=e.keyModifiers.filter(function(b){return-1!==a.keyModifiers.indexOf(b)});if(b.length===e.keyModifiers.length!==(b.length===a.keyModifiers.length))return{value:e.keyModifiers.length>a.keyModifiers.length?-1:1}},l=0,k=b.handler.incomingEventMatches;l<k.length;l++){var h=f(k[l]);if("object"===typeof h)return h.value}return a.priorityIndex>b.priorityIndex?-1:1};m.prototype._sortHandlersPriority=function(a){for(var b=[],c=0;c<a.length;c++){for(var d=
a[c],e=0;e<b.length&&0<=this._compareHandlerPriority(d,b[e]);)e++;b.splice(e,0,d)}return b};Object.defineProperty(m.prototype,"debug",{get:function(){var a=this,b=function(b){var c=a._setPointerCapture;a._setPointerCapture=function(){};b();a._setPointerCapture=c};return{injectEvent:function(c,d){b(function(){a._onEventReceived(c,d)})},disablePointerCapture:b}},enumerable:!0,configurable:!0});d([b.property({readOnly:!0})],m.prototype,"hasPendingInputs",null);d([b.property({readOnly:!0})],m.prototype,
"latestPointerType",void 0);return m=d([b.subclass("esri.views.input.InputManager")],m)}(b.declared(h));g.InputManager=q;var t=function(){function a(a,b,c,d){this.type=a;this.data=b;this.timestamp=c;this.modifiers=d;this._stopPropagation=!1}a.prototype.stopPropagation=function(){this._stopPropagation=!0};a.prototype.shouldStopPropagation=function(){return this._stopPropagation};return a}()})},"esri/views/input/recognizers":function(){define("require exports ./recognizers/Drag ./recognizers/PointerClickHoldAndDrag ./recognizers/SingleAndDoubleClick ./recognizers/VerticalTwoFingerDrag".split(" "),
function(q,g,n,d,h,m){Object.defineProperty(g,"__esModule",{value:!0});g.defaults=[d.PointerClickHoldAndDrag,h.SingleAndDoubleClick,n.Drag,m.VerticalTwoFingerDrag]})},"esri/views/input/recognizers/Drag":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../InputHandler","./support"],function(q,g,n,d,h){function m(b){var c=[];b.forEach(function(a){c.push(a.event)});return h.fitCircleLSQ(c)}function f(b){var d=m(b),a=0;b.forEach(function(b){for(var e=c(b,d),e=e-b.lastAngle;e>
Math.PI;)e-=2*Math.PI;for(;e<-Math.PI;)e+=2*Math.PI;e=b.lastAngle+e;b.lastAngle=e;a+=e-b.initialAngle});a/=b.size||1;return{angle:a,radius:d.radius,center:d.center}}function b(b){var c=new Map;b.forEach(function(a,b){return c.set(b,a.event)});return c}function c(b,c){b=b.event;return Math.atan2(b.y-c.center.y,b.x-c.center.x)}Object.defineProperty(g,"__esModule",{value:!0});q=function(d){function e(){var a=d.call(this,!1)||this;a.startStateModifiers=new Set;a.activePointerMap=new Map;a.isDragging=
!1;a.drag=a.registerOutgoing("drag");a.registerIncoming("pointer-drag",a.handlePointerDrag.bind(a));a.registerIncoming("pointer-up",a.handlePointerUpAndPointerLost.bind(a));a.registerIncoming("pointer-capture-lost",a.handlePointerUpAndPointerLost.bind(a));a.registerIncoming("pointer-cancel",a.handlePointerUpAndPointerLost.bind(a));return a}n(e,d);e.prototype.createPayload=function(a,c,d,e){return{action:a,pointerType:this.pointerType,button:this.mouseButton,buttons:c.buttons,timestamp:e,pointers:b(this.activePointerMap),
pointer:c,angle:d.angle,radius:d.radius,center:d.center}};e.prototype.addPointer=function(a){var b=a.native.pointerId,d=f(this.activePointerMap).angle;a={event:a,initialAngle:0,lastAngle:0};this.activePointerMap.set(b,a);b=c(a,m(this.activePointerMap));a.initialAngle=b;a.lastAngle=b;this.updatePointerAngles(d)};e.prototype.updatePointer=function(a){if(!a||null!=a.x||null!=a.y){var b=this.activePointerMap.get(a.native.pointerId);b?b.event=a:this.addPointer(a)}};e.prototype.removePointer=function(a){var b=
f(this.activePointerMap).angle;this.activePointerMap.delete(a);this.updatePointerAngles(b)};e.prototype.updatePointerAngles=function(a){var b=f(this.activePointerMap);this.activePointerMap.forEach(function(d){d.initialAngle=c(d,b)-a;d.lastAngle=c(d,b)-a})};e.prototype.emitEvent=function(a,b,c){var d=f(this.activePointerMap);this.drag.emit(this.createPayload(a,b,d,c),void 0,this.startStateModifiers)};e.prototype.handlePointerUpAndPointerLost=function(a){var b=a.data.native.pointerId,c=a.timestamp;
this.activePointerMap.get(b)&&(1===this.activePointerMap.size?(this.updatePointer(a.data),this.emitEvent("end",a.data,c),this.isDragging=!1,this.removePointer(b)):(this.removePointer(b),this.emitEvent("removed",a.data,a.timestamp)))};e.prototype.handlePointerDrag=function(a){var b=a.data,c=b.currentEvent,d=a.timestamp;switch(b.action){case "start":case "update":this.isDragging?this.activePointerMap.has(c.native.pointerId)?(this.updatePointer(c),this.emitEvent("update",c,d)):(this.addPointer(c),this.emitEvent("added",
c,d)):(this.updatePointer(c),this.pointerType=a.data.startEvent.pointerType,this.mouseButton=a.data.startEvent.button,this.startStateModifiers=a.modifiers,this.isDragging=!0,this.emitEvent("start",c,d))}};return e}(d.InputHandler);g.Drag=q;(function(b){b[b.Left=0]="Left";b[b.Middle=1]="Middle";b[b.Right=2]="Right";b[b.Back=3]="Back";b[b.Forward=4]="Forward";b[b.Undefined=-1]="Undefined"})(g.Button||(g.Button={}))})},"esri/views/input/recognizers/support":function(){define(["require","exports"],function(q,
g){Object.defineProperty(g,"__esModule",{value:!0});g.manhattanDistance=function(n,d){return Math.abs(d.x-n.x)+Math.abs(d.y-n.y)};g.euclideanDistance=function(n,d){var h=d.x-n.x;n=d.y-n.y;return Math.sqrt(h*h+n*n)};g.fitCircleLSQ=function(n,d){d?(d.radius=0,d.center.x=0,d.center.y=0):d={radius:0,center:{x:0,y:0}};if(0===n.length)return d;if(1===n.length)return d.center.x=n[0].x,d.center.y=n[0].y,d;if(2===n.length){var h=n[0];n=n[1];var m=[n.x-h.x,n.y-h.y],f=m[0],m=m[1];d.radius=Math.sqrt(f*f+m*m)/
2;d.center.x=(h.x+n.x)/2;d.center.y=(h.y+n.y)/2;return d}for(var b=0,c=0,e=0;e<n.length;e++)b+=n[e].x,c+=n[e].y;for(var b=b/n.length,c=c/n.length,r=n.map(function(a){return a.x-b}),a=n.map(function(a){return a.y-c}),g=h=d=0,p=0,u=f=0,e=m=0;e<r.length;e++){var l=r[e],k=a[e],q=l*l,v=k*k;d+=q;h+=v;g+=l*k;p+=q*l;f+=v*k;u+=l*v;m+=k*q}e=d;r=g;a=h;p=.5*(p+u);f=.5*(f+m);m=e*a-g*r;u=(p*a-f*r)/m;f=(e*f-g*p)/m;return{radius:Math.sqrt(u*u+f*f+(d+h)/n.length),center:{x:u+b,y:f+c}}}})},"esri/views/input/recognizers/PointerClickHoldAndDrag":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/clock ../InputHandler ./support".split(" "),
function(q,g,n,d,h,m){Object.defineProperty(g,"__esModule",{value:!0});g.DefaultParameters={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilTouchDrag:6,holdDelay:500};q=function(f){function b(b,e,h,a,m){void 0===b&&(b=g.DefaultParameters.maximumClickDelay);void 0===e&&(e=g.DefaultParameters.movementUntilMouseDrag);void 0===h&&(h=g.DefaultParameters.movementUntilTouchDrag);void 0===a&&(a=g.DefaultParameters.holdDelay);void 0===m&&(m=d.default);var c=f.call(this,!1)||this;c.maximumClickDelay=
b;c.movementUntilMouseDrag=e;c.movementUntilTouchDrag=h;c.holdDelay=a;c._clock=m;c._pointerState=new Map;c._pointerDrag=c.registerOutgoing("pointer-drag");c._immediateClick=c.registerOutgoing("immediate-click");c._pointerHold=c.registerOutgoing("hold");c.registerIncoming("pointer-down",c._handlePointerDown.bind(c));c.registerIncoming("pointer-up",function(a){c._handlePointerLoss(a,"pointer-up")});c.registerIncoming("pointer-capture-lost",function(a){c._handlePointerLoss(a,"pointer-capture-lost")});
c.registerIncoming("pointer-cancel",function(a){c._handlePointerLoss(a,"pointer-cancel")});c._moveHandle=c.registerIncoming("pointer-move",c._handlePointerMove.bind(c));c._moveHandle.pause();return c}n(b,f);b.prototype.onUninstall=function(){this._pointerState.forEach(function(b){null!=b.holdTimeout&&(b.holdTimeout.remove(),b.holdTimeout=null)});f.prototype.onUninstall.call(this)};b.prototype._handlePointerDown=function(b){var c=this,d=b.data,a=d.native.pointerId,f=null;0===this._pointerState.size&&
(f=this._clock.setTimeout(function(){var d=c._pointerState.get(a);d&&(d.isDragging||(c._pointerHold.emit(d.previousEvent,void 0,b.modifiers),d.holdEmitted=!0),d.holdTimeout=null)},this.holdDelay));f={startEvent:d,previousEvent:d,startTimestamp:b.timestamp,isDragging:!1,downButton:d.native.button,holdTimeout:f,modifiers:new Set};this._pointerState.set(a,f);this.startCapturingPointer(d.native);this._moveHandle.resume();1<this._pointerState.size&&this.startDragging(b)};b.prototype._createPointerDragData=
function(b,d,f){return{action:b,startEvent:d.startEvent,previousEvent:d.previousEvent,currentEvent:f}};b.prototype._handlePointerMove=function(b){var c=b.data,d=this._pointerState.get(c.native.pointerId);d&&(d.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",d,c),void 0,d.modifiers):m.euclideanDistance(c,d.startEvent)>("touch"===c.native.pointerType?this.movementUntilTouchDrag:this.movementUntilMouseDrag)&&this.startDragging(b),d.previousEvent=c)};b.prototype.startDragging=function(b){var c=
this,d=b.data,a=d.native.pointerId;this._pointerState.forEach(function(e){null!=e.holdTimeout&&(e.holdTimeout.remove(),e.holdTimeout=null);e.isDragging||(e.modifiers=b.modifiers,e.isDragging=!0,a===e.startEvent.native.pointerId?c._pointerDrag.emit(c._createPointerDragData("start",e,d)):c._pointerDrag.emit(c._createPointerDragData("start",e,e.previousEvent),b.timestamp))})};b.prototype._handlePointerLoss=function(b,d){var c=b.data,a=c.native.pointerId,e=this._pointerState.get(a);e&&(null!=e.holdTimeout&&
(e.holdTimeout.remove(),e.holdTimeout=null),e.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",e,"pointer-up"===d?c:e.previousEvent),void 0,e.modifiers):"pointer-up"===d&&e.downButton===c.native.button&&b.timestamp-e.startTimestamp<=this.maximumClickDelay&&!e.holdEmitted&&this._immediateClick.emit(c),this._pointerState.delete(a),this.stopCapturingPointer(c.native),0===this._pointerState.size&&this._moveHandle.pause())};return b}(h.InputHandler);g.PointerClickHoldAndDrag=q})},"esri/core/clock":function(){define(["require",
"exports","./global"],function(q,g,n){function d(d){return{setTimeout:function(h,f){var b=d.setTimeout(h,f);return{remove:function(){return d.clearTimeout(b)}}}}}Object.defineProperty(g,"__esModule",{value:!0});g.wrap=d;g.default=d(n)})},"esri/views/input/recognizers/SingleAndDoubleClick":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/clock ../../../core/iteratorUtils ../InputHandler ./support".split(" "),function(q,g,n,d,h,m,f){Object.defineProperty(g,"__esModule",
{value:!0});g.DefaultParameters={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};q=function(b){function c(c,f,a,h,m){void 0===c&&(c=g.DefaultParameters.maximumDoubleClickDelay);void 0===f&&(f=g.DefaultParameters.maximumDoubleClickDistance);void 0===a&&(a=g.DefaultParameters.maximumDoubleTouchDelay);void 0===h&&(h=g.DefaultParameters.maximumDoubleTouchDistance);void 0===m&&(m=d.default);var e=b.call(this,!1)||this;e.maximumDoubleClickDelay=
c;e.maximumDoubleClickDistance=f;e.maximumDoubleTouchDelay=a;e.maximumDoubleTouchDistance=h;e._clock=m;e._pointerState=new Map;e._click=e.registerOutgoing("click");e._doubleClick=e.registerOutgoing("double-click");e.registerIncoming("immediate-click",e._handleImmediateClick.bind(e));e.registerIncoming("pointer-drag",e._handlePointerDrag.bind(e));e.registerIncoming("drag",e._handleDrag.bind(e));return e}n(c,b);c.prototype.onUninstall=function(){this._pointerState.forEach(function(b){null!=b.doubleClickTimeout&&
(b.doubleClickTimeout.remove(),b.doubleClickTimeout=null)})};Object.defineProperty(c.prototype,"hasPendingInputs",{get:function(){return!h.everyMap(this._pointerState,function(b){return null==b.doubleClickTimeout})},enumerable:!0,configurable:!0});c.prototype._pointerId=function(b){b=b.native;return"mouse"===b.pointerType?b.pointerId+":"+b.button:""+b.pointerType};c.prototype._handleImmediateClick=function(b){var c=b.data,a=this._pointerId(c),d=this._pointerState.get(a);if(d){var e="touch"===c.native.pointerType?
this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;f.manhattanDistance(d.event.data,c)>e?(this._clearDoubleClickTimeout(a,!0),this._startClick(b)):(this._clearDoubleClickTimeout(a,!1),this._doubleClick.emit(c,void 0,d.event.modifiers))}else this._startClick(b)};c.prototype._startClick=function(b){var c=this,a=this._pointerId(b.data);this._pointerState.set(a,{event:b,doubleClickTimeout:this._clock.setTimeout(function(){return c._doubleClickTimeoutExceeded(a)},"touch"===b.data.native.pointerType?
this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay)});this.refreshHasPendingInputs()};c.prototype._handlePointerDrag=function(b){b=this._pointerId(b.data.currentEvent);this._clearDoubleClickTimeout(b,!0)};c.prototype._handleDrag=function(b){b=this._pointerId(b.data.pointer);this._clearDoubleClickTimeout(b,!0)};c.prototype._clearDoubleClickTimeout=function(b,c){var a=this._pointerState.get(b);a&&(a.doubleClickTimeout.remove(),a.doubleClickTimeout=null,c&&this._doubleClickTimeoutExceeded(b),
this._pointerState.delete(b),this.refreshHasPendingInputs())};c.prototype._doubleClickTimeoutExceeded=function(b){var c=this._pointerState.get(b);this._click.emit(c.event.data,void 0,c.event.modifiers);c.doubleClickTimeout=null;this._pointerState.delete(b);this.refreshHasPendingInputs()};return c}(m.InputHandler);g.SingleAndDoubleClick=q})},"esri/views/input/recognizers/VerticalTwoFingerDrag":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../DragEventSeparator","../InputHandler"],
function(q,g,n,d,h){Object.defineProperty(g,"__esModule",{value:!0});q=function(h){function f(b,c){void 0===b&&(b=20);void 0===c&&(c=40);var e=h.call(this,!1)||this;e._threshold=b;e._maxDelta=c;e.state="ready";e.emittedArtificalEnd2=!1;e._vertical=e.registerOutgoing("vertical-two-finger-drag");e._artificalDrag=e.registerOutgoing("drag");e.dragEventSeparator=new d.DragEventSeparator({start:function(b,a){return e.observeStart(b,a)},update:function(b,a,c){return e.observeUpdate(b,a,c)},end:function(b,
a){return e.observeEnd(b,a)}});e.registerIncoming("drag",function(b){return e.dragEventSeparator.handle(b)});return e}n(f,h);Object.defineProperty(f.prototype,"failed",{get:function(){return"failed"===this.state},enumerable:!0,configurable:!0});f.prototype.observeStart=function(b,c){1===b&&this.emittedArtificalEnd2&&(this.emittedArtificalEnd2=!1,this._artificalDrag.emit({action:"start",button:c.data.button,buttons:c.data.buttons,pointerType:c.data.pointerType,timestamp:c.data.timestamp,pointers:c.data.pointers,
pointer:c.data.pointer,angle:c.data.angle,radius:c.data.radius,center:c.data.center,artifical:!0}),c.stopPropagation());this.state=2===b?"ready":"failed"};f.prototype.observeUpdate=function(b,c,d){"failed"!==this.state&&2===b&&("active"===this.state?(this._vertical.emit({delta:c.data.center.y-this._thresholdReachedCenter.y,action:"update"}),c.stopPropagation()):this.checkMovementWithinLimits(c.data,d.data)?this.checkVerticalThresholdReached(c.data,d.data)&&(this.state="active",this.emittedArtificalEnd2=
!0,this._thresholdReachedCenter=c.data.center,this._artificalDrag.emit({action:"end",button:c.data.button,buttons:c.data.buttons,pointerType:c.data.pointerType,timestamp:c.data.timestamp,pointers:c.data.pointers,pointer:c.data.pointer,angle:c.data.angle,radius:c.data.radius,center:c.data.center,artifical:!0}),this._vertical.emit({delta:c.data.center.y-this._thresholdReachedCenter.y,action:"begin"}),c.stopPropagation()):this.state="failed")};f.prototype.observeEnd=function(b,c){"active"===this.state&&
(this._vertical.emit({delta:c.data.center.y-this._thresholdReachedCenter.y,action:"end"}),this.state="ready",c.stopPropagation())};f.prototype.checkMovementWithinLimits=function(b,c){var d=-Infinity,f=Infinity,a=-Infinity,h=Infinity;c.pointers.forEach(function(b){d=Math.max(d,b.x);f=Math.min(f,b.x);a=Math.max(a,b.y);h=Math.min(h,b.y)});var m=-Infinity,n=Infinity,l=-Infinity,k=Infinity;b.pointers.forEach(function(a){m=Math.max(m,a.x);n=Math.min(n,a.x);l=Math.max(l,a.y);k=Math.min(k,a.y)});return Math.abs(b.center.x-
c.center.x)<this._threshold&&Math.abs(m-n-(d-f))<=this._maxDelta&&Math.abs(l-k-(a-h))<=this._maxDelta};f.prototype.checkVerticalThresholdReached=function(b,c){var d=Math.abs(b.center.y-c.center.y);b.pointers.forEach(function(b,a){a=c.pointers.get(a);d=Math.min(d,Math.abs(b.y-a.y))});return d>=this._threshold};return f}(h.InputHandler);g.VerticalTwoFingerDrag=q})},"esri/views/input/handlers/LatestPointerType":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../InputHandler"],
function(q,g,n,d){Object.defineProperty(g,"__esModule",{value:!0});q=function(d){function h(f){var b=d.call(this,!0)||this;b._onChange=f;b._value="mouse";b.registerIncoming("pointer-down",function(c){b._setValue("touch"===c.data.native.pointerType?"touch":"mouse")});b._moveHandler=b.registerIncoming("pointer-move",function(c){b._setValue("touch"===c.data.native.pointerType?"touch":"mouse")});b._moveHandler.pause();return b}n(h,d);h.prototype._setValue=function(d){d!==this._value&&("touch"===d?this._moveHandler.resume():
this._moveHandler.pause(),this._value=d,this._onChange(d))};return h}(d.InputHandler);g.LatestPointerType=q})},"esri/views/input/ViewEvents":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/compilerUtils ../../geometry/ScreenPoint ../3d/support/mathUtils ./InputHandler".split(" "),function(q,g,n,d,h,m,f){function b(a){return!!e[a]}function c(a){for(var c=0;c<a.length;c++)if(!b(a[c]))return!1;return!0}Object.defineProperty(g,"__esModule",{value:!0});var e={click:!0,
"double-click":!0,"immediate-click":!0,hold:!0,drag:!0,"key-down":!0,"key-up":!0,"pointer-down":!0,"pointer-move":!0,"pointer-up":!0,"pointer-drag":!0,"mouse-wheel":!0,"pointer-enter":!0,"pointer-leave":!0,gamepad:!0,focus:!0,blur:!0},r;(function(a){a[a.Left=0]="Left";a[a.Middle=1]="Middle";a[a.Right=2]="Right"})(r||(r={}));q=function(){function d(a){this.handlers=new Map;this.counter=0;this.handlerCounts=new Map;this.view=a;this.inputManager=null}d.prototype.connect=function(a){var b=this;a&&this.disconnect();
this.inputManager=a;this.handlers.forEach(function(a,c){return b.inputManager.installHandlers(c,[a])})};d.prototype.disconnect=function(){var a=this;this.inputManager&&this.handlers.forEach(function(b,c){return a.inputManager.uninstallHandlers(c)});this.inputManager=null};d.prototype.destroy=function(){this.disconnect();this.handlers.clear();this.view=null};d.prototype.register=function(d,e,f){var l=this,h=Array.isArray(d)?d:d.split(",");if(!c(h))return h.some(b)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),
null;d=Array.isArray(e)?e:[];f=Array.isArray(e)?f:e;var m=this.createUniqueGroupName();e=new a(this.view,h,d,f);this.handlers.set(m,e);for(f=0;f<h.length;f++){d=h[f];var n=this.handlerCounts.get(d)||0;this.handlerCounts.set(d,n+1)}this.inputManager&&this.inputManager.installHandlers(m,[e]);return{remove:function(){return l.removeHandler(m,h)}}};d.prototype.hasHandler=function(a){return!!this.handlerCounts.get(a)};d.prototype.removeHandler=function(a,b){if(this.handlers.has(a)){this.handlers.delete(a);
for(var c=0;c<b.length;c++){var d=b[c],e=this.handlerCounts.get(d);void 0===e?console.error("Trying to remove handler for event that has no handlers registered: ",d):1===e?this.handlerCounts.delete(d):this.handlerCounts.set(d,e-1)}}this.inputManager&&this.inputManager.uninstallHandlers(a)};d.prototype.createUniqueGroupName=function(){this.counter+=1;return"viewEvents_"+this.counter};return d}();g.ViewEvents=q;var a=function(a){function b(b,c,e,f){var h=a.call(this,!0)||this;h.view=b;for(b=0;b<c.length;b++){var l=
c[b];switch(l){case "click":h.registerIncoming("click",e,function(a){return f(h.wrapClick(a))});break;case "double-click":h.registerIncoming("double-click",e,function(a){return f(h.wrapDoubleClick(a))});break;case "immediate-click":h.registerIncoming("immediate-click",e,function(a){return f(h.wrapImmediateClick(a))});break;case "hold":h.registerIncoming("hold",e,function(a){return f(h.wrapHold(a))});break;case "drag":h.registerIncoming("drag",e,function(a){(a=h.wrapDrag(a))&&f(a)});break;case "key-down":h.registerIncoming("key-down",
e,function(a){return f(h.wrapKeyDown(a))});break;case "key-up":h.registerIncoming("key-up",e,function(a){return f(h.wrapKeyUp(a))});break;case "pointer-down":h.registerIncoming("pointer-down",e,function(a){return f(h.wrapPointer(a,"pointer-down"))});break;case "pointer-move":h.registerIncoming("pointer-move",e,function(a){return f(h.wrapPointer(a,"pointer-move"))});break;case "pointer-up":h.registerIncoming("pointer-up",e,function(a){return f(h.wrapPointer(a,"pointer-up"))});break;case "pointer-drag":h.registerIncoming("pointer-drag",
e,function(a){return f(h.wrapPointerDrag(a))});break;case "mouse-wheel":h.registerIncoming("mouse-wheel",e,function(a){return f(h.wrapMouseWheel(a))});break;case "pointer-enter":h.registerIncoming("pointer-enter",e,function(a){return f(h.wrapPointer(a,"pointer-enter"))});break;case "pointer-leave":h.registerIncoming("pointer-leave",e,function(a){return f(h.wrapPointer(a,"pointer-leave"))});break;case "gamepad":h.registerIncoming("gamepad",e,function(a){f(h.wrapGamepad(a))});break;case "focus":h.registerIncoming("focus",
e,function(a){f(h.wrapFocus(a))});break;case "blur":h.registerIncoming("blur",e,function(a){f(h.wrapBlur(a))});break;default:d.neverReached(l)}}return h}n(b,a);b.prototype.wrapFocus=function(a){return{type:"focus",timestamp:a.timestamp,native:a.data.native,stopPropagation:function(){return a.stopPropagation()}}};b.prototype.wrapBlur=function(a){return{type:"blur",timestamp:a.timestamp,native:a.data.native,stopPropagation:function(){return a.stopPropagation()}}};b.prototype.wrapClick=function(a){var b=
a.data,c=b.x,d=b.y,e=b.eventId;return{type:"click",pointerType:b.pointerType,button:b.button,buttons:b.buttons,x:c,y:d,native:b.native,timestamp:a.timestamp,screenPoint:new h(c,d),mapPoint:this.view.toMap(c,d),eventId:e,stopPropagation:function(){return a.stopPropagation()}}};b.prototype.wrapDoubleClick=function(a){var b=a.data,c=b.x,d=b.y,e=b.eventId;return{type:"double-click",pointerType:b.pointerType,button:b.button,buttons:b.buttons,x:c,y:d,native:b.native,timestamp:a.timestamp,mapPoint:this.view.toMap(c,
d),eventId:e,stopPropagation:function(){return a.stopPropagation()}}};b.prototype.wrapImmediateClick=function(a){var b=a.data,c=b.x,d=b.y,e=b.eventId;return{type:"immediate-click",pointerType:b.pointerType,button:b.button,buttons:b.buttons,x:c,y:d,native:b.native,timestamp:a.timestamp,mapPoint:this.view.toMap(c,d),eventId:e,stopPropagation:function(){return a.stopPropagation()}}};b.prototype.wrapHold=function(a){var b=a.data,c=b.x,d=b.y;return{type:"hold",pointerType:b.pointerType,button:b.button,
buttons:b.buttons,x:c,y:d,native:b.native,timestamp:a.timestamp,mapPoint:this.view.toMap(c,d),stopPropagation:function(){return a.stopPropagation()}}};b.prototype.wrapDrag=function(a){var b=a.data,c=b.center,d=c.x,c=c.y,e=b.action,f=b.pointerType,h=b.button;"start"===e&&(this.latestDragStart=b);if(this.latestDragStart){var n=b.pointer.native,g=b.buttons,p=a.timestamp,r={x:this.latestDragStart.center.x,y:this.latestDragStart.center.y};"end"===e&&(this.latestDragStart=void 0);return{type:"drag",action:e,
x:d,y:c,origin:r,pointerType:f,button:h,buttons:g,radius:b.radius,angle:m.rad2deg(b.angle),native:n,timestamp:p,stopPropagation:function(){return a.stopPropagation()}}}};b.prototype.wrapKeyDown=function(a){var b=a.data;return{type:"key-down",key:b.key,repeat:b.repeat,native:b.native,timestamp:a.timestamp,stopPropagation:function(){return a.stopPropagation()}}};b.prototype.wrapKeyUp=function(a){var b=a.data;return{type:"key-up",key:b.key,native:b.native,timestamp:a.timestamp,stopPropagation:function(){return a.stopPropagation()}}};
b.prototype.wrapPointer=function(a,b){var c=a.data,d=c.native;return{type:b,x:c.x,y:c.y,pointerId:d.pointerId,pointerType:d.pointerType,button:c.button,buttons:c.buttons,native:d,timestamp:a.timestamp,eventId:c.eventId,stopPropagation:function(){return a.stopPropagation()}}};b.prototype.wrapPointerDrag=function(a){var b=a.data.currentEvent;return{type:"pointer-drag",x:b.x,y:b.y,pointerId:a.data.startEvent.native.pointerId,pointerType:a.data.startEvent.native.pointerType,button:a.data.startEvent.button,
buttons:b.buttons,action:a.data.action,origin:{x:a.data.startEvent.x,y:a.data.startEvent.y},native:b.native,timestamp:a.timestamp,eventId:b.eventId,stopPropagation:function(){return a.stopPropagation()}}};b.prototype.wrapMouseWheel=function(a){var b=a.data;return{type:"mouse-wheel",x:b.x,y:b.y,deltaY:b.deltaY,native:b.native,timestamp:a.timestamp,stopPropagation:function(){return a.stopPropagation()}}};b.prototype.wrapGamepad=function(a){var b=a.data,c=b.state;return{type:"gamepad",device:b.device,
timestamp:a.timestamp,action:b.action,buttons:c.buttons,axes:c.axes,stopPropagation:function(){return a.stopPropagation()}}};return b}(f.InputHandler)})},"esri/views/input/handlers/PreventContextMenu":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../InputHandler"],function(q,g,n,d){Object.defineProperty(g,"__esModule",{value:!0});q=function(d){function h(){var f=d.call(this,!0)||this;f.registerIncoming("context-menu",function(b){b.data.native.preventDefault()});return f}
n(h,d);return h}(d.InputHandler);g.PreventContextMenu=q;g.default=q})},"esri/views/2d/support/HighlightOptions":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../Color ../../../core/Accessor ../../../core/accessorSupport/decorators".split(" "),function(q,g,n,d,h,m,f){return function(b){function c(){var c=null!==b&&b.apply(this,arguments)||this;c.color=new h([0,255,255]);c.haloOpacity=1;c.fillOpacity=.5;return c}n(c,b);d([f.property({type:h})],
c.prototype,"color",void 0);d([f.property()],c.prototype,"haloOpacity",void 0);d([f.property()],c.prototype,"fillOpacity",void 0);return c=d([f.subclass("esri.views.2d.support.HighlightOptions")],c)}(f.declared(m))})},"esri/views/support/WebGLRequirements":function(){define(["require","exports","../../core/tsSupport/assignHelper","../../core/Error","../../core/has"],function(q,g,n,d,h){Object.defineProperty(g,"__esModule",{value:!0});var m={supportsMajorWebPerformanceCaveat:!1};g.check=function(f){f=
n({},m,f);return h("esri-webgl")?!f.supportsMajorWebPerformanceCaveat&&h("esri-webgl-major-performance-caveat")?new d("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is blacklisted."):h("esri-webgl-high-precision-fragment")?h("esri-webgl-vertex-shader-samplers")?h("esri-webgl-element-index-uint")?h("esri-webgl-standard-derivatives")?h("esri-webgl-instanced-arrays")?null:new d("webgl:instanced-arrays-required",
"WebGL support for instanced rendering is required but not supported."):new d("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported."):new d("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported."):new d("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new d("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):
new d("webgl:required","WebGL is required but not supported.")}})},"esri/views/ui/2d/DefaultUI2D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../DefaultUI".split(" "),function(q,g,n,d,h,m){return function(f){function b(b){b=f.call(this)||this;b.components=["attribution","zoom"];return b}n(b,f);d([h.property()],b.prototype,"components",void 0);return b=d([h.subclass("esri.views.ui.2d.DefaultUI2D")],
b)}(h.declared(m))})},"esri/views/ui/DefaultUI":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper dojo/dom-geometry ../../core/watchUtils ../../core/accessorSupport/decorators ./Component ./UI ../../widgets/Attribution ../../widgets/Compass ../../widgets/NavigationToggle ../../widgets/Zoom".split(" "),function(q,g,n,d,h,m,f,b,c,e,r,a,t){return function(c){function g(a){a=c.call(this)||this;a._defaultPositionLookup=null;a.components=[];
return a}n(g,c);g.prototype.initialize=function(){this._handles.add([m.init(this,"components",this._componentsWatcher.bind(this)),m.init(this,"view",this._updateViewAwareWidgets.bind(this))])};g.prototype._findComponentPosition=function(a){if(!this._defaultPositionLookup){var b=h.isBodyLtr();this._defaultPositionLookup={attribution:"manual",compass:b?"top-left":"top-right","navigation-toggle":b?"top-left":"top-right",zoom:b?"top-left":"top-right"}}return this._defaultPositionLookup[a]};g.prototype._removeComponents=
function(a){var b=this;a.forEach(function(a){if(a=b.find(a))b.remove(a),a.destroy()})};g.prototype._updateViewAwareWidgets=function(a){var b=this;this.components.forEach(function(c){(c=(c=b.find(c))&&c.widget)&&void 0!==c.view&&c.set("view",a)})};g.prototype._componentsWatcher=function(a,b){this._removeComponents(b);this._addComponents(a);this._adjustPadding(a)};g.prototype._adjustPadding=function(a){-1!==a.indexOf("attribution")||this._isOverridden("padding")||(this.padding=this.padding.top)};g.prototype._addComponents=
function(a){var b=this;this.initialized&&a.forEach(function(a){return b.add(b._createComponent(a),b._findComponentPosition(a))})};g.prototype._createComponent=function(a){var c=this._createWidget(a);if(c)return new b({id:a,node:c})};g.prototype._createWidget=function(a){if("attribution"===a)return this._createAttribution();if("compass"===a)return this._createCompass();if("navigation-toggle"===a)return this._createNavigationToggle();if("zoom"===a)return this._createZoom()};g.prototype._createAttribution=
function(){return new e({view:this.view})};g.prototype._createCompass=function(){return new r({view:this.view})};g.prototype._createNavigationToggle=function(){return new a({view:this.view})};g.prototype._createZoom=function(){return new t({view:this.view})};d([f.property()],g.prototype,"components",void 0);return g=d([f.subclass("esri.views.ui.DefaultUI")],g)}(f.declared(c))})},"esri/views/ui/Component":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper dojo/dom dojo/dom-class ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),
function(q,g,n,d,h,m,f,b){return function(c){function e(){var b=null!==c&&c.apply(this,arguments)||this;b.widget=null;return b}n(e,c);e.prototype.destroy=function(){this.widget&&this.widget.destroy();this.node=null};Object.defineProperty(e.prototype,"id",{get:function(){return this._get("id")||this.get("node.id")},set:function(b){this._set("id",b)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"node",{set:function(b){var a=this._get("node");b!==a&&(b&&m.add(b,"esri-component"),
a&&m.remove(a,"esri-component"),this._set("node",b))},enumerable:!0,configurable:!0});e.prototype.castNode=function(b){if(!b)return this._set("widget",null),null;if("string"===typeof b||b&&"nodeType"in b)return this._set("widget",null),h.byId(b);b&&"function"===typeof b.render&&!b.domNode&&(b.domNode=document.createElement("div"));this._set("widget",b);return b.domNode};d([b.property()],e.prototype,"id",null);d([b.property()],e.prototype,"node",null);d([b.cast("node")],e.prototype,"castNode",null);
d([b.property({readOnly:!0})],e.prototype,"widget",void 0);return e=d([b.subclass("esri.views.ui.Component")],e)}(b.declared(f))})},"esri/views/ui/UI":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper dojo/dom-class dojo/dom-construct dojo/dom-style ../../core/Accessor ../../core/domUtils ../../core/Evented ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ./Component".split(" "),
function(q,g,n,d,h,m,f,b,c,e,r,a,t,p,u){function l(a){return"object"!==typeof a||a&&a.isInstanceOf&&a.isInstanceOf(u)||!("component"in a||"index"in a||"position"in a)?null:a}var k={left:0,top:0,bottom:0,right:0},w={bottom:30,top:15,right:15,left:15};return function(c){function g(){var b=c.call(this)||this;b._cornerNameToContainerLookup={};b._positionNameToContainerLookup={};b._components=[];b._handles=new a;b._componentToKey=new Map;b.view=null;b._initContainers();return b}d(g,c);g.prototype.initialize=
function(){this._handles.add([t.init(this,"view.padding, container",this._applyViewPadding.bind(this)),t.init(this,"padding",this._applyUIPadding.bind(this))])};g.prototype.destroy=function(){this.container=null;this._components.forEach(function(a){a.destroy()});this._components.length=0;this._handles.destroy();this._componentToKey.clear();this._componentToKey=null};Object.defineProperty(g.prototype,"container",{set:function(a){var c=this._get("container");a!==c&&(a&&(a.classList.add("esri-ui"),this._attachContainers(a)),
c&&(c.classList.remove("esri-ui"),b.set(c,{top:"",bottom:"",left:"",right:""}),e.orphan(c)),this._set("container",a))},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"height",{get:function(){var a=this.get("view.height")||0;if(0===a)return a;var b=this._getViewPadding();return Math.max(a-(b.top+b.bottom),0)},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"padding",{get:function(){return this._get("padding")},set:function(a){a?this._override("padding",a):this._clearOverride("padding")},
enumerable:!0,configurable:!0});g.prototype.castPadding=function(a){return"number"===typeof a?{bottom:a,top:a,right:a,left:a}:n({},w,a)};Object.defineProperty(g.prototype,"width",{get:function(){var a=this.get("view.width")||0;if(0===a)return a;var b=this._getViewPadding();return Math.max(a-(b.left+b.right),0)},enumerable:!0,configurable:!0});g.prototype.add=function(a,b){var c=this,d,e;if(Array.isArray(a))a.forEach(function(a){return c.add(a,b)});else{var f=l(a);f&&(d=f.index,b=f.position,a=f.component,
e=f.key);b&&"object"===typeof b&&(d=b.index,e=b.key,b=b.position);!a||b&&!this._isValidPosition(b)||(a&&a.isInstanceOf&&a.isInstanceOf(u)||(a=new u({node:a})),this._place({component:a,position:b,index:d}),this._components.push(a),e&&this._componentToKey.set(a,e))}};g.prototype.remove=function(a,b){var c=this;if(a){if(Array.isArray(a))return a.map(function(a){return c.remove(a,b)});var d=this.find(a);if(d){var e=this._componentToKey;if(!e.has(a)||e.get(a)===b)return e=this._components.indexOf(d),d.node.parentNode&&
d.node.parentNode.removeChild(d.node),this._componentToKey.delete(a),this._components.splice(e,1)[0]}}};g.prototype.empty=function(a){var b=this;if(Array.isArray(a))return a.map(function(a){return b.empty(a)}).reduce(function(a,b){return a.concat(b)});a=a||"manual";if("manual"===a)return Array.prototype.slice.call(this._manualContainer.children).filter(function(a){return!m.contains(a,"esri-ui-corner")}).map(function(a){return b.remove(a)});if(this._isValidPosition(a))return Array.prototype.slice.call(this._cornerNameToContainerLookup[a].children).map(this.remove,
this)};g.prototype.move=function(a,b){var c=this;Array.isArray(a)&&a.forEach(function(a){return c.move(a,b)});if(a){var d,e=l(a)||l(b);e&&(d=e.index,b=e.position,a=e.component||a);(!b||this._isValidPosition(b))&&(a=this.remove(a))&&this.add(a,{position:b,index:d})}};g.prototype.find=function(a){return a?a&&a.isInstanceOf&&a.isInstanceOf(u)?this._findByComponent(a):"string"===typeof a?this._findById(a):this._findByNode(a.domNode||a):null};g.prototype._getViewPadding=function(){return this.get("view.padding")||
k};g.prototype._attachContainers=function(a){a.appendChild(this._manualContainer);a.appendChild(this._innerContainer)};g.prototype._initContainers=function(){var a=f.create("div",{className:"esri-ui-inner-container esri-ui-corner-container"}),b=f.create("div",{className:"esri-ui-inner-container esri-ui-manual-container"}),c=f.create("div",{className:"esri-ui-top-left esri-ui-corner"},a),d=f.create("div",{className:"esri-ui-top-right esri-ui-corner"},a),e=f.create("div",{className:"esri-ui-bottom-left esri-ui-corner"},
a),h=f.create("div",{className:"esri-ui-bottom-right esri-ui-corner"},a);this._innerContainer=a;this._manualContainer=b;this._cornerNameToContainerLookup={"top-left":c,"top-right":d,"bottom-left":e,"bottom-right":h};this._positionNameToContainerLookup=n({manual:b},this._cornerNameToContainerLookup)};g.prototype._isValidPosition=function(a){return!!this._positionNameToContainerLookup[a]};g.prototype._place=function(a){var b=a.component,c=a.index;a=this._positionNameToContainerLookup[a.position||"manual"];
var d;-1<c?(d=Array.prototype.slice.call(a.children),0===c?this._placeComponent(b,a,"first"):c>=d.length?this._placeComponent(b,a,"last"):this._placeComponent(b,d[c],"before")):this._placeComponent(b,a,"last")};g.prototype._placeComponent=function(a,b,c){var d=a.widget;d&&!d._started&&"function"===typeof d.postMixInProperties&&"function"===typeof d.buildRendering&&"function"===typeof d.postCreate&&"function"===typeof d.startup&&a.widget.startup();f.place(a.node,b,c)};g.prototype._applyViewPadding=
function(){var a=this.container;a&&b.set(a,this._toPxPosition(this._getViewPadding()))};g.prototype._applyUIPadding=function(){this._innerContainer&&b.set(this._innerContainer,this._toPxPosition(this.padding))};g.prototype._toPxPosition=function(a){return{top:this._toPxUnit(a.top),left:this._toPxUnit(a.left),right:this._toPxUnit(a.right),bottom:this._toPxUnit(a.bottom)}};g.prototype._toPxUnit=function(a){return 0===a?0:a+"px"};g.prototype._findByComponent=function(a){var b=null,c;this._components.some(function(d){(c=
d===a)&&(b=d);return c});return b};g.prototype._findById=function(a){var b=null,c;this._components.some(function(d){(c=d.id===a)&&(b=d);return c});return b};g.prototype._findByNode=function(a){var b=null,c;this._components.some(function(d){(c=d.node===a)&&(b=d);return c});return b};h([p.property()],g.prototype,"container",null);h([p.property({dependsOn:["view.height"]})],g.prototype,"height",null);h([p.property({value:w})],g.prototype,"padding",null);h([p.cast("padding")],g.prototype,"castPadding",
null);h([p.property()],g.prototype,"view",void 0);h([p.property({dependsOn:["view.width"]})],g.prototype,"width",null);return g=h([p.subclass("esri.views.ui.UI")],g)}(p.declared(c,r))})},"esri/widgets/Attribution":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./Attribution/nls/Attribution ../core/watchUtils ../core/accessorSupport/decorators ./Widget ./Attribution/AttributionViewModel ./support/widget".split(" "),function(q,g,
n,d,h,m,f,b,c,e){return function(b){function a(a){a=b.call(this)||this;a._isOpen=!1;a._attributionTextOverflowed=!1;a._prevSourceNodeHeight=0;a.iconClass="esri-icon-description";a.itemDelimiter=" | ";a.label=h.widgetLabel;a.view=null;a.viewModel=new c;return a}n(a,b);a.prototype.postInitialize=function(){var a=this;this.own(m.on(this,"viewModel.items","change",function(){return a.scheduleRender()}))};Object.defineProperty(a.prototype,"attributionText",{get:function(){return this.viewModel.items.reduce(function(a,
b){-1===a.indexOf(b.text)&&a.push(b.text);return a},[]).join(this.itemDelimiter)},enumerable:!0,configurable:!0});a.prototype.render=function(){var a,b=(a={},a["esri-attribution--open"]=this._isOpen,a);return e.tsx("div",{bind:this,class:this.classes("esri-attribution esri-widget",b),onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),e.tsx("div",{class:"esri-attribution__powered-by"},"Powered by"," ",e.tsx("a",{target:"_blank",href:"http://www.esri.com/",class:this.classes("esri-attribution__link",
"esri-widget__anchor")},"Esri")))};a.prototype._renderSourcesNode=function(){var a,b=this._isOpen,c=this._isInteractive(),d=c?0:-1,f=this.attributionText,h=c?"button":void 0,b=(a={},a["esri-attribution__sources--open"]=b,a["esri-interactive"]=c,a);return e.tsx("div",{afterCreate:this._afterSourcesNodeCreate,afterUpdate:this._afterSourcesNodeUpdate,bind:this,class:this.classes("esri-attribution__sources",b),innerHTML:f,role:h,tabIndex:d})};a.prototype._afterSourcesNodeCreate=function(a){this._prevSourceNodeHeight=
a.clientWidth};a.prototype._afterSourcesNodeUpdate=function(a){var b=!1,c=a.clientHeight;a=a.scrollWidth>=a.clientWidth;var d=this._attributionTextOverflowed!==a;this._attributionTextOverflowed=a;d&&(b=!0);this._isOpen&&(a=c<this._prevSourceNodeHeight,this._prevSourceNodeHeight=c,a&&(this._isOpen=!1,b=!0));b&&this.scheduleRender()};a.prototype._toggleState=function(){this._isInteractive()&&(this._isOpen=!this._isOpen)};a.prototype._isInteractive=function(){return this._isOpen||this._attributionTextOverflowed};
d([f.property({dependsOn:["viewModel.items.length","itemDelimiter"],readOnly:!0}),e.renderable()],a.prototype,"attributionText",null);d([f.property()],a.prototype,"iconClass",void 0);d([f.property(),e.renderable()],a.prototype,"itemDelimiter",void 0);d([f.property()],a.prototype,"label",void 0);d([f.aliasOf("viewModel.view")],a.prototype,"view",void 0);d([f.property({type:c}),e.renderable(["state","view.size"])],a.prototype,"viewModel",void 0);d([e.accessibleHandler()],a.prototype,"_toggleState",
null);return a=d([f.subclass("esri.widgets.Attribution")],a)}(f.declared(b))})},"esri/widgets/Attribution/AttributionViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../geometry ../../core/Accessor ../../core/arrayUtils ../../core/Collection ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ../../geometry/support/contains ../../geometry/support/webMercatorUtils".split(" "),function(q,g,n,d,h,
m,f,b,c,e,r,a,t){return function(m){function g(a){a=m.call(this,a)||this;a._handles=new c;a._pendingAttributionItemsByLayerId={};a._attributionDataByLayerId={};a.items=new b;a.view=null;a._updateAttributionItems=a._updateAttributionItems.bind(a);return a}n(g,m);g.prototype.initialize=function(){this._handles.add(e.init(this,"view",this._viewWatcher))};g.prototype.destroy=function(){this._handles.destroy();this.view=this._handles=null};Object.defineProperty(g.prototype,"state",{get:function(){return this.get("view.ready")?
"ready":"disabled"},enumerable:!0,configurable:!0});g.prototype._viewWatcher=function(a){var b=this,c=this._handles;c&&c.remove();a&&(c.add([a.allLayerViews.on("change",function(a){b._addLayerViews(a.added);0<a.removed.length&&(a.removed.forEach(function(a){c.remove(a.uid)}),b._updateAttributionItems())}),e.init(a,"stationary",this._updateAttributionItems)]),this._addLayerViews(a.allLayerViews))};g.prototype._addLayerViews=function(a){var b=this;a.forEach(function(a){b._handles.has(a.uid)||b._handles.add(e.init(a,
"suspended",b._updateAttributionItems),a.uid)})};g.prototype._updateAttributionItems=function(){var a=this,b=[];this._getActiveLayerViews().forEach(function(c){var d=c.layer;if(d&&"function"===typeof d.originOf&&"user"===d.originOf("copyright"))a._addIfUnique(b,{layer:d,text:d.copyright});else if(c=d.get("portalItem.accessInformation"))a._addIfUnique(b,{layer:d,text:c});else if(d.hasAttributionData){var e=a._attributionDataByLayerId;if(e[d.uid])a._addIfUnique(b,{layer:d,text:a._getDynamicAttribution(e[d.uid],
a.view,d)});else{var f=a._pendingAttributionItemsByLayerId;a._inProgress(f[d.uid])||(f[d.uid]=d.fetchAttributionData().then(function(b){b=a._createContributionIndex(b,a._isBingLayer(d));delete f[d.uid];e[d.uid]=b;a._updateAttributionItems()}))}}else a._addIfUnique(b,{layer:d,text:d.copyright})});this._itemsChanged(this.items,b)&&(this.items.removeAll(),this.items.addMany(b))};g.prototype._itemsChanged=function(a,b){return a.length!==b.length||a.some(function(a,c){return a.text!==b[c].text})};g.prototype._inProgress=
function(a){return a&&!a.isFulfilled()};g.prototype._getActiveLayerViews=function(){return this.get("view.allLayerViews").filter(function(a){return!a.suspended&&a.get("layer.attributionVisible")})};g.prototype._addIfUnique=function(a,b){var c=b.layer,d=b.text;d&&c&&(f.find(a,function(a){return a.layer===c&&a.text===d})||a.push({text:d,layer:c}))};g.prototype._isBingLayer=function(a){return"bing-maps"===a.type};g.prototype._createContributionIndex=function(a,b){a=a.contributors;var c={};if(!a)return c;
for(var d=0;d<a.length;d++){var e=a[d],f=e.coverageAreas;if(!f)return;for(var m=0;m<f.length;m++)for(var k=f[m],l=k.bbox,g=k.zoomMin-(b&&k.zoomMin?1:0),n=k.zoomMax-(b&&k.zoomMax?1:0),k={extent:t.geographicToWebMercator({xmin:l[1],ymin:l[0],xmax:l[3],ymax:l[2],spatialReference:h.SpatialReference.WGS84}),attribution:e.attribution||"",score:null!=k.score?k.score:100,id:d};g<=n;g++)c[g]=c[g]||[],c[g].push(k)}c.maxKey=Math.max.apply(null,Object.keys(c));return c};g.prototype._getDynamicAttribution=function(b,
c,d){var e=c.extent;d=d.tileInfo.scaleToZoom(c.scale);d=Math.min(b.maxKey,Math.round(d));if(!e||null==d||-1>=d)return"";b=b[d];var f=t.project(e.center.clone().normalize(),c.spatialReference),h={};return b.filter(function(b){var c=!h[b.id]&&f&&a.extentContainsPoint(b.extent,f);c&&(h[b.id]=!0);return c}).sort(function(a,b){return b.score-a.score||a.objectId-b.objectId}).map(function(a){return a.attribution}).join(", ")};d([r.property({readOnly:!0,type:b})],g.prototype,"items",void 0);d([r.property({dependsOn:["view.ready"],
readOnly:!0})],g.prototype,"state",null);d([r.property()],g.prototype,"view",void 0);return g=d([r.subclass("esri.widgets.Attribution.AttributionViewModel")],g)}(r.declared(m))})},"esri/widgets/Compass":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./Compass/nls/Compass ../core/accessorSupport/decorators ./Widget ./Compass/CompassViewModel ./support/widget".split(" "),function(q,g,n,d,h,m,f,b,c){return function(e){function f(a){a=
e.call(this)||this;a.goToOverride=null;a.iconClass="esri-icon-locate-circled";a.label=h.widgetLabel;a.view=null;a.viewModel=new b;return a}n(f,e);f.prototype.reset=function(){};f.prototype.render=function(){var a,b,d=this.viewModel,e=d.orientation,d=d.state,f="disabled"===d,m="compass"===("rotation"===d?"rotation":"compass"),d=f?-1:0,f=(a={},a["esri-disabled"]=f,a["esri-interactive"]=!f,a);a=(b={},b["esri-icon-compass"]=m,b["esri-icon-dial"]=!m,b);return c.tsx("div",{bind:this,class:this.classes("esri-compass esri-widget--button esri-widget",
f),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:d,"aria-label":h.reset,title:h.reset},c.tsx("span",{"aria-hidden":"true",class:this.classes("esri-compass__icon",a),styles:this._toRotationTransform(e)}),c.tsx("span",{class:"esri-icon-font-fallback-text"},h.reset))};f.prototype._reset=function(){this.viewModel.reset()};f.prototype._toRotationTransform=function(a){return{transform:"rotateZ("+a.z+"deg)"}};d([m.aliasOf("viewModel.goToOverride")],f.prototype,"goToOverride",void 0);d([m.property()],
f.prototype,"iconClass",void 0);d([m.property()],f.prototype,"label",void 0);d([m.aliasOf("viewModel.view")],f.prototype,"view",void 0);d([m.property({type:b}),c.renderable(["viewModel.orientation","viewModel.state"])],f.prototype,"viewModel",void 0);d([m.aliasOf("viewModel.reset")],f.prototype,"reset",null);d([c.accessibleHandler()],f.prototype,"_reset",null);return f=d([m.subclass("esri.widgets.Compass")],f)}(m.declared(f))})},"esri/widgets/Compass/CompassViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ../support/GoTo".split(" "),
function(q,g,n,d,h,m,f,b,c){return function(c){function e(a){a=c.call(this,a)||this;a._handles=new m;a.orientation={x:0,y:0,z:0};a.view=null;a._updateForCamera=a._updateForCamera.bind(a);a._updateForRotation=a._updateForRotation.bind(a);a._updateRotationWatcher=a._updateRotationWatcher.bind(a);return a}n(e,c);e.prototype.initialize=function(){this._handles.add(f.init(this,"view",this._updateRotationWatcher))};e.prototype.destroy=function(){this._handles.destroy();this.view=this._handles=null};Object.defineProperty(e.prototype,
"canShowNorth",{get:function(){var a=this.get("view.spatialReference");return a&&(a.isWebMercator||a.isWGS84)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"state",{get:function(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"},enumerable:!0,configurable:!0});e.prototype.reset=function(){if(this.get("view.ready")){var a={};"2d"===this.view.type?a.rotation=0:a.heading=0;this.callGoTo({target:a})}};e.prototype._updateForRotation=function(a){void 0!==
a&&null!==a&&(this.orientation={z:a})};e.prototype._updateForCamera=function(a){a&&(this.orientation={x:0,y:0,z:-a.heading})};e.prototype._updateRotationWatcher=function(a){this._handles.removeAll();a&&("2d"===a.type?this._handles.add(f.init(this,"view.rotation",this._updateForRotation)):this._handles.add(f.init(this,"view.camera",this._updateForCamera)))};d([b.property({dependsOn:["view.spatialReference.isWebMercator","view.spatialReference.wkid"],readOnly:!0})],e.prototype,"canShowNorth",null);
d([b.property()],e.prototype,"orientation",void 0);d([b.property({dependsOn:["view.ready","canShowNorth"],readOnly:!0})],e.prototype,"state",null);d([b.property()],e.prototype,"view",void 0);d([b.property()],e.prototype,"reset",null);return e=d([b.subclass("esri.widgets.CompassViewModel")],e)}(b.declared(h,c))})},"esri/widgets/NavigationToggle":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./NavigationToggle/nls/NavigationToggle ../core/accessorSupport/decorators ./Widget ./NavigationToggle/NavigationToggleViewModel ./support/widget".split(" "),
function(q,g,n,d,h,m,f,b,c){return function(e){function f(a){a=e.call(this)||this;a.iconClass="esri-icon-pan2";a.label=h.widgetLabel;a.view=null;a.viewModel=new b;return a}n(f,e);Object.defineProperty(f.prototype,"layout",{set:function(a){"horizontal"!==a&&(a="vertical");this._set("layout",a)},enumerable:!0,configurable:!0});f.prototype.toggle=function(){};f.prototype.render=function(){var a,b,d,e="disabled"===this.get("viewModel.state"),f="pan"===this.get("viewModel.navigationMode"),m=(a={},a["esri-disabled"]=
e,a["esri-navigation-toggle--horizontal"]="horizontal"===this.layout,a);a=(b={},b["esri-navigation-toggle__button--active"]=f,b);b=(d={},d["esri-navigation-toggle__button--active"]=!f,d);d=e?-1:0;return c.tsx("div",{bind:this,class:this.classes("esri-navigation-toggle esri-widget",m),onclick:this._toggle,onkeydown:this._toggle,tabIndex:d,"aria-label":h.toggle,title:h.toggle},c.tsx("div",{class:this.classes("esri-navigation-toggle__button esri-widget--button","esri-navigation-toggle__button--pan",
a)},c.tsx("span",{class:"esri-icon-pan"})),c.tsx("div",{class:this.classes("esri-navigation-toggle__button esri-widget--button","esri-navigation-toggle__button--rotate",b)},c.tsx("span",{class:"esri-icon-rotate"})))};f.prototype._toggle=function(){this.toggle()};d([m.property()],f.prototype,"iconClass",void 0);d([m.property()],f.prototype,"label",void 0);d([m.property({value:"vertical"}),c.renderable()],f.prototype,"layout",null);d([m.aliasOf("viewModel.view"),c.renderable()],f.prototype,"view",void 0);
d([m.property({type:b}),c.renderable(["viewModel.state","viewModel.navigationMode"])],f.prototype,"viewModel",void 0);d([m.aliasOf("viewModel.toggle")],f.prototype,"toggle",null);d([c.accessibleHandler()],f.prototype,"_toggle",null);return f=d([m.subclass("esri.widgets.NavigationToggle")],f)}(m.declared(f))})},"esri/widgets/NavigationToggle/NavigationToggleViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators".split(" "),
function(q,g,n,d,h,m,f,b){return function(c){function e(b){b=c.call(this,b)||this;b._handles=new m;b.navigationMode="pan";b.view=null;b.toggle=b.toggle.bind(b);return b}n(e,c);e.prototype.initialize=function(){this._handles.add(f.when(this,"view.inputManager",this._setNavigationMode.bind(this)))};e.prototype.destroy=function(){this._handles.destroy();this.view=this._handles=null};Object.defineProperty(e.prototype,"state",{get:function(){return this.get("view.ready")&&"3d"===this.view.type?"ready":
"disabled"},enumerable:!0,configurable:!0});e.prototype.toggle=function(){"disabled"!==this.state&&(this.navigationMode="pan"!==this.navigationMode?"pan":"rotate",this._setNavigationMode())};e.prototype._setNavigationMode=function(){this.get("view.inputManager").primaryDragAction="pan"===this.navigationMode?"pan":"rotate"};d([b.property({dependsOn:["view.ready"],readOnly:!0})],e.prototype,"state",null);d([b.property()],e.prototype,"navigationMode",void 0);d([b.property()],e.prototype,"view",void 0);
d([b.property()],e.prototype,"toggle",null);return e=d([b.subclass("esri.widgets.NavigationToggleViewModel")],e)}(b.declared(h))})},"esri/widgets/Zoom":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./Zoom/nls/Zoom ../core/accessorSupport/decorators ./Widget ./Zoom/IconButton ./Zoom/ZoomViewModel ./support/widget".split(" "),function(q,g,n,d,h,m,f,b,c,e){return function(f){function a(a){a=f.call(this)||this;a.iconClass="esri-icon-zoom-in-magnifying-glass";
a.label=h.widgetLabel;a.view=null;a.viewModel=new c;return a}n(a,f);a.prototype.postInitialize=function(){this._zoomInButton=new b({action:this.zoomIn,iconClass:"esri-icon-plus",title:h.zoomIn});this._zoomOutButton=new b({action:this.zoomOut,iconClass:"esri-icon-minus",title:h.zoomOut})};Object.defineProperty(a.prototype,"layout",{set:function(a){"horizontal"!==a&&(a="vertical");this._set("layout",a)},enumerable:!0,configurable:!0});a.prototype.render=function(){var a,b=this.viewModel,c=(a={},a["esri-zoom--horizontal"]=
"horizontal"===this.layout,a);this._zoomInButton.enabled="ready"===b.state&&b.canZoomIn;this._zoomOutButton.enabled="ready"===b.state&&b.canZoomOut;return e.tsx("div",{class:this.classes("esri-zoom esri-widget",c)},this._zoomInButton.render(),this._zoomOutButton.render())};a.prototype.zoomIn=function(){};a.prototype.zoomOut=function(){};d([m.property()],a.prototype,"iconClass",void 0);d([m.property()],a.prototype,"label",void 0);d([m.property({value:"vertical"}),e.renderable()],a.prototype,"layout",
null);d([m.aliasOf("viewModel.view"),e.renderable()],a.prototype,"view",void 0);d([m.property({type:c}),e.renderable(["viewModel.canZoomIn","viewModel.canZoomOut","viewModel.state"])],a.prototype,"viewModel",void 0);d([m.aliasOf("viewModel.zoomIn")],a.prototype,"zoomIn",null);d([m.aliasOf("viewModel.zoomOut")],a.prototype,"zoomOut",null);return a=d([m.subclass("esri.widgets.Zoom")],a)}(m.declared(f))})},"esri/widgets/Zoom/IconButton":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../Widget ../support/widget".split(" "),
function(q,g,n,d,h,m,f){return function(b){function c(){var c=null!==b&&b.apply(this,arguments)||this;c.enabled=!0;c.iconClass="";c.title="";return c}n(c,b);c.prototype.render=function(){var b,c,a=this.enabled?0:-1,d=(b={},b["esri-disabled"]=!this.enabled,b["esri-interactive"]=this.enabled,b);b=(c={},c[this.iconClass]=!!this.iconClass,c);return f.tsx("div",{bind:this,class:this.classes("esri-widget--button esri-widget",d),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:a,
title:this.title},f.tsx("span",{"aria-hidden":"true",role:"presentation",class:this.classes("esri-icon",b)}),f.tsx("span",{class:"esri-icon-font-fallback-text"},this.title))};c.prototype._triggerAction=function(){this.action.call(this)};d([h.property()],c.prototype,"action",void 0);d([h.property(),f.renderable()],c.prototype,"enabled",void 0);d([h.property({readOnly:!1}),f.renderable()],c.prototype,"iconClass",void 0);d([h.property(),f.renderable()],c.prototype,"title",void 0);d([f.accessibleHandler()],
c.prototype,"_triggerAction",null);return c=d([h.subclass("esri.widgets.IconButton")],c)}(h.declared(m))})},"esri/widgets/Zoom/ZoomViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ./ZoomConditions2D ./ZoomConditions3D".split(" "),function(q,g,n,d,h,m,f,b){return function(c){function e(b){b=c.call(this,b)||this;b.canZoomIn=null;b.canZoomOut=null;b.zoomIn=b.zoomIn.bind(b);
b.zoomOut=b.zoomOut.bind(b);return b}n(e,c);e.prototype.destroy=function(){this.view=null};Object.defineProperty(e.prototype,"state",{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"view",{set:function(c){c?"2d"===c.type?this._zoomConditions=new f({view:c}):"3d"===c.type&&(this._zoomConditions=new b):this._zoomConditions=null;this._set("view",c)},enumerable:!0,configurable:!0});e.prototype.zoomIn=function(){this.canZoomIn&&
this._zoomToFactor(.5)};e.prototype.zoomOut=function(){this.canZoomOut&&this._zoomToFactor(2)};e.prototype._zoomToFactor=function(b){if("ready"===this.state){var a=this.view;"3d"===this.view.type?a.goTo({zoomFactor:1/b}):a.goTo({scale:this.get("view.scale")*b})}};d([m.property()],e.prototype,"_zoomConditions",void 0);d([m.property({aliasOf:"_zoomConditions.canZoomIn",readOnly:!0})],e.prototype,"canZoomIn",void 0);d([m.property({aliasOf:"_zoomConditions.canZoomOut",readOnly:!0})],e.prototype,"canZoomOut",
void 0);d([m.property({dependsOn:["view.ready"],readOnly:!0})],e.prototype,"state",null);d([m.property()],e.prototype,"view",null);d([m.property()],e.prototype,"zoomIn",null);d([m.property()],e.prototype,"zoomOut",null);return e=d([m.subclass("esri.widgets.Zoom.ZoomViewModel")],e)}(m.declared(h))})},"esri/widgets/Zoom/ZoomConditions2D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),
function(q,g,n,d,h,m){return function(f){function b(){return null!==f&&f.apply(this,arguments)||this}n(b,f);Object.defineProperty(b.prototype,"canZoomIn",{get:function(){var b=this.get("view.animation.target.scale")||this.get("view.scale"),d=this.get("view.constraints.effectiveMaxScale");return 0===d||b>d},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"canZoomOut",{get:function(){var b=this.get("view.animation.target.scale")||this.get("view.scale"),d=this.get("view.constraints.effectiveMinScale");
return 0===d||b<d},enumerable:!0,configurable:!0});d([m.property({dependsOn:["view.ready","view.scale"],readOnly:!0})],b.prototype,"canZoomIn",null);d([m.property({dependsOn:["view.ready","view.scale"],readOnly:!0})],b.prototype,"canZoomOut",null);d([m.property()],b.prototype,"view",void 0);return b=d([m.subclass("esri.widgets.Zoom.ZoomConditions2D")],b)}(m.declared(h))})},"esri/widgets/Zoom/ZoomConditions3D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),
function(q,g,n,d,h,m){return function(f){function b(){var b=null!==f&&f.apply(this,arguments)||this;b.canZoomIn=!0;b.canZoomOut=!0;return b}n(b,f);d([m.property({readOnly:!0})],b.prototype,"canZoomIn",void 0);d([m.property({readOnly:!0})],b.prototype,"canZoomOut",void 0);return b=d([m.subclass("esri.widgets.Zoom.ZoomConditions3D")],b)}(m.declared(h))})},"esri/views/2d/layers/TileLayerView2D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Error ../../../core/promiseUtils ../../../core/accessorSupport/decorators ../engine/BitmapContainer ../engine/BitmapTile ./LayerView2D ./support/popupUtils2D ../tiling/TileInfoView ../tiling/TileKey ../tiling/TileQueue ../tiling/TileStrategy ../../layers/TileLayerView".split(" "),
function(q,g,n,d,h,m,f,b,c,e,r,a,t,p,u,l){var k=[0,0];return function(e){function l(){var a=null!==e&&e.apply(this,arguments)||this;a._tileStrategy=null;a._tileInfoView=null;a._fetchQueue=null;a._tileRequests=new Map;a.container=new b.BitmapContainer;a.layer=null;return a}n(l,e);l.prototype.initialize=function(){var a=this.layer.tileInfo,a=a&&a.spatialReference,b;a||(b=new h("layerview:tiling-information-missing","The layer doesn't provide tiling information",{layer:this.layer}));a.equals(this.view.spatialReference)||
(b=new h("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}));b&&this.addResolvingPromise(m.reject(b))};l.prototype.hitTest=function(a,b){return null};l.prototype.update=function(a){this._fetchQueue.pause();this._fetchQueue.state=a.state;this._tileStrategy.update(a);this._fetchQueue.resume();this.notifyChange("updating")};l.prototype.attach=function(){var b=this;this._tileInfoView=new a(this.layer.tileInfo,
this.layer.fullExtent);this._fetchQueue=new p({tileInfoView:this._tileInfoView,tileServers:"tileServers"in this.layer?this.layer.tileServers:null,concurrency:this.layer.url&&-1!==this.layer.url.indexOf("tiles.arcgis.com")?12:6,process:function(a,c){return b.fetchTile(a,c)}});this._tileStrategy=new u({cachePolicy:"keep",acquireTile:function(a){return b.acquireTile(a)},releaseTile:function(a){return b.releaseTile(a)},tileInfoView:this._tileInfoView})};l.prototype.detach=function(){this._tileStrategy.destroy();
this._fetchQueue.clear();this.container.removeAllChildren();this._fetchQueue=this._tileStrategy=this._tileInfoView=null};l.prototype.moveStart=function(){this.requestUpdate()};l.prototype.viewChange=function(){this.requestUpdate()};l.prototype.moveEnd=function(){this.requestUpdate()};l.prototype.createFetchPopupFeaturesQueryGeometry=function(a,b){return r.createQueryGeometry(a,b,this.view)};l.prototype.doRefresh=function(){var a=this;this.updateRequested||this.suspended||(this._fetchQueue.reset(),
this._tileStrategy.tiles.forEach(function(b){return a._enqueueTileFetch(b)}),this.notifyChange("updating"))};l.prototype.isUpdating=function(){var a=!0;this._tileRequests.forEach(function(b){a=a&&b.isFulfilled()});return!a};l.prototype.getTileBounds=function(a,b){return this._tileInfoView.getTileBounds(a,b)};l.prototype.getTileCoords=function(a,b){return this._tileInfoView.getTileCoords(a,b)};l.prototype.getTileResolution=function(a){return this._tileInfoView.getTileResolution(a)};l.prototype.acquireTile=
function(a){var b=c.BitmapTile.pool.acquire();b.key.set(a);a=this._tileInfoView.getTileCoords(k,b.key);b.x=a[0];b.y=a[1];b.resolution=this._tileInfoView.getTileResolution(b.key);this._enqueueTileFetch(b);this.requestUpdate();return b};l.prototype.releaseTile=function(a){var b=this,d=this._tileRequests.get(a);d&&!d.isFulfilled()&&d.cancel();this._tileRequests.delete(a);this.container.removeChild(a);a.once("detach",function(){c.BitmapTile.pool.release(a);b.requestUpdate()});this.requestUpdate()};l.prototype.fetchTile=
function(a,b){var c=this;if(b="tilemapCache"in this.layer?this.layer.tilemapCache:null){var d=t.pool.acquire();return b.fetchAvailabilityUpsample(a.level,a.row,a.col,d).then(function(){return c._fetchImage(d)}).catch(function(b){if("AbortError"===b.name)throw b;return c._fetchImage(a)}).then(function(b){if(d.level===a.level)return b;var e=c._tileInfoView.tileInfo.size,f=c._tileInfoView.getTileResolution(d.level),h=c._tileInfoView.getTileResolution(a.level),k=c._tileInfoView.getLODInfoAt(a.level),
l=k.getXForColumn(a.col),g=k.getYForRow(a.row),k=c._tileInfoView.getLODInfoAt(d.level),n=k.getXForColumn(d.col),k=k.getYForRow(d.row),p=Math.round((l-n)/f),q=Math.round(-(g-k)/f),r=Math.round(h/f*e[0]),t=Math.round(h/f*e[1]);return m.create(function(a){var c=document.createElement("canvas"),d=c.getContext("2d");c.width=e[0];c.height=e[1];d.drawImage(b,p,q,r,t,0,0,e[0],e[1]);a(c)})})}return this._fetchImage(a)};l.prototype._enqueueTileFetch=function(a){var b=this;if(!this._fetchQueue.has(a.key)){var c=
this._fetchQueue.push(a.key).then(function(c){a.source=c;a.width=b._tileInfoView.tileInfo.size[0];a.height=b._tileInfoView.tileInfo.size[1];a.once("attach",function(){return b.requestUpdate()});b.container.addChild(a);b.requestUpdate()});this._tileRequests.set(a,c)}};l.prototype._fetchImage=function(a){return this.layer.fetchTile(a.level,a.row,a.col,{timestamp:this.refreshTimestamp})};return l=d([f.subclass("esri.views.2d.layers.TileLayerView2D")],l)}(f.declared(e,l))})},"esri/views/2d/engine/BitmapContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ./Container ./webgl/enums".split(" "),
function(q,g,n,d,h,m){Object.defineProperty(g,"__esModule",{value:!0});q=function(d){function b(){return null!==d&&d.apply(this,arguments)||this}n(b,d);b.prototype.doRender=function(b){this.visible&&b.drawPhase===m.WGLDrawPhase.MAP&&d.prototype.doRender.call(this,b)};b.prototype.renderChildren=function(b){var c=this.stage.painter,d=this.children,a=b.drawPhase;this.sortChildren(function(a,b){return b.resolution-a.resolution});b.drawPhase=m.WGLDrawPhase.CLIP;c.startStencilBurn();for(var f=0,h=d.length;f<
h;f++){var g=d[f];g.attached&&g.visible&&(c.stencilRef=f,g.processRender(b))}b.drawPhase=a;c.startStencilDraw();f=0;for(h=d.length;f<h;f++)g=d[f],g.attached&&g.visible&&(c.stencilRef=f,g.processRender(b));c.endStencilDraw()};return b}(h.Container);g.BitmapContainer=q})},"esri/views/2d/engine/Container":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./DisplayObject"],function(q,g,n,d){Object.defineProperty(g,"__esModule",{value:!0});var h;(function(d){d[d.ATTACHING=
0]="ATTACHING";d[d.DETACHING=1]="DETACHING";d[d.RENDERING=2]="RENDERING";d[d.DONE=3]="DONE"})(h||(h={}));q=function(d){function f(){var b=null!==d&&d.apply(this,arguments)||this;b._childrenSet=new Set;b._childrenToAttach=[];b._childrenToDetach=[];b._renderPhase=h.DONE;b.children=[];return b}n(f,d);Object.defineProperty(f.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!0,configurable:!0});f.prototype.detach=function(){for(var b=0,c=this.children.concat(this._childrenToDetach);b<
c.length;b++){var d=c[b];d.attached&&(this.detachChild(d),d.attached=!1,d.parent=null)}};f.prototype.doRender=function(b){var c=b.globalOpacity;b.globalOpacity*=this.opacity;this._renderPhase=h.ATTACHING;this.attachChildren();this._renderPhase=h.DETACHING;for(var d=this._childrenToDetach;0<d.length;){var f=d.shift();this.detachChild(f);f.attached=!1;f.parent=null;f.stage=null}this._renderPhase=h.RENDERING;this.renderChildren(b);this._renderPhase=h.DONE;b.globalOpacity=c};f.prototype.addChild=function(b){return this.addChildAt(b,
this.children.length)};f.prototype.addChildAt=function(b,c){void 0===c&&(c=this.numChildren);if(!b||this.contains(b))return b;var d=b.parent;d&&d!==this&&d.removeChild(b);c>=this.numChildren?this.children.push(b):this.children.splice(c,0,b);this._childrenSet.add(b);c=this._childrenToDetach.indexOf(b);-1<c&&this._childrenToDetach.splice(c,1);this._childrenToAttach.push(b);this._renderPhase>=h.RENDERING&&this.requestRender();return b};f.prototype.contains=function(b){return this._childrenSet.has(b)};
f.prototype.getChildIndex=function(b){return this.children.indexOf(b)};f.prototype.getChildAt=function(b){return 0>b||b>this.children.length?null:this.children[b]};f.prototype.removeAllChildren=function(){for(var b=this.numChildren;b--;)this.removeChildAt(0)};f.prototype.removeChild=function(b){return this.contains(b)?this.removeChildAt(this.getChildIndex(b)):b};f.prototype.removeChildAt=function(b){if(0>b||b>=this.children.length)return null;b=this.children.splice(b,1)[0];this._childrenSet["delete"](b);
if(b.attached)this._childrenToDetach.push(b),this._renderPhase>=h.RENDERING&&this.requestRender();else{var c=this._childrenToAttach.indexOf(b);-1<c&&this._childrenToAttach.splice(c,1)}return b};f.prototype.requestChildRender=function(b){b&&b.parent===this&&this._renderPhase>=h.RENDERING&&this.requestRender()};f.prototype.setChildIndex=function(b,c){var d=this.getChildIndex(b);-1<d&&(this.children.splice(d,1),this.children.splice(c,0,b),this._renderPhase>=h.RENDERING&&this.requestRender())};f.prototype.sortChildren=
function(b){this._renderPhase>h.RENDERING&&this.requestRender();return this.children.sort(b)};f.prototype.attachChildren=function(){var b=this._childrenToAttach;if(0!==b.length)for(var c=0,d=!1;!d;)d=b[c],d.parent=this,d.stage=this.stage,this.attachChild(d)?(d.attached=!0,b.splice(c,1)):++c,d=b.length===c};f.prototype.renderChildren=function(b){for(var c=this.children,d=c.length,f=0;f<d;f++)c[f].processRender(b)};f.prototype.attachChild=function(b){return b.attach()};f.prototype.detachChild=function(b){b.detach()};
return f}(d.DisplayObject);g.Container=q})},"esri/views/2d/engine/DisplayObject":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./Evented"],function(q,g,n,d){Object.defineProperty(g,"__esModule",{value:!0});q=function(d){function h(){var f=null!==d&&d.apply(this,arguments)||this;f._renderRequestedCalled=!1;f._attached=!1;f._isReady=!1;f._opacity=1;f.renderRequested=!1;f._visible=!0;return f}n(h,d);Object.defineProperty(h.prototype,"attached",{get:function(){return this._attached},
set:function(d){this._attached!==d&&((this._attached=d)?this.hasEventListener("attach")&&this.emit("attach"):this.hasEventListener("detach")&&this.emit("detach"))},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"isReady",{get:function(){return this._attached&&this._isReady},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"opacity",{get:function(){return this._opacity},set:function(d){this._opacity!==d&&(this._opacity=d,this.requestRender())},enumerable:!0,configurable:!0});
Object.defineProperty(h.prototype,"visible",{get:function(){return this._visible},set:function(d){this._visible!==d&&(this._visible=d,this.requestRender())},enumerable:!0,configurable:!0});h.prototype.attach=function(){this.ready();return!0};h.prototype.detach=function(){};h.prototype.processRender=function(d){this.visible&&this.attached&&(this._renderRequestedCalled=!1,this.doRender(d),this._renderRequestedCalled||(this.renderRequested=!1),this.hasEventListener("post-render")&&this.emit("post-render"))};
h.prototype.requestRender=function(){var d=this.renderRequested;this.renderRequested=this._renderRequestedCalled=!0;this.parent&&this.parent.requestChildRender(this);d!==this.renderRequested&&this.hasEventListener("will-render")&&this.emit("will-render")};h.prototype.dispose=function(){};h.prototype.ready=function(){this._isReady=!0;this.hasEventListener("isReady")&&this.emit("isReady")};return h}(d.Evented);g.DisplayObject=q})},"esri/views/2d/engine/Evented":function(){define(["require","exports",
"../../../core/tsSupport/extendsHelper","dojo/aspect","dojo/on"],function(q,g,n,d,h){Object.defineProperty(g,"__esModule",{value:!0});q=function(){function m(){}m.prototype.on=function(f,b){return d.after(this,"on"+f,b,!0)};m.prototype.once=function(d,b){return h.once(this,d,b)};m.prototype.emit=function(d){h.emit(this,d,this)};m.prototype.hasEventListener=function(d){d="on"+d;return!(!this[d]||!this[d].after)};return m}();g.Evented=q;g.EventedMixin=function(m){return function(f){function b(){return null!==
f&&f.apply(this,arguments)||this}n(b,f);b.prototype.on=function(b,e){return d.after(this,"on"+b,e,!0)};b.prototype.once=function(b,d){return h.once(this,b,d)};b.prototype.emit=function(b,d){h.emit(this,b,d)};b.prototype.hasEventListener=function(b){b="on"+b;return!(!this[b]||!this[b].after)};return b}(m)}})},"esri/views/2d/engine/webgl/enums":function(){define(["require","exports"],function(q,g){Object.defineProperty(g,"__esModule",{value:!0});(function(g){g[g.FILL=0]="FILL";g[g.LINE=1]="LINE";g[g.MARKER=
2]="MARKER";g[g.TEXT=3]="TEXT";g[g.LABEL=4]="LABEL";g[g.NONE=5]="NONE";g[g.UNKNOWN=6]="UNKNOWN";g[g.COUNT=7]="COUNT"})(g.WGLGeometryType||(g.WGLGeometryType={}));(function(g){g[g.SUCCEEDED=0]="SUCCEEDED";g[g.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(g.WGLGeometryTransactionStatus||(g.WGLGeometryTransactionStatus={}));(function(g){g[g.NONE=0]="NONE";g[g.MAP=1]="MAP";g[g.LABEL=2]="LABEL";g[g.LABEL_ALPHA=4]="LABEL_ALPHA";g[g.HITTEST=8]="HITTEST";g[g.HIGHLIGHT=16]="HIGHLIGHT";g[g.CLIP=32]="CLIP";
g[g.DEBUG=64]="DEBUG";g[g.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(g.WGLDrawPhase||(g.WGLDrawPhase={}));(function(g){g[g.SIZE=0]="SIZE";g[g.COLOR=1]="COLOR";g[g.OPACITY=2]="OPACITY";g[g.ROTATION=3]="ROTATION"})(g.VVType||(g.VVType={}));(function(g){g[g.NONE=0]="NONE";g[g.OPACITY=1]="OPACITY";g[g.COLOR=2]="COLOR";g[g.ROTATION=4]="ROTATION";g[g.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";g[g.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";g[g.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";g[g.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(g.WGLVVFlag||
(g.WGLVVFlag={}));(function(g){g[g.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";g[g.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";g[g.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";g[g.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(g.WGLVVTarget||(g.WGLVVTarget={}));(function(g){g[g.UNKNOWN=0]="UNKNOWN";g[g.BUTT=1]="BUTT";g[g.ROUND=2]="ROUND";g[g.SQUARE=3]="SQUARE"})(g.CapType||(g.CapType={}));(function(g){g[g.UNKNOWN=0]="UNKNOWN";g[g.MITER=1]="MITER";g[g.BEVEL=2]="BEVEL";g[g.ROUND=
3]="ROUND"})(g.JoinType||(g.JoinType={}));(function(g){g.SIMPLE_MARKER="esriSMS";g.SIMPLE_LINE="esriSLS";g.SIMPLE_FILL="esriSFS";g.PICTURE_MARKER="esriPMS";g.PICTURE_FILL="esriPFS";g.TEXT="esriTS"})(g.EsriSymbolType||(g.EsriSymbolType={}));(function(g){g.SIMPLE_MARKER="simple-marker";g.SIMPLE_LINE="simple-line";g.SIMPLE_FILL="simple-fill";g.PICTURE_MARKER="picture-marker";g.PICTURE_FILL="picture-fill";g.TEXT="text"})(g.EsriSymbolTypeKebab||(g.EsriSymbolTypeKebab={}))})},"esri/views/2d/engine/BitmapTile":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../core/ObjectPool ../tiling ./Bitmap ./Tiled".split(" "),
function(q,g,n,d,h,m,f,b){Object.defineProperty(g,"__esModule",{value:!0});q=function(b){function c(c){c=b.call(this,c)||this;c.key=new m.TileKey(0,0,0,0);return c}n(c,b);c.prototype.acquire=function(b){};c.prototype.release=function(){this.key.set(0,0,0,0);this.source=null};c.pool=new h(c,!0);return c}(b(f.Bitmap));g.BitmapTile=q})},"esri/views/2d/engine/Bitmap":function(){define("require exports ../../../core/tsSupport/extendsHelper @dojo/framework/shim/Set ./DisplayObject ../../webgl/Texture".split(" "),
function(q,g,n,d,h,m){function f(a){var b=document.createElement("canvas");b.width=a.width;b.height=a.height;a.render(b.getContext("2d"));return b}function b(a){r.has(a)&&(e.splice(e.indexOf(a),1),r.delete(a))}Object.defineProperty(g,"__esModule",{value:!0});var c=[0,0],e=[],r=new d.default;q=function(a){function d(b){void 0===b&&(b=null);var c=a.call(this)||this;c._height=void 0;c.pixelRatio=1;c.resolution=0;c.rotation=0;c._source=null;c._width=void 0;c.x=0;c.y=0;c.source=b;c.requestRender=c.requestRender.bind(c);
return c}n(d,a);Object.defineProperty(d.prototype,"height",{get:function(){return void 0!==this._height?this._height:this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height},set:function(a){this._height=a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"source",{get:function(){return this._source},set:function(a){this._source=a;this.invalidateTexture()},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"width",{get:function(){return void 0!==
this._width?this._width:this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width},set:function(a){this._width=a},enumerable:!0,configurable:!0});d.prototype.attach=function(){this._texture=new m(this.stage.context,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,flipped:!0});this.updateTexture();return!0};d.prototype.detach=function(){this._texture.dispose();this._texture=null;b(this);a.prototype.detach.call(this)};d.prototype.invalidateTexture=
function(){this.attached?this.updateTexture():b(this)};d.prototype.updateTexture=function(){if(this._texture){var a=this.source;a?(this._texture.resize(this.width,this.height),a&&"render"in a?this._texture.setData(f(a)):!a||"render"in a||this._texture.setData(a),this.ready(),this.requestRender()):this._texture.setData(null)}};d.prototype.doRender=function(a){if(this.source&&0<this.width&&this.isReady){var b=this.stage,d=b.context,b=b.painter,e=a.state,f=a.pixelRatio,h=e.rotation,g=this.resolution/
this.pixelRatio/e.resolution;if(!(.05>g)){var m=e.toScreen(c,this.x,this.y),e=m[0],m=m[1];!(h+this.rotation)&&1.05>g&&.95<g?this._texture.setSamplingMode(9728):this._texture.setSamplingMode(9729);b.drawImage(d,this._texture,e,m,this.width*g,this.height*g,-Math.PI*h/180,-Math.PI*this.rotation/180,this.opacity*a.globalOpacity,f,a.drawPhase)}}};return d}(h.DisplayObject);g.Bitmap=q})},"esri/views/webgl/Texture":function(){define(["require","exports","../../core/has"],function(q,g,n){return function(){function d(h,
g,f){this._glName=this._context=null;this._id=-1;this._desc=void 0;this._wrapModeDirty=this._samplingModeDirty=!1;this._boundToUnits=new Set;this._context=h;this._desc={pixelFormat:g.pixelFormat,internalFormat:g.internalFormat,dataType:g.dataType,target:g.target?g.target:3553,samplingMode:g.samplingMode?g.samplingMode:9729,wrapMode:g.wrapMode?g.wrapMode:10497,maxAnisotropy:g.maxAnisotropy,flipped:void 0!==g.flipped?g.flipped:!1,hasMipmap:void 0!==g.hasMipmap?g.hasMipmap:!1,unpackAlignment:g.unpackAlignment?
g.unpackAlignment:4,width:g.width,height:g.height,preMultiplyAlpha:void 0!==g.preMultiplyAlpha?g.preMultiplyAlpha:!1};this._id=++d._nextId;this.setData(f)}Object.defineProperty(d.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0});d.prototype.dispose=
function(){var d=this;if(this._context){if(this._glName){var g=this._context.gl;this._boundToUnits.forEach(function(f){d._context.bindTexture(null,f)});g.deleteTexture(this._glName);this._glName=null}this._context=null}};d.prototype.resize=function(d,g){var f=this._desc;if(f.width!==d||f.height!==g)f.width=d,f.height=g,this.setData(null)};d.prototype.setData=function(h){var g=this._context.gl;this._glName||(this._glName=g.createTexture());void 0===h&&(h=null);null===h&&(this._desc.width=this._desc.width||
4,this._desc.height=this._desc.height||4);var f=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var b=this._desc;d._validateTexture(b);g.pixelStorei(g.UNPACK_ALIGNMENT,b.unpackAlignment);g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,b.flipped?1:0);g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b.preMultiplyAlpha?1:0);var c=b.pixelFormat,e=b.internalFormat?b.internalFormat:c;if(h instanceof ImageData||h instanceof HTMLImageElement||h instanceof HTMLCanvasElement||h instanceof HTMLVideoElement)b.width&&
b.height&&console.assert(h.width===b.width&&h.height===b.height),g.texImage2D(g.TEXTURE_2D,0,e,c,b.dataType,h),b.hasMipmap&&this.generateMipmap(),void 0===this._desc.width&&(this._desc.width=h.width),void 0===this._desc.height&&(this._desc.height=h.height);else{null!=b.width&&null!=b.height||console.error("Width and height must be specified!");g.DEPTH24_STENCIL8&&e===g.DEPTH_STENCIL&&(e=g.DEPTH24_STENCIL8);var n=b.width,a=b.height;if(null!=h&&"type"in h&&"compressed"===h.type)for(var q=0;;++q){g.compressedTexImage2D(g.TEXTURE_2D,
q,e,n,a,0,h.levels[Math.min(q,h.levels.length-1)]);if(1===n&&1===a||!b.hasMipmap)break;n=Math.max(1,n>>1);a=Math.max(1,a>>1)}else if(h)g.texImage2D(g.TEXTURE_2D,0,e,n,a,0,c,b.dataType,h),b.hasMipmap&&this.generateMipmap();else for(q=0;;++q){g.texImage2D(g.TEXTURE_2D,q,e,n,a,0,c,b.dataType,null);if(1===n&&1===a||!b.hasMipmap)break;n=Math.max(1,n>>1);a=Math.max(1,a>>1)}}d._applySamplingMode(g,this._desc);d._applyWrapMode(g,this._desc);d._applyAnisotropicFilteringParameters(this._context,this._desc);
this._context.bindTexture(f,0)};d.prototype.updateData=function(d,g,f,b,c,e){e||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");var h=this._context.gl,a=this._desc,m=this._context.getBoundTexture(0);this._context.bindTexture(this,0);(0>g||0>f||b>a.width||c>a.height||g+b>a.width||f+c>a.height)&&console.error("An attempt to update out of bounds of the texture!");e instanceof ImageData||e instanceof HTMLImageElement||e instanceof
HTMLCanvasElement||e instanceof HTMLVideoElement?(console.assert(e.width===b&&e.height===c),h.texSubImage2D(h.TEXTURE_2D,d,g,f,a.pixelFormat,a.dataType,e)):h.texSubImage2D(h.TEXTURE_2D,d,g,f,b,c,a.pixelFormat,a.dataType,e);this._context.bindTexture(m,0)};d.prototype.generateMipmap=function(){var h=this._desc;h.hasMipmap||(h.hasMipmap=!0,d._validateTexture(h));9729===h.samplingMode?(this._samplingModeDirty=!0,h.samplingMode=9985):9728===h.samplingMode&&(this._samplingModeDirty=!0,h.samplingMode=9984);
h=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var g=this._context.gl;g.generateMipmap(g.TEXTURE_2D);this._context.bindTexture(h,0)};d.prototype.setSamplingMode=function(h){h!==this._desc.samplingMode&&(this._desc.samplingMode=h,d._validateTexture(this._desc),this._samplingModeDirty=!0)};d.prototype.setWrapMode=function(h){h!==this._desc.wrapMode&&(this._desc.wrapMode=h,d._validateTexture(this._desc),this._wrapModeDirty=!0)};d.prototype.applyChanges=function(){var h=this._context.gl,
g=this._desc;this._samplingModeDirty&&(d._applySamplingMode(h,g),this._samplingModeDirty=!1);this._wrapModeDirty&&(d._applyWrapMode(h,g),this._wrapModeDirty=!1)};d.prototype.setBoundToUnit=function(d,g){g?this._boundToUnits.add(d):this._boundToUnits.delete(d)};d._isPowerOfTwo=function(d){return 0===(d&d-1)};d._validateTexture=function(h){(0>h.width||0>h.height)&&console.error("Negative dimension parameters are not allowed!");d._isPowerOfTwo(h.width)&&d._isPowerOfTwo(h.height)||("number"===typeof h.wrapMode?
33071!==h.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):33071===h.wrapMode.s&&33071===h.wrapMode.t||console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),h.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))};d._applySamplingMode=function(d,g){var f=g.samplingMode;if(9985===f||9987===f)f=9729;else if(9984===f||9986===f)f=9728;d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,f);d.texParameteri(d.TEXTURE_2D,
d.TEXTURE_MIN_FILTER,g.samplingMode)};d._applyWrapMode=function(d,g){"number"===typeof g.wrapMode?(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,g.wrapMode),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,g.wrapMode)):(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,g.wrapMode.s),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,g.wrapMode.t))};d._applyAnisotropicFilteringParameters=function(d,g){if(null!=g.maxAnisotropy){var f=d.capabilities.textureFilterAnisotropic;f&&(d=d.gl,d.texParameterf(d.TEXTURE_2D,
f.TEXTURE_MAX_ANISOTROPY,g.maxAnisotropy))}};d._nextId=0;return d}()})},"esri/views/2d/engine/Tiled":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./Evented"],function(q,g,n,d){return function(h){h=function(d){function f(){for(var b=0;b<arguments.length;b++);return d.call(this)||this}n(f,d);return f}(h);return d.EventedMixin(h)}})},"esri/views/2d/layers/LayerView2D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/watchUtils ../../../core/accessorSupport/decorators ../../layers/LayerView".split(" "),
function(q,g,n,d,h,m,f){return function(b){function c(){var c=null!==b&&b.apply(this,arguments)||this;c.attached=!1;c.lastUpdateId=-1;c.moving=!1;c.updateRequested=!1;return c}n(c,b);c.prototype.initialize=function(){var b=this;this.when(function(){b.requestUpdate()});h.init(this,"suspended",function(a){b.container.visible=!a;!a&&b.updateRequested&&b.view.requestLayerViewUpdate(b)},!0);h.init(this,"fullOpacity",function(a){b.container.opacity=a},!0);var c=function(){this.notifyChange("rendering")}.bind(this);
this.container.on("post-render",c);this.container.on("will-render",c)};c.prototype.destroy=function(){this.attached&&(this.attached=!1,this.detach());this.updateRequested=!1;this.layer=null};Object.defineProperty(c.prototype,"rendering",{get:function(){return this.attached&&!this.suspended&&(this.moving||this.container.renderRequested||this.isRendering())},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"updating",{get:function(){return!this.suspended&&(!this.attached||this.updateRequested||
this.isUpdating())},enumerable:!0,configurable:!0});c.prototype.isVisibleAtScale=function(b){var c=!0,a=this.layer,d=a.minScale,a=a.maxScale;if(null!=d&&null!=a){var c=!d,e=!a;!c&&b<=d&&(c=!0);!e&&b>=a&&(e=!0);c=c&&e}return c};c.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestLayerViewUpdate(this))};c.prototype.processUpdate=function(b){this.isFulfilled()&&!this.isResolved()?this.updateRequested=!1:(this._set("updateParameters",b),
this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(b)))};c.prototype.isUpdating=function(){return!1};c.prototype.isRendering=function(){return!1};c.prototype.canResume=function(){var b=this.inherited(arguments);b&&(b=this.isVisibleAtScale(this.view.scale));return b};d([m.property()],c.prototype,"attached",void 0);d([m.property()],c.prototype,"container",void 0);d([m.property()],c.prototype,"moving",void 0);d([m.property({dependsOn:["attached","suspended","moving"]})],c.prototype,
"rendering",null);d([m.property({dependsOn:["view.scale","layer.minScale","layer.maxScale"]})],c.prototype,"suspended",void 0);d([m.property({readOnly:!0})],c.prototype,"updateParameters",void 0);d([m.property()],c.prototype,"updateRequested",void 0);d([m.property({dependsOn:["updateRequested","attached"]})],c.prototype,"updating",null);d([m.property()],c.prototype,"view",void 0);return c=d([m.subclass("esri.views.2d.layers.LayerView2D")],c)}(m.declared(f))})},"esri/views/2d/layers/support/popupUtils2D":function(){define(["require",
"exports","../../../../core/tsSupport/extendsHelper","../../../../core/tsSupport/decorateHelper","../../../../geometry/Extent"],function(q,g,n,d,h){Object.defineProperty(g,"__esModule",{value:!0});g.createQueryGeometry=function(d,f,b){var c=b.get("state.resolution"),c=f*("number"===typeof c?c:1);f=d.clone().offset(-c,-c);d=d.clone().offset(c,c);return new h({xmin:Math.min(f.x,d.x),ymin:Math.min(f.y,d.y),xmax:Math.max(f.x,d.x),ymax:Math.max(f.y,d.y),spatialReference:b.spatialReference})}})},"esri/views/layers/TileLayerView":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Error ../../core/promiseUtils ../../core/accessorSupport/decorators ../../renderers/support/clickToleranceUtils ./RefreshableLayerView".split(" "),
function(q,g,n,d,h,m,f,b,c){return function(c){function e(a){return c.call(this,a)||this}n(e,c);e.prototype.fetchPopupFeatures=function(a){var c=this,d=this.layer;if(!a)return m.reject(new h("tilelayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:d}));if("tile"!==d.type)return m.reject(new h("tilelayerview:fetchPopupFeatures","Layer type should be 'tile'",{type:d.type}));var e=this.get("view.scale"),d=d.allSublayers.toArray().filter(function(a){var b=0===a.minScale||e<=a.minScale,
c=0===a.maxScale||e>=a.maxScale;return a.popupTemplate&&a.popupEnabled&&a.visible&&b&&c});return m.eachAlways(d.map(function(d){var e=d.createQuery(),f=b.calculateTolerance(d.renderer);e.geometry=c.createFetchPopupFeaturesQueryGeometry(a,f);e.outFields=d.get("popupTemplate.requiredFields");return d.queryFeatures(e).then(function(a){return a.features})})).then(function(a){return[].concat.apply([],a.map(function(a){return a.value}).filter(Boolean))})};d([f.property()],e.prototype,"layer",void 0);return e=
d([f.subclass("esri.views.layers.TileLayerView")],e)}(f.declared(c))})},"esri/renderers/support/clickToleranceUtils":function(){define(["require","exports"],function(q,g){function n(d,h){return h&&h.xoffset?Math.max(d,Math.abs(h.xoffset)):h&&h.yoffset?Math.max(d,Math.abs(h.yoffset)):d}Object.defineProperty(g,"__esModule",{value:!0});g.calculateTolerance=function(d){if(!d)return 6;if("simple"===d.type)return n(6,d.symbol);if("unique-value"===d.type){var h=6;d.uniqueValueInfos.forEach(function(d){h=
n(h,d.symbol)});return h}if("class-breaks"===d.type){var g=6;d.classBreakInfos.forEach(function(d){g=n(g,d.symbol)});return g}return 6}})},"esri/views/layers/RefreshableLayerView":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),function(q,g,n,d,h,m){return function(f){function b(){var b=null!==f&&f.apply(this,arguments)||this;b.refreshTimestamp=null;return b}n(b,f);
b.prototype.refresh=function(b){void 0===b&&(b=Date.now());this._set("refreshTimestamp",b);this.doRefresh&&this.doRefresh()};d([m.property()],b.prototype,"layer",void 0);d([m.aliasOf("layer.refreshInterval")],b.prototype,"refreshInterval",void 0);d([m.property({readOnly:!0})],b.prototype,"refreshTimestamp",void 0);return b=d([m.subclass("esri.layers.mixins.RefreshableLayerView")],b)}(m.declared(h))})},"*now":function(q){q(['dojo/i18n!*preload*esri/views/nls/MapView*["ar","ca","cs","da","de","el","en-gb","en-us","es-es","fi-fi","fr-fr","he-il","hu","it-it","ja-jp","ko-kr","nl-nl","nb","pl","pt-br","pt-pt","ru","sk","sl","sv","th","tr","zh-tw","zh-cn","ROOT"]'])},
"*noref":1}});
define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Error ../core/Handles ../core/has ../core/Logger ../core/promiseUtils ../core/watchUtils ../core/workers ../core/accessorSupport/decorators ../geometry/ScreenPoint ./BreakpointsOwner ./MapViewBase ./2d/input/MapViewInputManager ./2d/support/HighlightOptions ./support/screenshotUtils ./support/WebGLRequirements ./ui/2d/DefaultUI2D".split(" "),function(q,g,n,d,h,m,f,b,c,e,r,a,t,p,u,l,k,w,v,C){var A=
b.getLogger("esri.views.MapView"),x,z,y,B;return function(b){function g(a){var c=b.call(this,a)||this;c._graphicsView=null;c._mapViewHandles=new m;c._stage=null;c._resolveWhenReady=[];c.highlightOptions=new k;c.inputManager=new l({view:c});c.mapViewNavigation=null;c.supersampleScreenhotsEnabled=!0;c.ui=new C;c.rendering=!1;r.initialize();e.on(c,"graphics","change",function(a){for(var b=0,d=a.added;b<d.length;b++){var e=d[b];e.layer=c}b=0;for(a=a.removed;b<a.length;b++)e=a[b],e.layer=null},function(a){a.forEach(function(a){return a.layer=
c});c._graphicsView&&(c._graphicsView.graphics=a)},function(a){a.forEach(function(a){return a.layer=null});c._graphicsView&&(c._graphicsView.graphics=null)});return c}n(g,b);Object.defineProperty(g.prototype,"interacting",{get:function(){return this.mapViewNavigation&&this.mapViewNavigation.interacting||!1},enumerable:!0,configurable:!0});g.prototype.hitTest=function(a){a&&"esri.geometry.ScreenPoint"!==a.declaredClass&&(a=new t({x:a.x,y:a.y}));if(!this._setup||isNaN(a.x)||isNaN(a.y))return c.resolve({screenPoint:a,
results:[]});var b=this.toMap(a),d=[this._graphicsView];d.push.apply(d,this.allLayerViews.toArray().reverse());return c.all(d.map(function(b){return b&&b.hitTest?b.hitTest(a.x,a.y):null})).then(function(c){return{screenPoint:a,results:c.filter(function(a){return null!=a}).map(function(a){return{mapPoint:b,graphic:a}})}})};g.prototype.takeScreenshot=function(a){return this._setup?this._stage.takeScreenshot(w.toRenderSettings(a,this),this.allLayerViews):c.reject("Map view cannot be used before it is ready")};
g.prototype.on=function(a,b,c){var d=this.inputManager&&this.inputManager.viewEvents.register(a,b,c);return d?d:this.inherited(arguments)};g.prototype.hasEventListener=function(a){return this.inherited(arguments)||this.inputManager&&this.inputManager.viewEvents.hasHandler(a)};g.prototype.graphicChanged=function(a){this._graphicsView&&this._graphicsView.graphicUpdateHandler(a)};g.prototype.whenReady=function(){var a=this;return c.create(function(b){a._setup?b(a):a._resolveWhenReady.push(b)})};g.prototype.validate=
function(){var a=v.check({supportsMajorWebPerformanceCaveat:!0});f("safari")&&9>f("safari")&&(a=new h("mapview:browser-not-supported","This browser is not supported by MapView (Safari \x3c 9)",{type:"safari",requiredVersion:9,detectedVersion:f("safari")}));return a?(A.warn("#validate()",a.message),c.reject(a)):c.create(function(a){q(["./2d/RenderingCore2D"],function(b){x=b.Stage;z=b.GraphicsView2D;y=b.LabelManager;B=b.MapViewNavigation;a()})})};g.prototype._startup=function(){var a=this;if(!this._setup){this.inherited(arguments);
var b=new x(this.surface,{supersampleScreenshots:this.supersampleScreenhotsEnabled}),c=new z({view:this,graphics:this.graphics}),d=new B({view:this,animationManager:this.animationManager}),e=new y({view:this});this._stage=b;this._graphicsView=this._frameTask.graphicsView=c;this._set("mapViewNavigation",d);this._set("labelManager",e);this._mapViewHandles.add([this.allLayerViews.on("change",function(){return a._updateStageChildren()}),b.on("post-render",function(){return a._set("rendering",a.allLayerViews.some(function(a){return!0===
a.rendering}))}),this.watch("stationary",function(a){return b.stationary=a},!0),this.watch("state.viewpoint",function(c){return b.state=a.state},!0)]);b.state=this.state;this._updateStageChildren();c=this._resolveWhenReady;this._resolveWhenReady=[];c.forEach(function(b){return b(a)})}};g.prototype._tearDown=function(){this._setup&&(this.layerViewManager.clear(),this._graphicsView.destroy(),this._mapViewHandles.removeAll(),this._stage.destroy(),this.mapViewNavigation.destroy(),this._graphicsView=this._stage=
null,this.labelManager.destroy(),this._set("labelManager",null),this._set("mapViewNavigation",null),this.inherited(arguments))};g.prototype._updateStageChildren=function(){var a=this;this._stage.removeAllChildren();this.allLayerViews.filter(function(a){return null!=a.container}).forEach(function(b,c){a._stage.addChildAt(b.container,c)});this._stage.addChild(this._graphicsView.container)};d([a.property({type:k})],g.prototype,"highlightOptions",void 0);d([a.property({readOnly:!0})],g.prototype,"inputManager",
void 0);d([a.property({readOnly:!0})],g.prototype,"mapViewNavigation",void 0);d([a.property({dependsOn:["mapViewNavigation.interacting"],type:Boolean})],g.prototype,"interacting",null);d([a.property({type:Boolean,constructOnly:!0})],g.prototype,"supersampleScreenhotsEnabled",void 0);d([a.property({type:C})],g.prototype,"ui",void 0);d([a.property({readOnly:!0})],g.prototype,"rendering",void 0);return g=d([a.subclass("esri.views.MapView")],g)}(a.declared(u,p))});