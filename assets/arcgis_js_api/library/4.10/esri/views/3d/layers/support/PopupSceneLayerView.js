// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/Error ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators ../../../../support/graphicUtils ../LayerView3D ./popupUtils3D ../../../layers/support/popupUtils".split(" "),function(a,e,l,m,h,g,k,n,p,q,r){Object.defineProperty(e,"__esModule",{value:!0});a=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}l(c,a);c.prototype._validateFetchPopupFeatures=
function(){var b=this.layer,d=b.popupTemplate;if(!b.popupEnabled)return new h("scenelayerview3d:fetchPopupFeatures","Popups are disabled",{layer:b});if(!d)return new h("scenelayerview3d:fetchPopupFeatures","Layer does not define a popup template",{layer:b})};c.prototype.fetchPopupFeatures=function(b,d){var a=this._validateFetchPopupFeatures();if(a)return g.reject(a);b&&this.hasDraped&&this.loadedGraphics&&(d=q.queryDrapedGraphics({view:this.view,loadedGraphics:this.loadedGraphics,layer:this.layer,
popupTemplate:this.layer.popupTemplate,area:b,clientGraphics:d}));if(!d||0===d.length)return g.resolve([]);var c=[],f=[];b=r.getRequiredFields(this.layer);for(a=0;a<d.length;a++){var e=d[a];n.hasRequiredFields(e,b)?c.push(e):f.push(e)}return 0===f.length?g.resolve(c):this.whenGraphicAttributes(f,b).catch(function(){return f}).then(function(a){return c.concat(a)})};return c=m([k.subclass("esri.views.3d.layers.support.PopupSceneLayerView")],c)}(k.declared(p));e.PopupSceneLayerView=a;e.default=a});