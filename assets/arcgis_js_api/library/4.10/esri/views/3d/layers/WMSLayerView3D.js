// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../../geometry/Extent ../../../layers/support/ExportWMSImageParameters ./DynamicLayerView3D ../../layers/WMSLayerView".split(" "),function(p,q,h,g,c,k,l,m,n){return function(d){function a(){return null!==d&&d.apply(this,arguments)||this}h(a,d);a.prototype.initialize=function(){var f=this;this._exportWMSImageParameters=new l({layer:this.layer});this.handles.add(this._exportWMSImageParameters.watch("version",
function(a){f._imageVersion!==a&&(f._imageVersion=a,f.refetch())}))};a.prototype.destroy=function(){this._exportWMSImageParameters&&(this._exportWMSImageParameters.layer=null,this._exportWMSImageParameters.destroy(),this._exportWMSImageParameters=null)};a.prototype.canResume=function(){var a=this.inherited(arguments);return a?this.layer.supportsSpatialReference(this.view.spatialReference):a};a.prototype.createFetchPopupFeaturesQuery=function(a){var e=this.findExtentInfoAt(a),b=e.extent,b=new k(b[0],
b[1],b[2],b[3],e.spatialReference),e=e.imageSize,c=e.width,d=b.width/c;return{extent:b,width:c,height:e.height,x:Math.round((a.x-b.xmin)/d),y:Math.round((b.ymax-a.y)/d)}};a.prototype.beforeFetch=function(){this._imageVersion=this._exportWMSImageParameters.version};g([c.property({dependsOn:["view.spatialReference","layer.spatialReferences"]})],a.prototype,"suspended",void 0);return a=g([c.subclass("esri.views.3d.layers.WMSLayerView3D")],a)}(c.declared(m,n))});