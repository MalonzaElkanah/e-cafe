// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/Accessor ../../../../core/accessorSupport/decorators ../../../../layers/graphics/dehydratedFeatures ../../../../tasks/operations/query".split(" "),function(n,e,f,d,g,c,h,k){Object.defineProperty(e,"__esModule",{value:!0});var l=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}f(b,a);Object.defineProperty(b.prototype,"queryFeaturesDehydrated",{get:function(){var b=
this,a=this.layer.capabilities;if((a=a&&a.query)&&a.supportsFormatPBF){var c={type:"dehydrated",applyTransform:!0,useWorker:!0,maxStringAttributeLength:1024};return function(a,d){return k.executeQueryPBF(b.layer.parsedUrl,a,c,d).then(function(a){return a.data})}}return function(a,c){return k.executeQuery(b.layer.parsedUrl,a,c).then(function(a){return h.fromFeatureSetJSON(a.data)})}},enumerable:!0,configurable:!0});d([c.property({constructOnly:!0})],b.prototype,"layer",void 0);d([c.property({readOnly:!0,
dependsOn:["layer.capabilities.query.supportsFormatPBF"]})],b.prototype,"queryFeaturesDehydrated",null);return b=d([c.subclass("esri.views.3d.layers.support.featureTileQuery3D.FeatureTileServiceQuery3D")],b)}(c.declared(g)),m=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}f(b,a);b.prototype.queryFeaturesDehydrated=function(a,b){var c=this;return this.source.queryFeaturesJSON(a).then(h.fromFeatureSetJSON,function(b){if(b&&"query-features-json:unsupported"===b.name)return c.source.queryFeatures(a);
throw b;})};d([c.property({constructOnly:!0})],b.prototype,"layer",void 0);d([c.aliasOf("layer.source")],b.prototype,"source",void 0);return b=d([c.subclass("esri.views.3d.layers.support.featureTileQuery3D.FeatureTileClientQuery3D")],b)}(c.declared(g));e.createFeatureTileQuery3D=function(a){switch(a.source.type){case "feature-layer":return new l({layer:a});case "memory":case "csv":return new m({layer:a});case "stream-layer":throw Error("Tile based queries unsupported for stream sources");}}});