// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/accessorSupport/decorators ../../../../core/libs/gl-matrix-2/gl-matrix ../../../../geometry/Point ../geometryUtils ../mathUtils ../PropertiesPool ./PointOfInterest".split(" "),function(f,m,p,k,g,d,q,r,t,u,v){Object.defineProperty(m,"__esModule",{value:!0});var w=Array;f=function(f){function b(a){a=f.call(this,a)||this;a.propertiesPool=new u.default({locationOnSurface:q,
renderLocationOnSurface:w},a);a.centerOnSurface=null;return a}p(b,f);Object.defineProperty(b.prototype,"locationOnSurface",{get:function(){var a=this.propertiesPool.get("locationOnSurface");this.renderCoordsHelper.fromRenderCoords(this.renderLocationOnSurface,a,this.state.spatialReference);return a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"renderLocationOnSurface",{get:function(){var a=this.centerOnSurface.renderLocation,c=this.renderCoordsHelper,b=this.calculateScreenHorizontalEdgeOnSurface(x);
d.vec3.subtract(l,a,this.state.camera.eye);d.vec3.normalize(l,l);c.worldUpAtPosition(a,n);var e=Math.abs(Math.acos(d.vec3.dot(n,l))-.5*Math.PI),c=this.propertiesPool.get("renderLocationOnSurface"),e=1-t.clamp(e/(.5*Math.PI),0,1);d.vec3.lerp(c,a,b,e*e*e);return c},enumerable:!0,configurable:!0});b.prototype.update=function(a){};b.prototype.forceUpdate=function(){};b.prototype.hasPendingUpdates=function(){return this.centerOnSurface.hasPendingUpdates()};b.prototype.calculateScreenHorizontalEdgeOnSurface=
function(a){var c=this.state.camera,b=this.renderCoordsHelper.getAltitude(this.centerOnSurface.renderLocation),e=this.renderCoordsHelper.getAltitude(c.eye)>=b?c.padding[2]:c.fullHeight-c.padding[0];c.unprojectPoint([c.padding[3]+c.width/2,e,.5],h);d.vec3.subtract(h,h,c.eye);e=d.vec3.normalize(h,h);this.renderCoordsHelper.intersectManifold(r.ray.wrap(c.eye,e),b,a)||(d.vec3.copy(a,c.eye),this.renderCoordsHelper.setAltitude(b,a));return a};k([g.property({constructOnly:!0})],b.prototype,"centerOnSurface",
void 0);k([g.property({readOnly:!0,dependsOn:["renderLocationOnSurface"]})],b.prototype,"locationOnSurface",null);k([g.property({readOnly:!0,dependsOn:["centerOnSurface.renderLocation"]})],b.prototype,"renderLocationOnSurface",null);return b=k([g.subclass("esri.views.3d.support.CenterOnSurface")],b)}(g.declared(v.PointOfInterest));m.Focus=f;var l=d.vec3f64.create(),n=d.vec3f64.create(),h=d.vec3f64.create(),x=d.vec3f64.create();m.default=f});