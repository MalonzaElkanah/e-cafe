// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/libs/gl-matrix-2/gl-matrix ../../../geometry/support/aaBoundingBox ./dito ./geometryUtils".split(" "),function(p,d,e,q,r,h){function l(a,b,c){return{center:e.vec3f64.clone(a),halfSize:e.vec3f32.clone(b),quaternion:e.quatf32.clone(c)}}function f(a,b){var c=h.plane.signedDistance(b,a.center);a=m(a,b);return c>a?1:c<-a?-1:0}function m(a,b){e.quat.conjugate(n,a.quaternion);e.vec3.transformQuat(k,b,n);a=a.halfSize;return Math.abs(k[0]*a[0])+Math.abs(k[1]*a[1])+Math.abs(k[2]*
a[2])}Object.defineProperty(d,"__esModule",{value:!0});var n=e.quatf32.create(),k=e.vec3f32.create(),t=e.vec3f32.create(),u=e.mat3f32.create();p=function(){return function(a){this.buffer=new ArrayBuffer(56*a);this.obbs=Array(a);for(var b=0;b<a;b++)this.obbs[b]={center:e.vec3f64.createView(this.buffer,56*b+0),halfSize:e.vec3f32.createView(this.buffer,56*b+24),quaternion:e.quatf32.createView(this.buffer,56*b+36)}}}();d.ObbArray=p;d.create=l;d.clone=function(a){return l(a.center,a.halfSize,a.quaternion)};
d.set=function(a,b){e.vec3.copy(b.center,a.center);e.vec3.copy(b.halfSize,a.halfSize);e.quat.copy(b.quaternion,a.quaternion)};d.compute=function(a,b){b||(b=l([0,0,0],[-1,-1,-1],[0,0,0,1]));r.computeOBB(a,b);return b};d.intersectPlane=f;d.toAaBoundingBox=function(a,b){b||(b=q.create());var c=e.mat3.fromQuat(u,a.quaternion),d=a.halfSize[0]*Math.abs(c[0])+a.halfSize[1]*Math.abs(c[3])+a.halfSize[2]*Math.abs(c[6]),f=a.halfSize[0]*Math.abs(c[1])+a.halfSize[1]*Math.abs(c[4])+a.halfSize[2]*Math.abs(c[7]),
c=a.halfSize[0]*Math.abs(c[2])+a.halfSize[1]*Math.abs(c[5])+a.halfSize[2]*Math.abs(c[8]);b[0]=a.center[0]-d;b[1]=a.center[1]-f;b[2]=a.center[2]-c;b[3]=a.center[0]+d;b[4]=a.center[1]+f;b[5]=a.center[2]+c;return b};d.minimumDistancePlane=function(a,b){var c=h.plane.signedDistance(b,a.center);a=m(a,b);return c-a};d.maximumDistancePlane=function(a,b){var c=h.plane.signedDistance(b,a.center);a=m(a,b);return c+a};d.isVisible=function(a,b){return 0>=f(a,b.planes[0])&&0>=f(a,b.planes[1])&&0>=f(a,b.planes[2])&&
0>=f(a,b.planes[3])&&0>=f(a,b.planes[4])&&0>=f(a,b.planes[5])};d.intersectLine=function(a,b,c,d){void 0===d&&(d=0);e.quat.conjugate(n,a.quaternion);e.vec3.subtract(k,b,a.center);b=e.vec3.transformQuat(k,k,n);c=e.vec3.transformQuat(t,c,n);for(var f=-Infinity,h=Infinity,g=0;3>g;g++)if(1E-6<Math.abs(c[g]))var l=(d+a.halfSize[g]-b[g])/c[g],m=(-d-a.halfSize[g]-b[g])/c[g],f=Math.max(f,Math.min(l,m)),h=Math.min(h,Math.max(l,m));else if(b[g]>a.halfSize[g]+d||b[g]<-a.halfSize[g]-d)return!1;return f<=h}});