// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/libs/gl-matrix-2/gl-matrix ./common ../../support/geometryUtils ../../support/intersectionUtils ../../support/mathUtils".split(" "),function(x,e,h,k,p,q,n){function m(b,d,c){void 0===c&&(c=k.defaultApplyOptions);var a;a=b.state.constraints.altitude;a=b.state.isGlobal&&a?2===c.interactionType&&k.hasConstraintType(c.selection,1)?!1:!0:!1;if(!a)return 0;var g=b.state.constraints.altitude;a=r;a.min=g.min;a.max=g.max;var f=c.interactionType;if(0!==f){var g=a.min,
h=a.max,l=c.interactionStartCamera;c=c.interactionFactor;var f=2===f||1===f,e=m(b,l),l=0===e?0:b.renderCoordsHelper.getAltitude(l.eye);a.min=g;a.max=h;k.adjustRangeForInteraction(e,l,f,c,.05*l,a)}b=b.renderCoordsHelper.getAltitude(d.eye);b=n.clamp(b,a.min,a.max)-b;return 1E-6>=Math.abs(b)?0:b}function t(b,d,c,a){b.renderCoordsHelper.worldUpAtPosition(d.eye,a);h.vec3.scale(a,a,c);return a}Object.defineProperty(e,"__esModule",{value:!0});e.apply=function(b,d,c,a){void 0===c&&(c=k.defaultApplyOptions);
void 0===a&&(a=d);a!==d&&a.copyFrom(d);var g=m(b,d,c);if(0===g)return!1;var f=b.renderCoordsHelper,e=f.getAltitude(d.eye)+g;b=k.interactionDirectionTowardsConstraintMinimization(b,d,c.interactionDirection,t(b,d,n.sign(g),u),v);c=h.vec3.copy(w,d.viewForward);f.intersectInfiniteManifold(p.ray.wrap(d.eye,b),e,a.eye)||f.setAltitude(e,a.eye);q.closestPointOnRay(d.eye,c,d.center,d.center);a.markViewDirty();return!0};e.error=m;var r={min:0,max:0},v=h.vec3f64.create(),u=h.vec3f64.create(),w=h.vec3f64.create()});