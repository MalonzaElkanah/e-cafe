// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/compilerUtils ../../../../core/libs/gl-matrix-2/gl-matrix ../../../../geometry/SpatialReference ../../support/projectionUtils ./Geometry ./GeometryData ./Layer ./localOrigin ./Object3D ./Util ../materials/RibbonLineMaterial ../parts/Model".split(" "),function(m,E,u,p,v,w,x,y,z,q,A,t,B,n){var C=0;m=function(){function l(){this.ROOT_ORIGIN_ID="rg_root_"+C++;this._origins=new Map;this._gridSize=42E5;if(u.isSome(l.testOrigin)){var a=l.testOrigin;this._origins.set(this.ROOT_ORIGIN_ID,
q.fromValues(a[0],a[1],a[2],this.ROOT_ORIGIN_ID))}}l.prototype.getOrigin=function(a){var f=this._origins.get(this.ROOT_ORIGIN_ID);if(null==f){var b=q.fromValues(a[0]+Math.random()-.5,a[1]+Math.random()-.5,a[2]+Math.random()-.5,this.ROOT_ORIGIN_ID);this._origins.set(this.ROOT_ORIGIN_ID,b);return b}p.vec3.subtract(c,a,f.vec3);c[0]=Math.abs(c[0]);c[1]=Math.abs(c[1]);c[2]=Math.abs(c[2]);b=this._gridSize;if(c[0]<b&&c[1]<b&&c[2]<b)return f;var f=Math.round(a[0]/b),d=Math.round(a[1]/b);a=Math.round(a[2]/
b);var r="rg_"+f+"/"+d+"/"+a,g=this._origins.get(r);g||(g=q.fromValues(f*b,d*b,a*b,r),this._origins.set(r,g));return g};l.prototype._drawOriginBox=function(a){var f=window.view,b=f._stage;if(null==this._object){this._material=new B({width:2,color:[0,1,0,1]},"GridLocalOriginMaterial");b.add(n.ContentType.MATERIAL,this._material);var d=new z("GridLocalOrigin",{isPickable:!1},"GridLocalOrigin");b.add(n.ContentType.LAYER,d);this._object=new A({name:"GridLocalOrigin",idHint:"GridLocalOrigin",castShadow:!1});
b.add(n.ContentType.OBJECT,this._object);d.addObject(this._object);b.addToViewContent([d.id])}for(var c=[0,1,5,4,0,2,1,7,6,2,0,1,3,7,5,4,6,2,0],g=c.length,h=new Float32Array(3*g),d=new Uint32Array(2*(g-1)),k=.5*this._gridSize,e=0;e<g;e++)h[3*e+0]=a[0]+(c[e]&1?k:-k),h[3*e+1]=a[1]+(c[e]&2?k:-k),h[3*e+2]=a[2]+(c[e]&4?k:-k),0<e&&(d[2*e+0]=e-1,d[2*e+1]=e);w.bufferToBuffer(h,v.WebMercator,0,h,f.spatialReference,0,g);f={};f[t.VertexAttrConstants.POSITION]={size:3,data:h};h={};h[t.VertexAttrConstants.POSITION]=
d;d=new y(f,h,void 0,"line");d=new x(d,"GridLocalOriginBox");b.add(n.ContentType.GEOMETRY,d);this._object.addGeometry(d,this._material,D);console.log(this._origins.size,a)};return l}();var D=p.mat4f64.create(),c=p.vec3f64.create();(m||(m={})).testOrigin=null;return m});