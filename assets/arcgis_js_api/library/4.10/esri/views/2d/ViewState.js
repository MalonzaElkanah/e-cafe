// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../geometry ../../Viewpoint ../../core/JSONSupport ../../core/accessorSupport/decorators ./../../core/libs/gl-matrix-2/gl-matrix ../../core/libs/gl-matrix-2/types/vec2 ./viewpointUtils".split(" "),function(v,w,t,l,p,q,u,g,c,m,k){var e=[0,0];return function(r){function b(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];a=r.apply(this,a)||this;a._viewpoint2D={center:c.vec2f64.create(),
rotation:0,scale:0,spatialReference:null};a.center=[0,0];a.extent=new p.Extent;a.id=0;a.inverseTransform=c.mat2df64.create();a.resolution=0;a.rotation=0;a.scale=0;a.transform=c.mat2df64.create();a.transformNoRotation=c.mat2df64.create();a.displayMat3=c.mat3f32.create();a.displayViewMat3=c.mat3f32.create();a.viewMat3=c.mat3f32.create();a.viewMat2d=c.mat2df32.create();a.worldScreenWidth=0;a.size=[0,0];return a}t(b,r);n=b;Object.defineProperty(b.prototype,"pixelRatio",{set:function(a){this._set("pixelRatio",
a);this._update()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"size",{set:function(a){this._set("size",a);this._update()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"viewpoint",{set:function(a){if(a){var d=this._viewpoint2D,c=a.targetGeometry;d.center[0]=c.x;d.center[1]=c.y;d.rotation=a.rotation;d.scale=a.scale;d.spatialReference=c.spatialReference}this._update()},enumerable:!0,configurable:!0});b.prototype.copy=function(a){var d=this.size,b=this.viewpoint;
b&&d?(this.viewpoint=k.copy(b,a.viewpoint),this._set("size",c.vec2.copy(d,a.size))):(this.viewpoint=a.viewpoint.clone(),this._set("size",[a.size[0],a.size[1]]));this._set("pixelRatio",a.pixelRatio);return this};b.prototype.clone=function(){return new n({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})};b.prototype.toMap=function(a,d,b){if(m.isVec2(d))return c.vec2.transformMat2d(a,d,this.inverseTransform);e[0]=d;e[1]=b;return c.vec2.transformMat2d(a,e,this.inverseTransform)};
b.prototype.toScreen=function(a,d,b){if(m.isVec2(d))return c.vec2.transformMat2d(a,d,this.transform);e[0]=d;e[1]=b;return c.vec2.transformMat2d(a,e,this.transform)};b.prototype.toScreenNoRotation=function(a,d,b){if(m.isVec2(d))return c.vec2.transformMat2d(a,d,this.transformNoRotation);e[0]=d;e[1]=b;return c.vec2.transformMat2d(a,e,this.transformNoRotation)};b.prototype.pixelSizeAt=function(a){return k.pixelSizeAt(a,this.viewpoint,this.size)};b.prototype.getScreenTransform=function(a,c){var d=this._viewpoint2D.center,
b=this._get("pixelRatio")||1,e=this._get("size");k.getMatrix(a,d,e,c,0,b);return a};b.prototype._update=function(){var a=this._viewpoint2D,d=a.center,b=a.spatialReference,f=a.scale,e=a.rotation,a=this._get("pixelRatio")||1,h=this._get("size");this._set("id",this.id+1);var g=new q({targetGeometry:new p.Point(d[0],d[1],b),scale:f,rotation:e});this._set("viewpoint",g);if(h&&b&&f)return this.resolution=k.getResolution(g),this.rotation=e,this.scale=f,this.spatialReference=b,c.vec2.copy(this.center,d),
c.mat3.set(this.displayMat3,2/h[0],0,0,0,-2/h[1],0,-1,1,1),f=c.mat3.identity(this.viewMat3),d=c.vec2f32.fromValues(h[0]/2,h[1]/2),b=c.vec2f32.fromValues(-h[0]/2,-h[1]/2),e=c.common.toRadian(e),c.mat3.translate(f,f,d),c.mat3.rotate(f,f,e),c.mat3.translate(f,f,b),c.mat3.multiply(this.displayViewMat3,this.displayMat3,f),f=c.mat2d.identity(this.viewMat2d),c.mat2d.translate(f,f,d),c.mat2d.rotate(f,f,e),c.mat2d.translate(f,f,b),k.getExtent(this.extent,g,h),k.getTransform(this.transform,g,h,a),c.mat2d.invert(this.inverseTransform,
this.transform),k.getTransformNoRotation(this.transformNoRotation,g,h,a),this.worldScreenWidth=k.getWorldScreenWidth(this.spatialReference,this.resolution),this};var n;l([g.property({readOnly:!0})],b.prototype,"id",void 0);l([g.property({value:1,json:{write:!0}})],b.prototype,"pixelRatio",null);l([g.property({json:{write:!0}})],b.prototype,"size",null);l([g.property({type:q,json:{write:!0}})],b.prototype,"viewpoint",null);return b=n=l([g.subclass("esri.views.2d.ViewState")],b)}(g.declared(u))});