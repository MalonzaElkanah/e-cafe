// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/extendsHelper ../../../../core/promiseUtils ../Container ./enums ./WGLRendererInfo".split(" "),function(d,f,h,k,l,m,n,p){Object.defineProperty(f,"__esModule",{value:!0});d=function(d){function c(a){var b=d.call(this)||this;b._displayHeight=0;b._displayWidth=0;b._rendererInfo=new p;b._highlightOptionsUpToDate=!1;b.tileInfoView=a.tileInfoView;b.highlightOptions=a.highlightOptions;b.highlightIDs=a.highlightIDs;
b.getMaterialItems=b.getMaterialItems.bind(b);return b}k(c,d);c.prototype.dispose=function(){this.removeAllChildren();for(var a=0,b=this.children;a<b.length;a++)b[a].dispose()};c.prototype.disposeWebGLResources=function(){for(var a=0,b=this.children;a<b.length;a++)b[a].clear()};c.prototype.displayWidth=function(){return this._displayWidth};Object.defineProperty(c.prototype,"displayHeight",{get:function(){return this._displayHeight},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"highlightOptions",{get:function(){return this._highlightOptions},set:function(a){this._highlightOptions=a;this._highlightOptionsUpToDate=!1},enumerable:!0,configurable:!0});c.prototype.setVisibility=function(a,b){};c.prototype.getMaterialItems=function(a){if(a&&0!==a.length){for(var b=[],e=this.stage.painter.textureManager,c=0;c<a.length;c++){var g=a[c];b.push(e.rasterizeItem(g.symbol,g.glyphIds))}return l.all(b).then(function(b){return b.map(function(b,e){return{id:a[e].id,mosaicItem:b}})})}};c.prototype.renderChildren=
function(a){var b=this.stage.painter;this._updateTilesTransform(a.state,this.tileInfoView.getClosestInfoForScale(a.state.scale).level);this._updateHighlightOptions();if(a.drawPhase===n.WGLDrawPhase.MAP){var e=this.tileInfoView.getClosestInfoForScale(a.state.scale).level,c=this.tileInfoView.tileInfo.scaleToZoom(a.state.scale);a=h({},a,{rendererInfo:this._rendererInfo,requiredLevel:e,displayLevel:c,context:this.stage.context,painter:b});this.sortChildren(function(a,b){return 0!==a.key.level-b.key.level?
a.key.level-b.key.level:0!==a.key.row-b.key.row?a.key.row-b.key.row:a.key.col-b.key.col});b.draw(a,this.children,a.drawPhase,null);0<this.highlightIDs.size&&b.highlight(a,this.children)}};c.prototype._updateTilesTransform=function(a,b){b=0;for(var e=this.children;b<e.length;b++){var c=e[b];c.setTransform(a,this.tileInfoView.tileInfo.lods[c.key.level].resolution/(a.resolution*a.pixelRatio))}};c.prototype._updateHighlightOptions=function(){if(!this._highlightOptionsUpToDate&&this.parent&&this._highlightOptions){var a=
this.stage.painter,b=this._highlightOptions;if(a){var c=b.color.toRgba();c[0]/=255;c[1]/=255;c[2]/=255;var d=c.slice();c[3]*=b.fillOpacity;d[3]*=b.haloOpacity;a.setHighlightOptions({fillColor:c,outlineColor:d,outlineWidth:2,outerHaloWidth:.3,innerHaloWidth:.3,outlinePosition:0});this._highlightOptionsUpToDate=!0}}};return c}(m.Container);f.default=d});