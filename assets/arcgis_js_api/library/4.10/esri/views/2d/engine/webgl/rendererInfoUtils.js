// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/assignHelper ../../../../Graphic ../../../../arcade/Feature ../../../../support/arcadeUtils ./enums ./visualVariablesUtils".split(" "),function(v,d,w,r,t,g,u,h){function q(a,b,c){if(!a)return null;var d=0,f={};a=a.clone();var k=a.visualVariables,l=null;if("simple"!==a.type){var m=a.valueExpression;if(!a.field&&m){var n="$$fake"+d++,h=g.createFunction(m);f[n]=function(a,e){p.repurposeFromGraphicLikeObject(a.geometry,a.attributes,c);return g.executeFunction(h,
{vars:{$feature:p,$view:g.getViewInfo(e)},spatialReference:b})};a.field=n;a.valueExpression=null;l=function(a,b){b.attributes[n]=f[n](b);return a.valueExpression?a.getSymbol(r.fromJSON(b)):a.getSymbol(b)}}}k&&(a.visualVariables=k.map(function(a){var e="size"===a.type&&a.valueExpression&&"$view.scale"===a.valueExpression;if(a.normalizationField){var k=a.field,l=a.normalizationField,e="$$fake"+d++;f[e]=function(a,b){return a.attributes[k]/a.attributes[l]};a=a.clone();a.field=e;a.normalizationField=
null;return a}if(a.valueExpression&&!e){var m=a.valueExpression,e="$$fake"+d++,h=g.createFunction(m);f[e]=function(a,k){p.repurposeFromGraphicLikeObject(a.geometry,a.attributes,c);return g.executeFunction(h,{vars:{$feature:p,$view:g.getViewInfo(k)},spatialReference:b})};a=a.clone();a.field=e;a.valueExpression=null}return a}));return{renderer:a,normalizingFunctions:f,getSymbolFunction:l}}Object.defineProperty(d,"__esModule",{value:!0});var p=new t;d.createRendererInfo=function(a,b,c){var d=(b=q(a,
b,c)||{renderer:null,normalizingFunctions:null,getSymbolFunction:null},b.normalizingFunctions),f=b&&b.getSymbolFunction;a=b&&b.renderer||a;b=h.convertVisualVariables(a.visualVariables);return{renderer:a,vvFields:b.vvFields,vvRanges:b.vvRanges,getValue:function(a,b){var c=d[b];return c?c(a):a.attributes[b]},getSymbol:function(a){return f?f(this.renderer,a):this.renderer.getSymbol?this.renderer.getSymbol.call(this.renderer,a):null}}};d.getNormalizedRenderer=function(a,b,c){return(b=q(a,b,c)||{renderer:null,
normalizingFunctions:null,getSymbolFunction:null},b.renderer)||a};d.getSymbol=function(a,b){return a.getSymbol(b)};d.isRendererWebGLCompatible=function(a){if(!a||-1===["simple","class-breaks","unique-value","heatmap"].indexOf(a.type))return!1;if("visualVariables"in a&&a.visualVariables){var b=0;for(a=a.visualVariables;b<a.length;b++){var c=a[b];switch(c.type){case "color":case "opacity":if(c.stops&&8<c.stops.length)return!1;break;case "size":if(h.getTypeOfSizeVisualVariable(c)===u.WGLVVFlag.SIZE_FIELD_STOPS&&
c.stops&&6<c.stops.length)return!1}}}return!0}});