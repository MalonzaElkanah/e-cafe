// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
define(["require","exports","../../../../../core/Logger","../../../../../core/screenUtils","../../../../3d/support/mathUtils"],function(n,l,q,r,p){function t(b){return function(a){return r.pt2px(b.getSize(a))}}function m(b){if(!b)return null;for(var a=0;a<b.length;a++){var c=b[a];if("size"===c.type)return t(c)}return null}Object.defineProperty(l,"__esModule",{value:!0});var u=function(b,a){return b.order-a.order},v=function(b,a){return b.index-a.index},w=q.getLogger("esri/views/2d/engine/webgl/collisions/CollisionEngine");
l.createLabelVVEvaluator=m;n=function(){function b(a,b,d,e){var c=this;this._vvHandle=null;var g=a.geometryType,h=a.labelingInfo,f=a.renderer;this.vvEval=m("visualVariables"in f&&f.visualVariables);this._vvHandle=a.watch("visualVariables",function(a){c.vvEval=m(a)});a=h.map(function(a){var b=!!a.maxScale,c=!!a.minScale&&e.scaleToZoom(a.minScale)||0;a=b&&e.scaleToZoom(a.maxScale)||255;return{minZoom:p.clamp(Math.floor(10*c),0,255),maxZoom:p.clamp(Math.floor(10*a),0,255)}});this.geometryType=g;this.index=
b;this.order=d;this.zoomRanges=a}b.prototype.hasVV=function(){return!!this.vvEval};b.prototype.allOrNothing=function(){return"polyline"!==this.geometryType};b.prototype.destroy=function(){this._vvHandle.remove()};b.create=function(a,c,d,e){d=d.sort(u);for(var k=!1,g=-1,h=0;h<d.length;h++){var f=d[h];!k&&f.order>c&&(g=f.index,k=!0);k&&f.index++}k||(g=d.length);return new b(a,g,c,e)};b.delete=function(a,b){for(var d=b.sort(v),c=a+1;c<d.length;c++)b[c].index--;b[a].destroy();b.splice(a,1)};b.find=function(a,
b){for(var c=0;c<b.length;c++){var e=b[c];if(e.index===a)return e}w.error("Tried to get a LayerCollisionInfo for an index that doesn't exist!");return null};return b}();l.default=n});