// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.10/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/assignHelper ../../../core/Collection ../../../core/Error ../../../core/Evented ../../../core/promiseUtils ../../../core/accessorSupport/decorators ../../../tasks/support/FeatureSet ./FeatureLayerView2D ./features/controllers".split(" "),function(t,u,h,c,k,l,g,m,e,d,n,p,q){return function(f){function a(){var b=null!==f&&f.apply(this,arguments)||this;b.errorString=null;
b.connectionStatus="disconnected";b.filter=null;b.graphics=new l;return b}h(a,f);a.prototype.initialize=function(){var b=this;this.when().then(function(){var a=b.watch("layer.filter",function(a){e.all([q.getControllerConfiguration(b.layer),b._proxy.when()]).then(function(a){var r=a[0];a=a[1];b.tileRenderer.clear();a.configure({controller:r})})});b.handles.add(a)})};a.prototype.destroy=function(){this.connectionStatus="disconnected"};Object.defineProperty(a.prototype,"connectionError",{get:function(){if(this.errorString)return new g("stream-controller",
this.errorString)},enumerable:!0,configurable:!0});a.prototype.updateFilter=function(a){if("connected"!==this.connectionStatus)return e.reject(new g("stream-layer-view: updateFilter","Cannot update filter. The connection with the stream service is closed"));this.set("filter",a);return e.resolve({filter:a})};a.prototype.on=function(a,d){"data-received"===a&&this._proxy.enableEvent("data-received",!0);var b=this.inherited(arguments),c=this;return{remove:function(){b.remove();c.hasEventListener("data-received")||
c._proxy.enableEvent("data-received",!1)}}};a.prototype.queryLatestObservations=function(a){var b=this;return this._proxy.queryLatestObservations(this._cleanUpQuery(a)).then(function(a){a=n.fromJSON(a);a.features.forEach(function(a){a.layer=b.layer;a.sourceLayer=b.layer});return a})};a.prototype.connect=function(){return e.resolve()};a.prototype.disconnect=function(){};a.prototype._createClientOptions=function(){var a=this,c=this.inherited(arguments);return k({},c,{emitEvent:function(b){a.emit(b.name,
b.event)},setProperty:function(b){a.set(b.propertyName,b.value)}})};c([d.property()],a.prototype,"errorString",void 0);c([d.property({dependsOn:["errorString"],readOnly:!0})],a.prototype,"connectionError",null);c([d.property()],a.prototype,"connectionStatus",void 0);c([d.aliasOf("layer.filter")],a.prototype,"filter",void 0);c([d.property({readOnly:!0})],a.prototype,"graphics",void 0);return a=c([d.subclass("esri.views.2d.layers.StreamLayerView2D")],a)}(d.declared(p,m))});